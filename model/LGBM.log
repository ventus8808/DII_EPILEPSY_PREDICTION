2025-04-26 12:40:42,726 - INFO - Starting LightGBM model training
2025-04-26 12:40:42,726 - INFO - [并行调参说明] 本脚本支持Optuna多进程/多机并行调参，只需多开终端运行本脚本即可，Optuna会自动分配trial。
2025-04-26 12:40:42,766 - INFO - Running 2 trials for hyperparameter optimization
2025-04-26 12:40:42,766 - INFO - No existing LightGBM_best_params.json found, starting from scratch.
2025-04-26 12:40:48,337 - WARNING - [Trial 0] 交叉验证失败原因: ['特异度过低: 0.1362 < 0.4', '特异度过低: 0.1886 < 0.4', '特异度过低: 0.1186 < 0.4', '特异度过低: 0.1042 < 0.4', '特异度过低: 0.1661 < 0.4']
2025-04-26 12:40:48,337 - INFO - [04-26 12:40:48][Trial 1/2] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-26 12:40:53,683 - WARNING - [Trial 1] 交叉验证失败原因: ['特异度过低: 0.2697 < 0.4', '特异度过低: 0.3276 < 0.4', '特异度过低: 0.2692 < 0.4', '特异度过低: 0.1936 < 0.4', '特异度过低: 0.2765 < 0.4']
2025-04-26 12:40:53,683 - INFO - [04-26 12:40:53][Trial 2/2] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-26 12:40:53,684 - INFO - Training finished. Best score: -inf
2025-04-26 12:40:53,684 - ERROR - Error during optimization: 'params'
2025-04-26 12:40:53,684 - ERROR - Traceback (most recent call last):
  File "/Users/ventus/Repository/DII_EPILEPSY_PREDICTION/py_model/LightGBM_Train.py", line 540, in main
    best_params = best_trial.user_attrs["params"]
KeyError: 'params'

2025-04-26 12:40:53,684 - WARNING - No valid model found that meets the constraints.
2025-04-26 12:40:53,684 - WARNING - Check your objective constraints and data.
2025-04-26 12:44:52,782 - INFO - Starting LightGBM model training
2025-04-26 12:44:52,782 - INFO - [并行调参说明] 本脚本支持Optuna多进程/多机并行调参，只需多开终端运行本脚本即可，Optuna会自动分配trial。
2025-04-26 12:44:52,818 - INFO - Running 2 trials for hyperparameter optimization
2025-04-26 12:44:52,818 - INFO - No existing LightGBM_best_params.json found, starting from scratch.
2025-04-26 12:44:52,870 - ERROR - Error in fold 0: Cannot set is_unbalance and scale_pos_weight at the same time
2025-04-26 12:44:52,888 - ERROR - Error in fold 1: Cannot set is_unbalance and scale_pos_weight at the same time
2025-04-26 12:44:52,904 - ERROR - Error in fold 2: Cannot set is_unbalance and scale_pos_weight at the same time
2025-04-26 12:44:52,920 - ERROR - Error in fold 3: Cannot set is_unbalance and scale_pos_weight at the same time
2025-04-26 12:44:52,936 - ERROR - Error in fold 4: Cannot set is_unbalance and scale_pos_weight at the same time
2025-04-26 12:44:52,936 - WARNING - [Trial 0] 无有效交叉验证结果, 原因: []
2025-04-26 12:44:52,937 - INFO - [04-26 12:44:52][Trial 1/2] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-26 12:44:52,954 - ERROR - Error in fold 0: Cannot set is_unbalance and scale_pos_weight at the same time
2025-04-26 12:44:52,970 - ERROR - Error in fold 1: Cannot set is_unbalance and scale_pos_weight at the same time
2025-04-26 12:44:52,985 - ERROR - Error in fold 2: Cannot set is_unbalance and scale_pos_weight at the same time
2025-04-26 12:44:53,001 - ERROR - Error in fold 3: Cannot set is_unbalance and scale_pos_weight at the same time
2025-04-26 12:44:53,017 - ERROR - Error in fold 4: Cannot set is_unbalance and scale_pos_weight at the same time
2025-04-26 12:44:53,017 - WARNING - [Trial 1] 无有效交叉验证结果, 原因: []
2025-04-26 12:44:53,018 - INFO - [04-26 12:44:53][Trial 2/2] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-26 12:44:53,018 - INFO - Training finished. Best score: -inf
2025-04-26 12:44:53,018 - WARNING - No valid trials found, all trials failed constraints.
2025-04-26 12:44:53,018 - WARNING - No valid model found that meets the constraints.
2025-04-26 12:44:53,018 - WARNING - Check your objective constraints and data.
2025-04-26 12:45:49,636 - INFO - Starting LightGBM model training
2025-04-26 12:45:49,636 - INFO - [并行调参说明] 本脚本支持Optuna多进程/多机并行调参，只需多开终端运行本脚本即可，Optuna会自动分配trial。
2025-04-26 12:45:49,671 - INFO - Running 2 trials for hyperparameter optimization
2025-04-26 12:45:49,671 - INFO - No existing LightGBM_best_params.json found, starting from scratch.
2025-04-26 12:45:56,040 - WARNING - [Trial 0] 交叉验证失败原因: ['敏感度过低: 0.2723 < 0.4', '敏感度过低: 0.3107 < 0.4', '敏感度过低: 0.3046 < 0.4']
2025-04-26 12:45:56,040 - INFO - [04-26 12:45:56][Trial 1/2] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-26 12:46:02,006 - WARNING - [Trial 1] 交叉验证失败原因: ['敏感度过低: 0.3071 < 0.4']
2025-04-26 12:46:02,006 - INFO - [04-26 12:46:02][Trial 2/2] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-26 12:46:02,006 - INFO - Training finished. Best score: -inf
2025-04-26 12:46:02,006 - WARNING - No valid trials found, all trials failed constraints.
2025-04-26 12:46:02,006 - WARNING - No valid model found that meets the constraints.
2025-04-26 12:46:02,006 - WARNING - Check your objective constraints and data.
2025-04-26 12:46:54,841 - INFO - Starting LightGBM model training
2025-04-26 12:46:54,841 - INFO - [并行调参说明] 本脚本支持Optuna多进程/多机并行调参，只需多开终端运行本脚本即可，Optuna会自动分配trial。
2025-04-26 12:46:54,875 - INFO - Running 2 trials for hyperparameter optimization
2025-04-26 12:46:54,876 - INFO - No existing LightGBM_best_params.json found, starting from scratch.
2025-04-26 12:46:57,298 - WARNING - [Trial 0] 交叉验证失败原因: ['敏感度过低: 0.2988 < 0.3']
2025-04-26 12:46:57,298 - INFO - [04-26 12:46:57][Trial 1/2] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-26 12:47:09,963 - WARNING - [Trial 1] 交叉验证失败原因: ['敏感度过低: 0.2723 < 0.3', '敏感度过低: 0.2474 < 0.3']
2025-04-26 12:47:09,963 - INFO - [04-26 12:47:09][Trial 2/2] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-26 12:47:09,964 - INFO - Training finished. Best score: -inf
2025-04-26 12:47:09,964 - WARNING - No valid trials found, all trials failed constraints.
2025-04-26 12:47:09,964 - WARNING - No valid model found that meets the constraints.
2025-04-26 12:47:09,964 - WARNING - Check your objective constraints and data.
2025-04-26 12:47:51,964 - INFO - Starting LightGBM model training
2025-04-26 12:47:51,964 - INFO - [并行调参说明] 本脚本支持Optuna多进程/多机并行调参，只需多开终端运行本脚本即可，Optuna会自动分配trial。
2025-04-26 12:47:52,009 - INFO - Running 2 trials for hyperparameter optimization
2025-04-26 12:47:52,010 - INFO - No existing LightGBM_best_params.json found, starting from scratch.
2025-04-26 12:47:56,642 - WARNING - [Trial 0] 交叉验证失败原因: ['特异度过低: 0.1423 < 0.2', '特异度过低: 0.1594 < 0.2', '特异度过低: 0.1373 < 0.2', '特异度过低: 0.0998 < 0.2', '特异度过低: 0.1247 < 0.2']
2025-04-26 12:47:56,642 - INFO - [04-26 12:47:56][Trial 1/2] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-26 12:48:36,909 - INFO - [Trial 1] 5-fold mean metrics: {'Accuracy': 0.9286145504290007, 'Sensitivity': 0.3403214293171699, 'Specificity': 0.9276266332557723, 'Precision': 0.07926689466010985, 'NPV': 0.9892967253434151, 'F1 Score': 0.1283998837633624, "Youden's Index": 0.26794806257294224, "Cohen's Kappa": 0.10591214019741244, 'AUC-ROC': 0.7315385326638421, 'AUC-PR': 0.06920032074447766, 'Log Loss': 0.2179416606753529, 'Brier': 0.05981187230631729, 'ECE': 0.13210473423127342, 'MCE': 0.8564298298674045}
2025-04-26 12:48:36,910 - INFO - [Trial 1] 交叉验证通过，开始在测试集上评估...
2025-04-26 12:49:00,447 - INFO - [Trial 1] 测试集指标: {'Accuracy': 0.935, 'Sensitivity': 0.525, 'Specificity': 0.911, 'Precision': 0.142, 'NPV': 0.988, 'F1 Score': 0.224, "Youden's Index": 0.436, "Cohen's Kappa": 0.202, 'AUC-ROC': 0.771, 'AUC-PR': 0.222, 'Log Loss': 0.202, 'Brier': 0.055, 'ECE': 0.121, 'MCE': 0.636}
2025-04-26 12:49:00,447 - INFO - Trial 1: CV AUC=0.732 Sens=0.340 Spec=0.928 | Test AUC=0.771 Sens=0.525 Spec=0.911
2025-04-26 12:49:00,449 - INFO - [04-26 12:49:00][Trial 2/2] AUC-ROC=0.771 AUC-PR=0.222 Sens=0.525 Spec=0.911 Prec=0.142 Score=0.464
2025-04-26 12:49:00,450 - INFO - [Trial 2] New best score: 0.464
2025-04-26 12:49:00,450 - INFO - Best parameters:
2025-04-26 12:49:00,450 - INFO - n_estimators: 1000
2025-04-26 12:49:00,450 - INFO - max_depth: 20
2025-04-26 12:49:00,450 - INFO - learning_rate: 0.0063163702291310995
2025-04-26 12:49:00,450 - INFO - subsample: 0.592689818874548
2025-04-26 12:49:00,450 - INFO - colsample_bytree: 0.5035094509986247
2025-04-26 12:49:00,450 - INFO - reg_alpha: 3.3629726885973863
2025-04-26 12:49:00,450 - INFO - reg_lambda: 7.853598473816482
2025-04-26 12:49:00,450 - INFO - num_leaves: 548
2025-04-26 12:49:00,450 - INFO - min_child_samples: 57
2025-04-26 12:49:00,450 - INFO - min_child_weight: 8.486552576683524
2025-04-26 12:49:00,450 - INFO - class_weight: balanced
2025-04-26 12:49:00,450 - INFO - random_state: 42
2025-04-26 12:49:00,450 - INFO - boosting_type: gbdt
2025-04-26 12:49:00,450 - INFO - objective: binary
2025-04-26 12:49:00,450 - INFO - metric: binary_logloss
2025-04-26 12:49:00,450 - INFO - is_unbalance: True
2025-04-26 12:49:00,450 - INFO - Best metrics:
2025-04-26 12:49:00,450 - INFO - Accuracy: 0.935
2025-04-26 12:49:00,450 - INFO - Sensitivity: 0.525
2025-04-26 12:49:00,450 - INFO - Specificity: 0.911
2025-04-26 12:49:00,450 - INFO - Precision: 0.142
2025-04-26 12:49:00,450 - INFO - NPV: 0.988
2025-04-26 12:49:00,450 - INFO - F1 Score: 0.224
2025-04-26 12:49:00,450 - INFO - Youden's Index: 0.436
2025-04-26 12:49:00,450 - INFO - Cohen's Kappa: 0.202
2025-04-26 12:49:00,450 - INFO - AUC-ROC: 0.771
2025-04-26 12:49:00,450 - INFO - AUC-PR: 0.222
2025-04-26 12:49:00,450 - INFO - Log Loss: 0.202
2025-04-26 12:49:00,450 - INFO - Brier: 0.055
2025-04-26 12:49:00,450 - INFO - ECE: 0.121
2025-04-26 12:49:00,450 - INFO - MCE: 0.636
2025-04-26 12:49:00,451 - INFO - Training finished. Best score: 0.464
2025-04-26 12:49:00,451 - INFO - Optimization finished. Best score: 0.464
2025-04-26 12:49:00,451 - INFO - Optimization finished. Best score: 0.464
2025-04-26 12:49:00,451 - INFO - Best parameters:
2025-04-26 12:49:00,451 - INFO - n_estimators: 1000
2025-04-26 12:49:00,451 - INFO - max_depth: 20
2025-04-26 12:49:00,451 - INFO - learning_rate: 0.0063163702291310995
2025-04-26 12:49:00,451 - INFO - subsample: 0.592689818874548
2025-04-26 12:49:00,451 - INFO - colsample_bytree: 0.5035094509986247
2025-04-26 12:49:00,451 - INFO - reg_alpha: 3.3629726885973863
2025-04-26 12:49:00,451 - INFO - reg_lambda: 7.853598473816482
2025-04-26 12:49:00,451 - INFO - num_leaves: 548
2025-04-26 12:49:00,451 - INFO - min_child_samples: 57
2025-04-26 12:49:00,451 - INFO - min_child_weight: 8.486552576683524
2025-04-26 12:49:00,451 - INFO - class_weight: balanced
2025-04-26 12:49:00,451 - INFO - random_state: 42
2025-04-26 12:49:00,451 - INFO - boosting_type: gbdt
2025-04-26 12:49:00,451 - INFO - objective: binary
2025-04-26 12:49:00,451 - INFO - metric: binary_logloss
2025-04-26 12:49:00,451 - INFO - is_unbalance: True
2025-04-26 12:49:00,451 - INFO - Best CV metrics:
2025-04-26 12:49:00,451 - INFO - Accuracy: 0.935
2025-04-26 12:49:00,451 - INFO - Sensitivity: 0.525
2025-04-26 12:49:00,451 - INFO - Specificity: 0.911
2025-04-26 12:49:00,451 - INFO - Precision: 0.142
2025-04-26 12:49:00,451 - INFO - NPV: 0.988
2025-04-26 12:49:00,451 - INFO - F1 Score: 0.224
2025-04-26 12:49:00,451 - INFO - Youden's Index: 0.436
2025-04-26 12:49:00,451 - INFO - Cohen's Kappa: 0.202
2025-04-26 12:49:00,451 - INFO - AUC-ROC: 0.771
2025-04-26 12:49:00,451 - INFO - AUC-PR: 0.222
2025-04-26 12:49:00,451 - INFO - Log Loss: 0.202
2025-04-26 12:49:00,451 - INFO - Brier: 0.055
2025-04-26 12:49:00,451 - INFO - ECE: 0.121
2025-04-26 12:49:00,451 - INFO - MCE: 0.636
2025-04-26 12:49:00,451 - INFO - Final best parameters:
2025-04-26 12:49:00,452 - INFO - n_estimators: 1000
2025-04-26 12:49:00,452 - INFO - max_depth: 20
2025-04-26 12:49:00,452 - INFO - learning_rate: 0.0063163702291310995
2025-04-26 12:49:00,452 - INFO - subsample: 0.592689818874548
2025-04-26 12:49:00,452 - INFO - colsample_bytree: 0.5035094509986247
2025-04-26 12:49:00,452 - INFO - reg_alpha: 3.3629726885973863
2025-04-26 12:49:00,452 - INFO - reg_lambda: 7.853598473816482
2025-04-26 12:49:00,452 - INFO - num_leaves: 548
2025-04-26 12:49:00,452 - INFO - min_child_samples: 57
2025-04-26 12:49:00,452 - INFO - min_child_weight: 8.486552576683524
2025-04-26 12:49:00,452 - INFO - class_weight: balanced
2025-04-26 12:49:00,452 - INFO - random_state: 42
2025-04-26 12:49:00,452 - INFO - boosting_type: gbdt
2025-04-26 12:49:00,452 - INFO - objective: binary
2025-04-26 12:49:00,452 - INFO - metric: binary_logloss
2025-04-26 12:49:00,452 - INFO - is_unbalance: True
2025-04-26 12:49:00,452 - INFO - Final best metrics (CV mean):
2025-04-26 12:49:00,452 - INFO - Accuracy: 0.935
2025-04-26 12:49:00,452 - INFO - Sensitivity: 0.525
2025-04-26 12:49:00,452 - INFO - Specificity: 0.911
2025-04-26 12:49:00,452 - INFO - Precision: 0.142
2025-04-26 12:49:00,452 - INFO - NPV: 0.988
2025-04-26 12:49:00,452 - INFO - F1 Score: 0.224
2025-04-26 12:49:00,452 - INFO - Youden's Index: 0.436
2025-04-26 12:49:00,452 - INFO - Cohen's Kappa: 0.202
2025-04-26 12:49:00,452 - INFO - AUC-ROC: 0.771
2025-04-26 12:49:00,452 - INFO - AUC-PR: 0.222
2025-04-26 12:49:00,452 - INFO - Log Loss: 0.202
2025-04-26 12:49:00,452 - INFO - Brier: 0.055
2025-04-26 12:49:00,452 - INFO - ECE: 0.121
2025-04-26 12:49:00,452 - INFO - MCE: 0.636
2025-04-26 12:49:00,452 - INFO - Evaluating on held-out test set (never seen during training/tuning)...
2025-04-26 12:49:26,326 - INFO - Test set metrics (never seen during training/tuning):
2025-04-26 12:49:26,327 - INFO - Accuracy: 0.935
2025-04-26 12:49:26,327 - INFO - Sensitivity: 0.525
2025-04-26 12:49:26,327 - INFO - Specificity: 0.911
2025-04-26 12:49:26,327 - INFO - Precision: 0.142
2025-04-26 12:49:26,327 - INFO - NPV: 0.988
2025-04-26 12:49:26,327 - INFO - F1 Score: 0.224
2025-04-26 12:49:26,327 - INFO - Youden's Index: 0.436
2025-04-26 12:49:26,327 - INFO - Cohen's Kappa: 0.202
2025-04-26 12:49:26,327 - INFO - AUC-ROC: 0.771
2025-04-26 12:49:26,327 - INFO - AUC-PR: 0.222
2025-04-26 12:49:26,327 - INFO - Log Loss: 0.202
2025-04-26 12:49:26,327 - INFO - Brier: 0.055
2025-04-26 12:49:26,327 - INFO - ECE: 0.121
2025-04-26 12:49:26,327 - INFO - MCE: 0.636
