2025-04-22 13:43:41,316 - INFO - Starting XGBoost model training
2025-04-22 13:44:00,895 - INFO - Optuna best score: -inf
2025-04-22 13:44:00,895 - INFO - Best parameters:
2025-04-22 13:44:00,895 - INFO - n_estimators: 200
2025-04-22 13:44:00,895 - INFO - max_depth: 10
2025-04-22 13:44:00,895 - INFO - learning_rate: 0.05547107987236009
2025-04-22 13:44:00,895 - INFO - subsample: 0.7672662615752976
2025-04-22 13:44:00,895 - INFO - colsample_bytree: 0.9940061502237982
2025-04-22 13:44:00,895 - INFO - reg_alpha: 1.70688313548634
2025-04-22 13:44:00,895 - INFO - reg_lambda: 0.6645430949475255
2025-04-22 13:44:00,895 - INFO - use_label_encoder: False
2025-04-22 13:44:00,895 - INFO - random_state: 42
2025-04-22 13:44:00,895 - INFO - eval_metric: logloss
2025-04-22 13:44:00,895 - INFO - Best metrics:
2025-04-22 13:44:00,895 - INFO - AUC-ROC: 0.8302
2025-04-22 13:44:00,896 - INFO - AUC-PR: 0.3091
2025-04-22 13:44:00,896 - INFO - Sensitivity: 0.5733
2025-04-22 13:44:00,896 - INFO - Specificity: 0.9717
2025-04-22 13:44:00,896 - INFO - Precision: 0.2699
2025-04-22 13:44:00,896 - INFO - F1: 0.3670
2025-04-22 13:44:00,896 - INFO - ECE: 0.0397
2025-04-22 13:44:00,896 - INFO - MCE: 0.7284
2025-04-22 13:44:00,896 - INFO - Brier: 0.0260
2025-04-22 13:44:00,896 - INFO - LogLoss: 0.1012
2025-04-22 14:47:15,335 - INFO - Starting XGBoost model training
2025-04-22 14:49:11,168 - INFO - Starting XGBoost model training
2025-04-22 17:37:58,992 - INFO - Optuna best score: -inf
2025-04-22 17:37:58,992 - INFO - Best parameters:
2025-04-22 17:37:58,992 - INFO - n_estimators: 100
2025-04-22 17:37:58,992 - INFO - max_depth: 10
2025-04-22 17:37:58,992 - INFO - learning_rate: 0.01059053256969849
2025-04-22 17:37:58,992 - INFO - subsample: 0.41851681788092226
2025-04-22 17:37:58,992 - INFO - colsample_bytree: 0.9795042266357571
2025-04-22 17:37:58,992 - INFO - reg_alpha: 0.9159664336155621
2025-04-22 17:37:58,992 - INFO - reg_lambda: 2.945127069712534
2025-04-22 17:37:58,992 - INFO - use_label_encoder: False
2025-04-22 17:37:58,992 - INFO - random_state: 42
2025-04-22 17:37:58,992 - INFO - eval_metric: logloss
2025-04-22 17:37:58,992 - INFO - Best metrics:
2025-04-22 17:37:58,992 - INFO - AUC-ROC: 0.8062
2025-04-22 17:37:58,992 - INFO - AUC-PR: 0.0982
2025-04-22 17:37:58,992 - INFO - Sensitivity: 0.3904
2025-04-22 17:37:58,992 - INFO - Specificity: 0.9076
2025-04-22 17:37:58,992 - INFO - Precision: 0.0717
2025-04-22 17:37:58,992 - INFO - F1: 0.1211
2025-04-22 17:37:58,992 - INFO - ECE: 0.2771
2025-04-22 17:37:58,992 - INFO - MCE: 0.5733
2025-04-22 17:37:58,992 - INFO - Brier: 0.1044
2025-04-22 17:37:58,992 - INFO - LogLoss: 0.3747
2025-04-24 10:24:51,165 - INFO - Starting XGBoost model training
2025-04-24 10:24:51,202 - INFO - Running 10 trials for hyperparameter optimization
2025-04-24 10:24:51,611 - INFO - Fold 1/5 metrics: Sensitivity=0.2723, Specificity=0.9415, AUC-ROC=0.7118
2025-04-24 10:24:52,036 - INFO - Fold 2/5 metrics: Sensitivity=0.3346, Specificity=0.9437, AUC-ROC=0.7729
2025-04-24 10:24:52,434 - INFO - Fold 3/5 metrics: Sensitivity=0.2641, Specificity=0.9388, AUC-ROC=0.7730
2025-04-24 10:24:52,835 - INFO - Fold 4/5 metrics: Sensitivity=0.3278, Specificity=0.9272, AUC-ROC=0.7101
2025-04-24 10:24:53,245 - INFO - Fold 5/5 metrics: Sensitivity=0.2474, Specificity=0.9470, AUC-ROC=0.6806
2025-04-24 10:24:53,246 - INFO - Trial 0: score=-inf, AUC-ROC=0.7297
2025-04-24 10:24:54,652 - INFO - Fold 1/5 metrics: Sensitivity=0.2287, Specificity=0.9752, AUC-ROC=0.7500
2025-04-24 10:24:56,063 - INFO - Fold 2/5 metrics: Sensitivity=0.4270, Specificity=0.9796, AUC-ROC=0.8007
2025-04-24 10:24:57,473 - INFO - Fold 3/5 metrics: Sensitivity=0.4869, Specificity=0.9691, AUC-ROC=0.8463
2025-04-24 10:24:58,816 - INFO - Fold 4/5 metrics: Sensitivity=0.3696, Specificity=0.9619, AUC-ROC=0.6297
2025-04-24 10:25:00,203 - INFO - Fold 5/5 metrics: Sensitivity=0.2324, Specificity=0.9829, AUC-ROC=0.7332
2025-04-24 10:25:00,205 - INFO - Trial 1: score=-inf, AUC-ROC=0.7520
2025-04-24 10:25:00,892 - INFO - Fold 1/5 metrics: Sensitivity=0.2610, Specificity=0.9090, AUC-ROC=0.6814
2025-04-24 10:25:01,564 - INFO - Fold 2/5 metrics: Sensitivity=0.3904, Specificity=0.9134, AUC-ROC=0.7438
2025-04-24 10:25:02,265 - INFO - Fold 3/5 metrics: Sensitivity=0.3712, Specificity=0.9184, AUC-ROC=0.7394
2025-04-24 10:25:02,918 - INFO - Fold 4/5 metrics: Sensitivity=0.3104, Specificity=0.8963, AUC-ROC=0.7500
2025-04-24 10:25:03,548 - INFO - Fold 5/5 metrics: Sensitivity=0.2474, Specificity=0.9178, AUC-ROC=0.6971
2025-04-24 10:25:03,550 - INFO - Trial 2: score=-inf, AUC-ROC=0.7223
2025-04-24 10:25:04,251 - INFO - Fold 1/5 metrics: Sensitivity=0.1981, Specificity=0.9239, AUC-ROC=0.7055
2025-04-24 10:25:04,942 - INFO - Fold 2/5 metrics: Sensitivity=0.3771, Specificity=0.9410, AUC-ROC=0.7705
2025-04-24 10:25:05,620 - INFO - Fold 3/5 metrics: Sensitivity=0.4682, Specificity=0.9366, AUC-ROC=0.8064
2025-04-24 10:25:06,307 - INFO - Fold 4/5 metrics: Sensitivity=0.3108, Specificity=0.9228, AUC-ROC=0.6833
2025-04-24 10:25:06,977 - INFO - Fold 5/5 metrics: Sensitivity=0.2332, Specificity=0.9465, AUC-ROC=0.7672
2025-04-24 10:25:06,978 - INFO - Trial 3: score=-inf, AUC-ROC=0.7466
2025-04-24 10:25:07,809 - INFO - Fold 1/5 metrics: Sensitivity=0.2232, Specificity=0.9741, AUC-ROC=0.7610
2025-04-24 10:25:08,679 - INFO - Fold 2/5 metrics: Sensitivity=0.4206, Specificity=0.9779, AUC-ROC=0.7999
2025-04-24 10:25:09,514 - INFO - Fold 3/5 metrics: Sensitivity=0.4869, Specificity=0.9702, AUC-ROC=0.8575
2025-04-24 10:25:10,382 - INFO - Fold 4/5 metrics: Sensitivity=0.3696, Specificity=0.9570, AUC-ROC=0.6547
2025-04-24 10:25:11,205 - INFO - Fold 5/5 metrics: Sensitivity=0.2114, Specificity=0.9785, AUC-ROC=0.7164
2025-04-24 10:25:11,207 - INFO - Trial 4: score=-inf, AUC-ROC=0.7579
2025-04-24 10:25:12,860 - INFO - Fold 1/5 metrics: Sensitivity=0.2341, Specificity=0.9741, AUC-ROC=0.7138
2025-04-24 10:25:14,513 - INFO - Fold 2/5 metrics: Sensitivity=0.4270, Specificity=0.9823, AUC-ROC=0.7918
2025-04-24 10:25:16,202 - INFO - Fold 3/5 metrics: Sensitivity=0.4802, Specificity=0.9708, AUC-ROC=0.8457
2025-04-24 10:25:17,864 - INFO - Fold 4/5 metrics: Sensitivity=0.3462, Specificity=0.9630, AUC-ROC=0.6236
2025-04-24 10:25:19,535 - INFO - Fold 5/5 metrics: Sensitivity=0.2324, Specificity=0.9823, AUC-ROC=0.7370
2025-04-24 10:25:19,537 - INFO - Trial 5: score=-inf, AUC-ROC=0.7424
2025-04-24 10:25:20,809 - INFO - Fold 1/5 metrics: Sensitivity=0.2471, Specificity=0.9790, AUC-ROC=0.7667
2025-04-24 10:25:22,036 - INFO - Fold 2/5 metrics: Sensitivity=0.4270, Specificity=0.9812, AUC-ROC=0.7894
2025-04-24 10:25:23,337 - INFO - Fold 3/5 metrics: Sensitivity=0.5228, Specificity=0.9713, AUC-ROC=0.8425
2025-04-24 10:25:24,633 - INFO - Fold 4/5 metrics: Sensitivity=0.3788, Specificity=0.9719, AUC-ROC=0.6353
2025-04-24 10:25:25,863 - INFO - Fold 5/5 metrics: Sensitivity=0.2324, Specificity=0.9851, AUC-ROC=0.7455
2025-04-24 10:25:25,865 - INFO - Trial 6: score=-inf, AUC-ROC=0.7559
2025-04-24 10:25:26,465 - INFO - Fold 1/5 metrics: Sensitivity=0.2318, Specificity=0.9040, AUC-ROC=0.7064
2025-04-24 10:25:27,089 - INFO - Fold 2/5 metrics: Sensitivity=0.3990, Specificity=0.9151, AUC-ROC=0.6985
2025-04-24 10:25:27,694 - INFO - Fold 3/5 metrics: Sensitivity=0.4995, Specificity=0.9189, AUC-ROC=0.8184
2025-04-24 10:25:28,327 - INFO - Fold 4/5 metrics: Sensitivity=0.3337, Specificity=0.9046, AUC-ROC=0.6921
2025-04-24 10:25:28,961 - INFO - Fold 5/5 metrics: Sensitivity=0.2474, Specificity=0.9194, AUC-ROC=0.7661
2025-04-24 10:25:28,963 - INFO - Trial 7: score=-inf, AUC-ROC=0.7363
2025-04-24 10:25:30,350 - INFO - Fold 1/5 metrics: Sensitivity=0.2670, Specificity=0.9570, AUC-ROC=0.7455
2025-04-24 10:25:31,632 - INFO - Fold 2/5 metrics: Sensitivity=0.4820, Specificity=0.9614, AUC-ROC=0.7733
2025-04-24 10:25:33,022 - INFO - Fold 3/5 metrics: Sensitivity=0.4478, Specificity=0.9526, AUC-ROC=0.8338
2025-04-24 10:25:34,344 - INFO - Fold 4/5 metrics: Sensitivity=0.2669, Specificity=0.9443, AUC-ROC=0.6628
2025-04-24 10:25:35,660 - INFO - Fold 5/5 metrics: Sensitivity=0.2114, Specificity=0.9647, AUC-ROC=0.7125
2025-04-24 10:25:35,661 - INFO - Trial 8: score=-inf, AUC-ROC=0.7456
2025-04-24 10:25:35,761 - INFO - Fold 1/5 metrics: Sensitivity=0.2949, Specificity=0.8290, AUC-ROC=0.6703
2025-04-24 10:25:35,890 - INFO - Fold 2/5 metrics: Sensitivity=0.5199, Specificity=0.8367, AUC-ROC=0.6683
2025-04-24 10:25:36,007 - INFO - Fold 3/5 metrics: Sensitivity=0.3818, Specificity=0.8345, AUC-ROC=0.7390
2025-04-24 10:25:36,112 - INFO - Fold 4/5 metrics: Sensitivity=0.4056, Specificity=0.8456, AUC-ROC=0.7081
2025-04-24 10:25:36,216 - INFO - Fold 5/5 metrics: Sensitivity=0.5435, Specificity=0.8521, AUC-ROC=0.7151
2025-04-24 10:25:36,218 - INFO - Trial 9: score=-inf, AUC-ROC=0.7001
2025-04-24 10:25:36,218 - INFO - Optimization finished. Best score: -inf
2025-04-24 10:25:36,218 - INFO - Best parameters:
2025-04-24 10:25:36,218 - INFO - n_estimators: 300
2025-04-24 10:25:36,218 - INFO - max_depth: None
2025-04-24 10:25:36,218 - INFO - learning_rate: 0.05907320350793839
2025-04-24 10:25:36,218 - INFO - subsample: 0.6775107562670531
2025-04-24 10:25:36,218 - INFO - colsample_bytree: 0.4500435101442505
2025-04-24 10:25:36,218 - INFO - reg_alpha: 1.775713497289697
2025-04-24 10:25:36,218 - INFO - reg_lambda: 1.5038516474123624
2025-04-24 10:25:36,218 - INFO - use_label_encoder: False
2025-04-24 10:25:36,218 - INFO - random_state: 42
2025-04-24 10:25:36,218 - INFO - eval_metric: logloss
2025-04-24 10:25:36,220 - INFO - Best CV metrics:
2025-04-24 10:25:36,220 - INFO - Accuracy: 0.9388605474415618
2025-04-24 10:25:36,220 - INFO - Sensitivity: 0.2892328898617682
2025-04-24 10:25:36,220 - INFO - Specificity: 0.9396521809009982
2025-04-24 10:25:36,220 - INFO - Precision: 0.08292034747017771
2025-04-24 10:25:36,220 - INFO - NPV: 0.9889728569245152
2025-04-24 10:25:36,220 - INFO - F1 Score: 0.1285167747752351
2025-04-24 10:25:36,220 - INFO - Youden's Index: 0.22888507076276654
2025-04-24 10:25:36,220 - INFO - Cohen's Kappa: 0.1069959533650953
2025-04-24 10:25:36,220 - INFO - AUC-ROC: 0.7296943854784071
2025-04-24 10:25:36,220 - INFO - AUC-PR: 0.07577026189666887
2025-04-24 10:25:36,220 - INFO - Log Loss: 0.18638248202740693
2025-04-24 10:25:36,220 - INFO - Brier: 0.05149603909962188
2025-04-24 10:25:36,220 - INFO - ECE: 0.09725825849222351
2025-04-24 10:25:36,220 - INFO - MCE: 0.836304436481907
2025-04-24 10:25:36,220 - INFO - Final best parameters:
2025-04-24 10:25:36,220 - INFO - n_estimators: 300
2025-04-24 10:25:36,220 - INFO - max_depth: None
2025-04-24 10:25:36,220 - INFO - learning_rate: 0.05907320350793839
2025-04-24 10:25:36,220 - INFO - subsample: 0.6775107562670531
2025-04-24 10:25:36,220 - INFO - colsample_bytree: 0.4500435101442505
2025-04-24 10:25:36,220 - INFO - reg_alpha: 1.775713497289697
2025-04-24 10:25:36,220 - INFO - reg_lambda: 1.5038516474123624
2025-04-24 10:25:36,220 - INFO - use_label_encoder: False
2025-04-24 10:25:36,220 - INFO - random_state: 42
2025-04-24 10:25:36,220 - INFO - eval_metric: logloss
2025-04-24 10:25:36,220 - INFO - Final best metrics (CV mean):
2025-04-24 10:25:36,220 - INFO - Accuracy: 0.939
2025-04-24 10:25:36,220 - INFO - Sensitivity: 0.289
2025-04-24 10:25:36,220 - INFO - Specificity: 0.940
2025-04-24 10:25:36,220 - INFO - Precision: 0.083
2025-04-24 10:25:36,220 - INFO - NPV: 0.989
2025-04-24 10:25:36,220 - INFO - F1 Score: 0.129
2025-04-24 10:25:36,220 - INFO - Youden's Index: 0.229
2025-04-24 10:25:36,220 - INFO - Cohen's Kappa: 0.107
2025-04-24 10:25:36,220 - INFO - AUC-ROC: 0.730
2025-04-24 10:25:36,220 - INFO - AUC-PR: 0.076
2025-04-24 10:25:36,220 - INFO - Log Loss: 0.186
2025-04-24 10:25:36,220 - INFO - Brier: 0.051
2025-04-24 10:25:36,221 - INFO - ECE: 0.097
2025-04-24 10:25:36,221 - INFO - MCE: 0.836
2025-04-24 10:25:36,221 - INFO - Evaluating on held-out test set (never seen during training/tuning)...
2025-04-24 10:28:30,832 - INFO - Starting XGBoost model training
2025-04-24 10:28:30,832 - INFO - [并行调参说明] 本脚本支持Optuna多进程/多机并行调参，只需多开终端运行本脚本即可，Optuna会自动分配trial。
2025-04-24 10:28:30,879 - INFO - Running 10 trials for hyperparameter optimization
2025-04-24 10:28:30,879 - INFO - Found existing XGBoost_best_params.json, evaluating initial score...
2025-04-24 10:28:30,879 - ERROR - Error loading existing params: 'PseudoTrial' object has no attribute 'suggest_categorical'
2025-04-24 10:28:30,879 - INFO - Starting optimization from scratch due to error loading params.
2025-04-24 10:28:32,590 - INFO - Fold 1/5 metrics: Sensitivity=0.215, Specificity=0.926, AUC-ROC=0.704
2025-04-24 10:28:34,274 - INFO - Fold 2/5 metrics: Sensitivity=0.377, Specificity=0.937, AUC-ROC=0.765
2025-04-24 10:28:35,991 - INFO - Fold 3/5 metrics: Sensitivity=0.357, Specificity=0.942, AUC-ROC=0.803
2025-04-24 10:28:37,758 - INFO - Fold 4/5 metrics: Sensitivity=0.326, Specificity=0.924, AUC-ROC=0.725
2025-04-24 10:28:39,493 - INFO - Fold 5/5 metrics: Sensitivity=0.247, Specificity=0.939, AUC-ROC=0.735
2025-04-24 10:28:39,495 - INFO - [Trial 0] 5-fold mean metrics: {'Accuracy': 0.9331771084076129, 'Sensitivity': 0.30468720242957337, 'Specificity': 0.9334736615247495, 'Precision': 0.07894531522482925, 'NPV': 0.9886652823103403, 'F1 Score': 0.1252119721132871, "Youden's Index": 0.23816086395432284, "Cohen's Kappa": 0.10303959115905421, 'AUC-ROC': 0.7464261885560912, 'AUC-PR': 0.06475524428860323, 'Log Loss': 0.2321585101278126, 'Brier': 0.060862754141211825, 'ECE': 0.15218786883378427, 'MCE': 0.8537496914250753}
2025-04-24 10:28:39,495 - INFO - Trial 0: AUC-ROC=0.746 AUC-PR=0.065 Sens=0.305 Spec=0.933 Prec=0.079 Score=-inf
2025-04-24 10:28:39,495 - INFO - [04-24 10:28:39][Trial 1/10] AUC-ROC=0.746 AUC-PR=0.065 Sens=0.305 Spec=0.933 Prec=0.079 Score=-inf
2025-04-24 10:28:40,330 - INFO - Fold 1/5 metrics: Sensitivity=0.232, Specificity=0.967, AUC-ROC=0.745
2025-04-24 10:28:41,162 - INFO - Fold 2/5 metrics: Sensitivity=0.427, Specificity=0.976, AUC-ROC=0.793
2025-04-24 10:28:42,039 - INFO - Fold 3/5 metrics: Sensitivity=0.504, Specificity=0.965, AUC-ROC=0.847
2025-04-24 10:28:42,923 - INFO - Fold 4/5 metrics: Sensitivity=0.392, Specificity=0.955, AUC-ROC=0.662
2025-04-24 10:28:43,820 - INFO - Fold 5/5 metrics: Sensitivity=0.232, Specificity=0.971, AUC-ROC=0.719
2025-04-24 10:28:43,822 - INFO - [Trial 1] 5-fold mean metrics: {'Accuracy': 0.962123534444261, 'Sensitivity': 0.3575722731598665, 'Specificity': 0.9670128298321297, 'Precision': 0.1646937048596406, 'NPV': 0.9896184057633717, 'F1 Score': 0.22447734370221833, "Youden's Index": 0.3245851029919963, "Cohen's Kappa": 0.2077804026961126, 'AUC-ROC': 0.7532349865385218, 'AUC-PR': 0.14124158368779807, 'Log Loss': 0.12516772472107573, 'Brier': 0.03196977934492425, 'ECE': 0.05118533530065393, 'MCE': 0.7632481566452187}
2025-04-24 10:28:43,822 - INFO - Trial 1: AUC-ROC=0.753 AUC-PR=0.141 Sens=0.358 Spec=0.967 Prec=0.165 Score=-inf
2025-04-24 10:28:43,822 - INFO - [04-24 10:28:43][Trial 2/10] AUC-ROC=0.753 AUC-PR=0.141 Sens=0.358 Spec=0.967 Prec=0.165 Score=-inf
2025-04-24 10:28:44,956 - INFO - Fold 1/5 metrics: Sensitivity=0.198, Specificity=0.916, AUC-ROC=0.704
2025-04-24 10:28:46,047 - INFO - Fold 2/5 metrics: Sensitivity=0.377, Specificity=0.926, AUC-ROC=0.753
2025-04-24 10:28:47,137 - INFO - Fold 3/5 metrics: Sensitivity=0.473, Specificity=0.931, AUC-ROC=0.811
2025-04-24 10:28:48,253 - INFO - Fold 4/5 metrics: Sensitivity=0.311, Specificity=0.915, AUC-ROC=0.706
2025-04-24 10:28:49,380 - INFO - Fold 5/5 metrics: Sensitivity=0.247, Specificity=0.940, AUC-ROC=0.761
2025-04-24 10:28:49,382 - INFO - [Trial 2] 5-fold mean metrics: {'Accuracy': 0.9261374657542516, 'Sensitivity': 0.32132519671126536, 'Specificity': 0.9256415220464417, 'Precision': 0.07524844885676521, 'NPV': 0.9886849541843905, 'F1 Score': 0.12162498326406312, "Youden's Index": 0.24696671875770707, "Cohen's Kappa": 0.09882401696772666, 'AUC-ROC': 0.7469930407107939, 'AUC-PR': 0.05699926665325221, 'Log Loss': 0.27651649187615274, 'Brier': 0.07203397492424671, 'ECE': 0.19303441032184573, 'MCE': 0.7661085856857069}
2025-04-24 10:28:49,382 - INFO - Trial 2: AUC-ROC=0.747 AUC-PR=0.057 Sens=0.321 Spec=0.926 Prec=0.075 Score=-inf
2025-04-24 10:28:49,382 - INFO - [04-24 10:28:49][Trial 3/10] AUC-ROC=0.747 AUC-PR=0.057 Sens=0.321 Spec=0.926 Prec=0.075 Score=-inf
2025-04-24 10:28:50,015 - INFO - Fold 1/5 metrics: Sensitivity=0.272, Specificity=0.936, AUC-ROC=0.730
2025-04-24 10:28:50,639 - INFO - Fold 2/5 metrics: Sensitivity=0.377, Specificity=0.937, AUC-ROC=0.775
2025-04-24 10:28:51,267 - INFO - Fold 3/5 metrics: Sensitivity=0.478, Specificity=0.944, AUC-ROC=0.797
2025-04-24 10:28:51,878 - INFO - Fold 4/5 metrics: Sensitivity=0.371, Specificity=0.933, AUC-ROC=0.734
2025-04-24 10:28:52,498 - INFO - Fold 5/5 metrics: Sensitivity=0.267, Specificity=0.946, AUC-ROC=0.724
2025-04-24 10:28:52,499 - INFO - [Trial 3] 5-fold mean metrics: {'Accuracy': 0.941545558168708, 'Sensitivity': 0.35311197006178013, 'Specificity': 0.9392108015570646, 'Precision': 0.10375838532348516, 'NPV': 0.9897697852796998, 'F1 Score': 0.16015809149577506, "Youden's Index": 0.2923227716188447, "Cohen's Kappa": 0.13939015887480535, 'AUC-ROC': 0.7518613602215403, 'AUC-PR': 0.07509251606194377, 'Log Loss': 0.23605154561471356, 'Brier': 0.06057694772242613, 'ECE': 0.16108931081815026, 'MCE': 0.7920035409554034}
2025-04-24 10:28:52,499 - INFO - Trial 3: AUC-ROC=0.752 AUC-PR=0.075 Sens=0.353 Spec=0.939 Prec=0.104 Score=-inf
2025-04-24 10:28:52,500 - INFO - [04-24 10:28:52][Trial 4/10] AUC-ROC=0.752 AUC-PR=0.075 Sens=0.353 Spec=0.939 Prec=0.104 Score=-inf
2025-04-24 10:28:52,842 - INFO - Fold 1/5 metrics: Sensitivity=0.255, Specificity=0.904, AUC-ROC=0.678
2025-04-24 10:28:53,185 - INFO - Fold 2/5 metrics: Sensitivity=0.323, Specificity=0.904, AUC-ROC=0.734
2025-04-24 10:28:53,537 - INFO - Fold 3/5 metrics: Sensitivity=0.398, Specificity=0.917, AUC-ROC=0.763
2025-04-24 10:28:53,890 - INFO - Fold 4/5 metrics: Sensitivity=0.310, Specificity=0.900, AUC-ROC=0.750
2025-04-24 10:28:54,228 - INFO - Fold 5/5 metrics: Sensitivity=0.247, Specificity=0.911, AUC-ROC=0.686
2025-04-24 10:28:54,230 - INFO - [Trial 4] 5-fold mean metrics: {'Accuracy': 0.9109141978472529, 'Sensitivity': 0.3067656853789513, 'Specificity': 0.9071054768784192, 'Precision': 0.05786718422934548, 'NPV': 0.9888139028034164, 'F1 Score': 0.0972519898209215, "Youden's Index": 0.21387116225737057, "Cohen's Kappa": 0.07300582025067004, 'AUC-ROC': 0.7221616142904543, 'AUC-PR': 0.05407431156683536, 'Log Loss': 0.25705689809890436, 'Brier': 0.07352627991898855, 'ECE': 0.15911584721835487, 'MCE': 0.8636339248608047}
2025-04-24 10:28:54,230 - INFO - Trial 4: AUC-ROC=0.722 AUC-PR=0.054 Sens=0.307 Spec=0.907 Prec=0.058 Score=-inf
2025-04-24 10:28:54,230 - INFO - [04-24 10:28:54][Trial 5/10] AUC-ROC=0.722 AUC-PR=0.054 Sens=0.307 Spec=0.907 Prec=0.058 Score=-inf
2025-04-24 10:28:54,756 - INFO - Fold 1/5 metrics: Sensitivity=0.260, Specificity=0.942, AUC-ROC=0.708
2025-04-24 10:28:55,309 - INFO - Fold 2/5 metrics: Sensitivity=0.328, Specificity=0.953, AUC-ROC=0.773
2025-04-24 10:28:55,830 - INFO - Fold 3/5 metrics: Sensitivity=0.457, Specificity=0.943, AUC-ROC=0.801
2025-04-24 10:28:56,357 - INFO - Fold 4/5 metrics: Sensitivity=0.423, Specificity=0.936, AUC-ROC=0.700
2025-04-24 10:28:56,920 - INFO - Fold 5/5 metrics: Sensitivity=0.323, Specificity=0.955, AUC-ROC=0.697
2025-04-24 10:28:56,922 - INFO - [Trial 5] 5-fold mean metrics: {'Accuracy': 0.9404538334472428, 'Sensitivity': 0.35800780726386017, 'Specificity': 0.9459410146732757, 'Precision': 0.10121203432518266, 'NPV': 0.9896173968106551, 'F1 Score': 0.1573288433523049, "Youden's Index": 0.30394882193713596, "Cohen's Kappa": 0.1364373750360867, 'AUC-ROC': 0.7358535436270757, 'AUC-PR': 0.08400770102197916, 'Log Loss': 0.16448788869532235, 'Brier': 0.04521548362832297, 'ECE': 0.0772245586149989, 'MCE': 0.8314188446981884}
2025-04-24 10:28:56,922 - INFO - Trial 5: AUC-ROC=0.736 AUC-PR=0.084 Sens=0.358 Spec=0.946 Prec=0.101 Score=-inf
2025-04-24 10:28:56,922 - INFO - [04-24 10:28:56][Trial 6/10] AUC-ROC=0.736 AUC-PR=0.084 Sens=0.358 Spec=0.946 Prec=0.101 Score=-inf
2025-04-24 10:28:58,652 - INFO - Fold 1/5 metrics: Sensitivity=0.128, Specificity=0.963, AUC-ROC=0.739
2025-04-24 10:29:00,350 - INFO - Fold 2/5 metrics: Sensitivity=0.427, Specificity=0.975, AUC-ROC=0.820
2025-04-24 10:29:02,107 - INFO - Fold 3/5 metrics: Sensitivity=0.497, Specificity=0.966, AUC-ROC=0.843
2025-04-24 10:29:03,841 - INFO - Fold 4/5 metrics: Sensitivity=0.277, Specificity=0.952, AUC-ROC=0.657
2025-04-24 10:29:05,578 - INFO - Fold 5/5 metrics: Sensitivity=0.135, Specificity=0.978, AUC-ROC=0.781
2025-04-24 10:29:05,580 - INFO - [Trial 6] 5-fold mean metrics: {'Accuracy': 0.9590189199686037, 'Sensitivity': 0.2929025688512353, 'Specificity': 0.9670136212709532, 'Precision': 0.13397378147895395, 'NPV': 0.9881641710991301, 'F1 Score': 0.18223207981441933, "Youden's Index": 0.2599161901221886, "Cohen's Kappa": 0.16451314427135375, 'AUC-ROC': 0.7679789235463067, 'AUC-PR': 0.11102277871459372, 'Log Loss': 0.20383868294759355, 'Brier': 0.04459487017192802, 'ECE': 0.1443781549515037, 'MCE': 0.6797769192153644}
2025-04-24 10:29:05,580 - INFO - Trial 6: AUC-ROC=0.768 AUC-PR=0.111 Sens=0.293 Spec=0.967 Prec=0.134 Score=-inf
2025-04-24 10:29:05,580 - INFO - [04-24 10:29:05][Trial 7/10] AUC-ROC=0.768 AUC-PR=0.111 Sens=0.293 Spec=0.967 Prec=0.134 Score=-inf
2025-04-24 10:29:07,521 - INFO - Fold 1/5 metrics: Sensitivity=0.191, Specificity=0.942, AUC-ROC=0.704
2025-04-24 10:29:09,382 - INFO - Fold 2/5 metrics: Sensitivity=0.392, Specificity=0.954, AUC-ROC=0.810
2025-04-24 10:29:11,213 - INFO - Fold 3/5 metrics: Sensitivity=0.539, Specificity=0.949, AUC-ROC=0.838
2025-04-24 10:29:13,149 - INFO - Fold 4/5 metrics: Sensitivity=0.272, Specificity=0.930, AUC-ROC=0.673
2025-04-24 10:29:15,046 - INFO - Fold 5/5 metrics: Sensitivity=0.243, Specificity=0.958, AUC-ROC=0.770
2025-04-24 10:29:15,048 - INFO - [Trial 7] 5-fold mean metrics: {'Accuracy': 0.9433225521293729, 'Sensitivity': 0.3273481276185781, 'Specificity': 0.9466032054489955, 'Precision': 0.10074604354764063, 'NPV': 0.9888179635573205, 'F1 Score': 0.15365696648405583, "Youden's Index": 0.27395133306757347, "Cohen's Kappa": 0.1330095005145913, 'AUC-ROC': 0.7589146670984294, 'AUC-PR': 0.0734941468253337, 'Log Loss': 0.27813759460890425, 'Brier': 0.06782915617254433, 'ECE': 0.2047985913476011, 'MCE': 0.7265795644237127}
2025-04-24 10:29:15,048 - INFO - Trial 7: AUC-ROC=0.759 AUC-PR=0.073 Sens=0.327 Spec=0.947 Prec=0.101 Score=-inf
2025-04-24 10:29:15,048 - INFO - [04-24 10:29:15][Trial 8/10] AUC-ROC=0.759 AUC-PR=0.073 Sens=0.327 Spec=0.947 Prec=0.101 Score=-inf
2025-04-24 10:29:16,004 - INFO - Fold 1/5 metrics: Sensitivity=0.260, Specificity=0.930, AUC-ROC=0.704
2025-04-24 10:29:16,904 - INFO - Fold 2/5 metrics: Sensitivity=0.396, Specificity=0.939, AUC-ROC=0.758
2025-04-24 10:29:17,799 - INFO - Fold 3/5 metrics: Sensitivity=0.324, Specificity=0.935, AUC-ROC=0.774
2025-04-24 10:29:18,689 - INFO - Fold 4/5 metrics: Sensitivity=0.319, Specificity=0.924, AUC-ROC=0.704
2025-04-24 10:29:19,575 - INFO - Fold 5/5 metrics: Sensitivity=0.323, Specificity=0.944, AUC-ROC=0.706
2025-04-24 10:29:19,577 - INFO - [Trial 8] 5-fold mean metrics: {'Accuracy': 0.932358539229836, 'Sensitivity': 0.3242971539398812, 'Specificity': 0.9343567246121646, 'Precision': 0.08206375927267655, 'NPV': 0.9891382892680143, 'F1 Score': 0.1307737012276345, "Youden's Index": 0.25865387855204575, "Cohen's Kappa": 0.10865787486846956, 'AUC-ROC': 0.7292141282098823, 'AUC-PR': 0.06532156329426389, 'Log Loss': 0.18990277922370263, 'Brier': 0.053400483364934394, 'ECE': 0.09572389118406294, 'MCE': 0.8488138202984455}
2025-04-24 10:29:19,577 - INFO - Trial 8: AUC-ROC=0.729 AUC-PR=0.065 Sens=0.324 Spec=0.934 Prec=0.082 Score=-inf
2025-04-24 10:29:19,577 - INFO - [04-24 10:29:19][Trial 9/10] AUC-ROC=0.729 AUC-PR=0.065 Sens=0.324 Spec=0.934 Prec=0.082 Score=-inf
2025-04-24 10:29:21,077 - INFO - Fold 1/5 metrics: Sensitivity=0.236, Specificity=0.972, AUC-ROC=0.740
2025-04-24 10:29:22,576 - INFO - Fold 2/5 metrics: Sensitivity=0.427, Specificity=0.976, AUC-ROC=0.788
2025-04-24 10:29:24,063 - INFO - Fold 3/5 metrics: Sensitivity=0.461, Specificity=0.965, AUC-ROC=0.840
2025-04-24 10:29:25,502 - INFO - Fold 4/5 metrics: Sensitivity=0.423, Specificity=0.956, AUC-ROC=0.659
2025-04-24 10:29:26,886 - INFO - Fold 5/5 metrics: Sensitivity=0.232, Specificity=0.977, AUC-ROC=0.738
2025-04-24 10:29:26,887 - INFO - [Trial 9] 5-fold mean metrics: {'Accuracy': 0.9643692371491905, 'Sensitivity': 0.3557977386266951, 'Specificity': 0.9693301018277367, 'Precision': 0.17558501421734346, 'NPV': 0.9896458726061429, 'F1 Score': 0.2326803701376392, "Youden's Index": 0.3251278404544318, "Cohen's Kappa": 0.2166719181354675, 'AUC-ROC': 0.7529810050204866, 'AUC-PR': 0.16399828324639734, 'Log Loss': 0.11949486413113411, 'Brier': 0.029727284004788024, 'ECE': 0.03858773720157339, 'MCE': 0.7536743996903829}
2025-04-24 10:29:26,887 - INFO - Trial 9: AUC-ROC=0.753 AUC-PR=0.164 Sens=0.356 Spec=0.969 Prec=0.176 Score=-inf
2025-04-24 10:29:26,888 - INFO - [04-24 10:29:26][Trial 10/10] AUC-ROC=0.753 AUC-PR=0.164 Sens=0.356 Spec=0.969 Prec=0.176 Score=-inf
2025-04-24 10:29:26,888 - INFO - Training finished. Best score: -inf
2025-04-24 10:29:26,888 - INFO - Optimization finished. Best score: -inf
2025-04-24 10:29:26,888 - INFO - Best parameters:
2025-04-24 10:29:26,888 - INFO - n_estimators: 800
2025-04-24 10:29:26,888 - INFO - max_depth: 10
2025-04-24 10:29:26,888 - INFO - learning_rate: 0.004302570478260816
2025-04-24 10:29:26,888 - INFO - subsample: 0.547168494554797
2025-04-24 10:29:26,888 - INFO - colsample_bytree: 0.7007779329653695
2025-04-24 10:29:26,888 - INFO - reg_alpha: 2.377235078202275
2025-04-24 10:29:26,888 - INFO - reg_lambda: 3.9992343544780757
2025-04-24 10:29:26,888 - INFO - use_label_encoder: False
2025-04-24 10:29:26,888 - INFO - random_state: 42
2025-04-24 10:29:26,888 - INFO - eval_metric: logloss
2025-04-24 10:29:26,889 - INFO - Best CV metrics:
2025-04-24 10:29:26,889 - INFO - Accuracy: 0.933
2025-04-24 10:29:26,889 - INFO - Sensitivity: 0.305
2025-04-24 10:29:26,889 - INFO - Specificity: 0.933
2025-04-24 10:29:26,889 - INFO - Precision: 0.079
2025-04-24 10:29:26,889 - INFO - NPV: 0.989
2025-04-24 10:29:26,889 - INFO - F1 Score: 0.125
2025-04-24 10:29:26,889 - INFO - Youden's Index: 0.238
2025-04-24 10:29:26,889 - INFO - Cohen's Kappa: 0.103
2025-04-24 10:29:26,889 - INFO - AUC-ROC: 0.746
2025-04-24 10:29:26,889 - INFO - AUC-PR: 0.065
2025-04-24 10:29:26,889 - INFO - Log Loss: 0.232
2025-04-24 10:29:26,889 - INFO - Brier: 0.061
2025-04-24 10:29:26,889 - INFO - ECE: 0.152
2025-04-24 10:29:26,889 - INFO - MCE: 0.854
2025-04-24 10:29:26,889 - INFO - Final best parameters:
2025-04-24 10:29:26,889 - INFO - n_estimators: 800
2025-04-24 10:29:26,889 - INFO - max_depth: 10
2025-04-24 10:29:26,889 - INFO - learning_rate: 0.004302570478260816
2025-04-24 10:29:26,889 - INFO - subsample: 0.547168494554797
2025-04-24 10:29:26,889 - INFO - colsample_bytree: 0.7007779329653695
2025-04-24 10:29:26,889 - INFO - reg_alpha: 2.377235078202275
2025-04-24 10:29:26,889 - INFO - reg_lambda: 3.9992343544780757
2025-04-24 10:29:26,889 - INFO - use_label_encoder: False
2025-04-24 10:29:26,889 - INFO - random_state: 42
2025-04-24 10:29:26,889 - INFO - eval_metric: logloss
2025-04-24 10:29:26,889 - INFO - Final best metrics (CV mean):
2025-04-24 10:29:26,889 - INFO - Accuracy: 0.933
2025-04-24 10:29:26,889 - INFO - Sensitivity: 0.305
2025-04-24 10:29:26,889 - INFO - Specificity: 0.933
2025-04-24 10:29:26,889 - INFO - Precision: 0.079
2025-04-24 10:29:26,889 - INFO - NPV: 0.989
2025-04-24 10:29:26,889 - INFO - F1 Score: 0.125
2025-04-24 10:29:26,889 - INFO - Youden's Index: 0.238
2025-04-24 10:29:26,889 - INFO - Cohen's Kappa: 0.103
2025-04-24 10:29:26,889 - INFO - AUC-ROC: 0.746
2025-04-24 10:29:26,889 - INFO - AUC-PR: 0.065
2025-04-24 10:29:26,889 - INFO - Log Loss: 0.232
2025-04-24 10:29:26,889 - INFO - Brier: 0.061
2025-04-24 10:29:26,889 - INFO - ECE: 0.152
2025-04-24 10:29:26,889 - INFO - MCE: 0.854
2025-04-24 10:29:26,889 - INFO - Evaluating on held-out test set (never seen during training/tuning)...
2025-04-24 10:31:10,402 - INFO - Starting XGBoost model training
2025-04-24 10:31:10,403 - INFO - [并行调参说明] 本脚本支持Optuna多进程/多机并行调参，只需多开终端运行本脚本即可，Optuna会自动分配trial。
2025-04-24 10:31:10,444 - INFO - Running 10 trials for hyperparameter optimization
2025-04-24 10:31:10,444 - INFO - Found existing XGBoost_best_params.json, evaluating initial score...
2025-04-24 10:31:12,197 - INFO - Fold 1/5 metrics: Sensitivity=0.215, Specificity=0.926, AUC-ROC=0.704
2025-04-24 10:31:13,987 - INFO - Fold 2/5 metrics: Sensitivity=0.377, Specificity=0.937, AUC-ROC=0.765
2025-04-24 10:31:15,747 - INFO - Fold 3/5 metrics: Sensitivity=0.357, Specificity=0.942, AUC-ROC=0.803
2025-04-24 10:31:17,518 - INFO - Fold 4/5 metrics: Sensitivity=0.326, Specificity=0.924, AUC-ROC=0.725
2025-04-24 10:31:19,342 - INFO - Fold 5/5 metrics: Sensitivity=0.247, Specificity=0.939, AUC-ROC=0.735
2025-04-24 10:31:19,344 - INFO - [Trial ?] 5-fold mean metrics: {'Accuracy': 0.9331771084076129, 'Sensitivity': 0.30468720242957337, 'Specificity': 0.9334736615247495, 'Precision': 0.07894531522482925, 'NPV': 0.9886652823103403, 'F1 Score': 0.1252119721132871, "Youden's Index": 0.23816086395432284, "Cohen's Kappa": 0.10303959115905421, 'AUC-ROC': 0.7464261885560912, 'AUC-PR': 0.06475524428860323, 'Log Loss': 0.2321585101278126, 'Brier': 0.060862754141211825, 'ECE': 0.15218786883378427, 'MCE': 0.8537496914250753}
2025-04-24 10:31:19,344 - ERROR - Error loading existing params: 'PseudoTrial' object has no attribute 'number'
2025-04-24 10:31:19,344 - INFO - Starting optimization from scratch due to error loading params.
2025-04-24 10:31:19,654 - INFO - Fold 1/5 metrics: Sensitivity=0.272, Specificity=0.954, AUC-ROC=0.728
2025-04-24 10:31:19,924 - INFO - Fold 2/5 metrics: Sensitivity=0.421, Specificity=0.966, AUC-ROC=0.787
2025-04-24 10:31:20,202 - INFO - Fold 3/5 metrics: Sensitivity=0.475, Specificity=0.957, AUC-ROC=0.821
2025-04-24 10:31:20,477 - INFO - Fold 4/5 metrics: Sensitivity=0.413, Specificity=0.942, AUC-ROC=0.707
2025-04-24 10:31:20,748 - INFO - Fold 5/5 metrics: Sensitivity=0.329, Specificity=0.964, AUC-ROC=0.729
2025-04-24 10:31:20,750 - INFO - [Trial 0] 5-fold mean metrics: {'Accuracy': 0.9527529009116039, 'Sensitivity': 0.38210845407291194, 'Specificity': 0.9564217954946432, 'Precision': 0.1378919916855917, 'NPV': 0.9897309513365842, 'F1 Score': 0.20186073375683625, "Youden's Index": 0.33853024956755506, "Cohen's Kappa": 0.18321262677265443, 'AUC-ROC': 0.7543884775216082, 'AUC-PR': 0.10683843256660666, 'Log Loss': 0.1448212252699818, 'Brier': 0.0385413071151023, 'ECE': 0.06507597498610665, 'MCE': 0.7950853301938701}
2025-04-24 10:31:20,750 - INFO - Trial 0: AUC-ROC=0.754 AUC-PR=0.107 Sens=0.382 Spec=0.956 Prec=0.138 Score=-inf
2025-04-24 10:31:20,750 - INFO - [04-24 10:31:20][Trial 1/10] AUC-ROC=0.754 AUC-PR=0.107 Sens=0.382 Spec=0.956 Prec=0.138 Score=-inf
2025-04-24 10:31:21,217 - INFO - Fold 1/5 metrics: Sensitivity=0.271, Specificity=0.969, AUC-ROC=0.728
2025-04-24 10:31:21,683 - INFO - Fold 2/5 metrics: Sensitivity=0.427, Specificity=0.972, AUC-ROC=0.772
2025-04-24 10:31:22,239 - INFO - Fold 3/5 metrics: Sensitivity=0.487, Specificity=0.966, AUC-ROC=0.832
2025-04-24 10:31:22,708 - INFO - Fold 4/5 metrics: Sensitivity=0.410, Specificity=0.959, AUC-ROC=0.687
2025-04-24 10:31:23,191 - INFO - Fold 5/5 metrics: Sensitivity=0.232, Specificity=0.980, AUC-ROC=0.700
2025-04-24 10:31:23,193 - INFO - [Trial 1] 5-fold mean metrics: {'Accuracy': 0.9639064019196907, 'Sensitivity': 0.3655848374429976, 'Specificity': 0.9691097165553172, 'Precision': 0.17921895497861773, 'NPV': 0.9898640666862241, 'F1 Score': 0.23767001902712348, "Youden's Index": 0.33469455399831494, "Cohen's Kappa": 0.22160823579674602, 'AUC-ROC': 0.7439076220624138, 'AUC-PR': 0.17580524220010801, 'Log Loss': 0.13012590231338686, 'Brier': 0.03023114859653877, 'ECE': 0.036505436354737644, 'MCE': 0.7657120757871066}
2025-04-24 10:31:23,193 - INFO - Trial 1: AUC-ROC=0.744 AUC-PR=0.176 Sens=0.366 Spec=0.969 Prec=0.179 Score=-inf
2025-04-24 10:31:23,194 - INFO - [04-24 10:31:23][Trial 2/10] AUC-ROC=0.744 AUC-PR=0.176 Sens=0.366 Spec=0.969 Prec=0.179 Score=-inf
2025-04-24 10:31:23,384 - INFO - Fold 1/5 metrics: Sensitivity=0.264, Specificity=0.970, AUC-ROC=0.738
2025-04-24 10:31:23,567 - INFO - Fold 2/5 metrics: Sensitivity=0.449, Specificity=0.972, AUC-ROC=0.756
2025-04-24 10:31:23,745 - INFO - Fold 3/5 metrics: Sensitivity=0.478, Specificity=0.961, AUC-ROC=0.832
2025-04-24 10:31:23,921 - INFO - Fold 4/5 metrics: Sensitivity=0.403, Specificity=0.963, AUC-ROC=0.685
2025-04-24 10:31:24,097 - INFO - Fold 5/5 metrics: Sensitivity=0.232, Specificity=0.976, AUC-ROC=0.708
2025-04-24 10:31:24,098 - INFO - [Trial 2] 5-fold mean metrics: {'Accuracy': 0.9630536625920261, 'Sensitivity': 0.36535596212538424, 'Specificity': 0.9686680936917457, 'Precision': 0.17020635810083987, 'NPV': 0.9895239858814403, 'F1 Score': 0.23100368354339534, "Youden's Index": 0.3340240558171298, "Cohen's Kappa": 0.21458514224796107, 'AUC-ROC': 0.7439531052198836, 'AUC-PR': 0.1629997365018742, 'Log Loss': 0.13294539373027217, 'Brier': 0.031371986041803676, 'ECE': 0.03826542938790146, 'MCE': 0.7771622662775449}
2025-04-24 10:31:24,098 - INFO - Trial 2: AUC-ROC=0.744 AUC-PR=0.163 Sens=0.365 Spec=0.969 Prec=0.170 Score=-inf
2025-04-24 10:31:24,099 - INFO - [04-24 10:31:24][Trial 3/10] AUC-ROC=0.744 AUC-PR=0.163 Sens=0.365 Spec=0.969 Prec=0.170 Score=-inf
2025-04-24 10:31:24,697 - INFO - Fold 1/5 metrics: Sensitivity=0.385, Specificity=0.913, AUC-ROC=0.711
2025-04-24 10:31:25,267 - INFO - Fold 2/5 metrics: Sensitivity=0.371, Specificity=0.917, AUC-ROC=0.749
2025-04-24 10:31:25,837 - INFO - Fold 3/5 metrics: Sensitivity=0.431, Specificity=0.927, AUC-ROC=0.776
2025-04-24 10:31:26,414 - INFO - Fold 4/5 metrics: Sensitivity=0.389, Specificity=0.913, AUC-ROC=0.723
2025-04-24 10:31:26,982 - INFO - Fold 5/5 metrics: Sensitivity=0.267, Specificity=0.927, AUC-ROC=0.705
2025-04-24 10:31:26,983 - INFO - [Trial 3] 5-fold mean metrics: {'Accuracy': 0.9241157724160587, 'Sensitivity': 0.3688311082549498, 'Specificity': 0.9191314506830117, 'Precision': 0.07976512660524906, 'NPV': 0.9899044870563369, 'F1 Score': 0.13105811384906643, "Youden's Index": 0.2879625589379615, "Cohen's Kappa": 0.10829987638183629, 'AUC-ROC': 0.7327872308624841, 'AUC-PR': 0.06339535777250918, 'Log Loss': 0.3717683211232402, 'Brier': 0.10340535439487634, 'ECE': 0.2776410702259849, 'MCE': 0.7796934965668035}
2025-04-24 10:31:26,984 - INFO - Trial 3: AUC-ROC=0.733 AUC-PR=0.063 Sens=0.369 Spec=0.919 Prec=0.080 Score=-inf
2025-04-24 10:31:26,984 - INFO - [04-24 10:31:26][Trial 4/10] AUC-ROC=0.733 AUC-PR=0.063 Sens=0.369 Spec=0.919 Prec=0.080 Score=-inf
2025-04-24 10:31:27,970 - INFO - Fold 1/5 metrics: Sensitivity=0.223, Specificity=0.973, AUC-ROC=0.744
2025-04-24 10:31:28,928 - INFO - Fold 2/5 metrics: Sensitivity=0.427, Specificity=0.981, AUC-ROC=0.804
2025-04-24 10:31:29,892 - INFO - Fold 3/5 metrics: Sensitivity=0.487, Specificity=0.972, AUC-ROC=0.861
2025-04-24 10:31:30,842 - INFO - Fold 4/5 metrics: Sensitivity=0.350, Specificity=0.963, AUC-ROC=0.684
2025-04-24 10:31:31,828 - INFO - Fold 5/5 metrics: Sensitivity=0.232, Specificity=0.983, AUC-ROC=0.768
2025-04-24 10:31:31,829 - INFO - [Trial 4] 5-fold mean metrics: {'Accuracy': 0.9671338406906493, 'Sensitivity': 0.3438036664861245, 'Specificity': 0.9745154872401798, 'Precision': 0.19226229770706466, 'NPV': 0.9893619066616518, 'F1 Score': 0.2450837069993715, "Youden's Index": 0.3183191537263042, "Cohen's Kappa": 0.22978694331017885, 'AUC-ROC': 0.7721434671528117, 'AUC-PR': 0.1690938744339323, 'Log Loss': 0.10735191343893109, 'Brier': 0.02682785509758807, 'ECE': 0.031569194021565786, 'MCE': 0.6874979959908872}
2025-04-24 10:31:31,829 - INFO - Trial 4: AUC-ROC=0.772 AUC-PR=0.169 Sens=0.344 Spec=0.975 Prec=0.192 Score=-inf
2025-04-24 10:31:31,830 - INFO - [04-24 10:31:31][Trial 5/10] AUC-ROC=0.772 AUC-PR=0.169 Sens=0.344 Spec=0.975 Prec=0.192 Score=-inf
2025-04-24 10:31:33,191 - INFO - Fold 1/5 metrics: Sensitivity=0.255, Specificity=0.959, AUC-ROC=0.747
2025-04-24 10:31:34,564 - INFO - Fold 2/5 metrics: Sensitivity=0.463, Specificity=0.969, AUC-ROC=0.789
2025-04-24 10:31:35,925 - INFO - Fold 3/5 metrics: Sensitivity=0.457, Specificity=0.958, AUC-ROC=0.824
2025-04-24 10:31:37,298 - INFO - Fold 4/5 metrics: Sensitivity=0.392, Specificity=0.946, AUC-ROC=0.656
2025-04-24 10:31:38,672 - INFO - Fold 5/5 metrics: Sensitivity=0.211, Specificity=0.970, AUC-ROC=0.713
2025-04-24 10:31:38,674 - INFO - [Trial 5] 5-fold mean metrics: {'Accuracy': 0.9551344765547455, 'Sensitivity': 0.35578509357376786, 'Specificity': 0.9605041587066185, 'Precision': 0.13712266234773884, 'NPV': 0.9893268404954574, 'F1 Score': 0.19683134634088356, "Youden's Index": 0.3162892522803864, "Cohen's Kappa": 0.1785399953273202, 'AUC-ROC': 0.7456532901526292, 'AUC-PR': 0.11916807932472526, 'Log Loss': 0.1353641799878622, 'Brier': 0.03564448893784389, 'ECE': 0.05564965999750086, 'MCE': 0.8013698622237673}
2025-04-24 10:31:38,674 - INFO - Trial 5: AUC-ROC=0.746 AUC-PR=0.119 Sens=0.356 Spec=0.961 Prec=0.137 Score=-inf
2025-04-24 10:31:38,674 - INFO - [04-24 10:31:38][Trial 6/10] AUC-ROC=0.746 AUC-PR=0.119 Sens=0.356 Spec=0.961 Prec=0.137 Score=-inf
2025-04-24 10:31:39,001 - INFO - Fold 1/5 metrics: Sensitivity=0.317, Specificity=0.843, AUC-ROC=0.671
2025-04-24 10:31:39,311 - INFO - Fold 2/5 metrics: Sensitivity=0.535, Specificity=0.835, AUC-ROC=0.667
2025-04-24 10:31:39,619 - INFO - Fold 3/5 metrics: Sensitivity=0.382, Specificity=0.833, AUC-ROC=0.723
2025-04-24 10:31:39,976 - INFO - Fold 4/5 metrics: Sensitivity=0.406, Specificity=0.843, AUC-ROC=0.702
2025-04-24 10:31:40,287 - INFO - Fold 5/5 metrics: Sensitivity=0.543, Specificity=0.855, AUC-ROC=0.712
2025-04-24 10:31:40,289 - INFO - [Trial 6] 5-fold mean metrics: {'Accuracy': 0.8546323712459376, 'Sensitivity': 0.4366772200467975, 'Specificity': 0.8417931446786697, 'Precision': 0.0477611113935968, 'NPV': 0.9906502672633462, 'F1 Score': 0.08603303655173697, "Youden's Index": 0.2784703647254672, "Cohen's Kappa": 0.05973232681255321, 'AUC-ROC': 0.6949092721601993, 'AUC-PR': 0.04695675217923699, 'Log Loss': 0.47514369872300877, 'Brier': 0.148209288013658, 'ECE': 0.3428128614249933, 'MCE': 0.6995299166559003}
2025-04-24 10:31:40,289 - INFO - Trial 6: AUC-ROC=0.695 AUC-PR=0.047 Sens=0.437 Spec=0.842 Prec=0.048 Score=-inf
2025-04-24 10:31:40,289 - INFO - [04-24 10:31:40][Trial 7/10] AUC-ROC=0.695 AUC-PR=0.047 Sens=0.437 Spec=0.842 Prec=0.048 Score=-inf
2025-04-24 10:31:41,210 - INFO - Fold 1/5 metrics: Sensitivity=0.272, Specificity=0.940, AUC-ROC=0.722
2025-04-24 10:31:42,133 - INFO - Fold 2/5 metrics: Sensitivity=0.377, Specificity=0.948, AUC-ROC=0.784
2025-04-24 10:31:43,066 - INFO - Fold 3/5 metrics: Sensitivity=0.316, Specificity=0.950, AUC-ROC=0.805
2025-04-24 10:31:43,997 - INFO - Fold 4/5 metrics: Sensitivity=0.326, Specificity=0.934, AUC-ROC=0.725
2025-04-24 10:31:44,991 - INFO - Fold 5/5 metrics: Sensitivity=0.247, Specificity=0.951, AUC-ROC=0.723
2025-04-24 10:31:44,992 - INFO - [Trial 7] 5-fold mean metrics: {'Accuracy': 0.9441595239515725, 'Sensitivity': 0.30780411846331757, 'Specificity': 0.944947758949651, 'Precision': 0.09833968750802943, 'NPV': 0.9890329242549756, 'F1 Score': 0.1483683441564597, "Youden's Index": 0.2527518774129687, "Cohen's Kappa": 0.12776644099128995, 'AUC-ROC': 0.7520694221103199, 'AUC-PR': 0.0750219689280439, 'Log Loss': 0.2590427908586689, 'Brier': 0.06423739871383051, 'ECE': 0.18628830859680826, 'MCE': 0.7127090487619883}
2025-04-24 10:31:44,992 - INFO - Trial 7: AUC-ROC=0.752 AUC-PR=0.075 Sens=0.308 Spec=0.945 Prec=0.098 Score=-inf
2025-04-24 10:31:44,992 - INFO - [04-24 10:31:44][Trial 8/10] AUC-ROC=0.752 AUC-PR=0.075 Sens=0.308 Spec=0.945 Prec=0.098 Score=-inf
2025-04-24 10:31:46,991 - INFO - Fold 1/5 metrics: Sensitivity=0.229, Specificity=0.956, AUC-ROC=0.744
2025-04-24 10:31:48,991 - INFO - Fold 2/5 metrics: Sensitivity=0.266, Specificity=0.969, AUC-ROC=0.806
2025-04-24 10:31:51,066 - INFO - Fold 3/5 metrics: Sensitivity=0.504, Specificity=0.966, AUC-ROC=0.828
2025-04-24 10:31:53,275 - INFO - Fold 4/5 metrics: Sensitivity=0.287, Specificity=0.945, AUC-ROC=0.697
2025-04-24 10:31:55,220 - INFO - Fold 5/5 metrics: Sensitivity=0.305, Specificity=0.970, AUC-ROC=0.745
2025-04-24 10:31:55,221 - INFO - [Trial 8] 5-fold mean metrics: {'Accuracy': 0.9560445695985231, 'Sensitivity': 0.3182999779752239, 'Specificity': 0.961165984202881, 'Precision': 0.13756279181046924, 'NPV': 0.9888777743132471, 'F1 Score': 0.1911615871152956, "Youden's Index": 0.279465962178105, "Cohen's Kappa": 0.17282125596643352, 'AUC-ROC': 0.7640732567183238, 'AUC-PR': 0.1130414244186336, 'Log Loss': 0.1393251617600851, 'Brier': 0.0359332981203387, 'ECE': 0.06905707929501992, 'MCE': 0.7606029547655886}
2025-04-24 10:31:55,221 - INFO - Trial 8: AUC-ROC=0.764 AUC-PR=0.113 Sens=0.318 Spec=0.961 Prec=0.138 Score=-inf
2025-04-24 10:31:55,222 - INFO - [04-24 10:31:55][Trial 9/10] AUC-ROC=0.764 AUC-PR=0.113 Sens=0.318 Spec=0.961 Prec=0.138 Score=-inf
2025-04-24 10:31:55,542 - INFO - Fold 1/5 metrics: Sensitivity=0.248, Specificity=0.950, AUC-ROC=0.752
2025-04-24 10:31:55,833 - INFO - Fold 2/5 metrics: Sensitivity=0.463, Specificity=0.962, AUC-ROC=0.788
2025-04-24 10:31:56,118 - INFO - Fold 3/5 metrics: Sensitivity=0.504, Specificity=0.956, AUC-ROC=0.830
2025-04-24 10:31:56,437 - INFO - Fold 4/5 metrics: Sensitivity=0.293, Specificity=0.942, AUC-ROC=0.633
2025-04-24 10:31:56,727 - INFO - Fold 5/5 metrics: Sensitivity=0.309, Specificity=0.962, AUC-ROC=0.747
2025-04-24 10:31:56,728 - INFO - [Trial 9] 5-fold mean metrics: {'Accuracy': 0.9512741090424616, 'Sensitivity': 0.3634732131545684, 'Specificity': 0.9544360146063079, 'Precision': 0.12925522523111221, 'NPV': 0.9891375406502526, 'F1 Score': 0.19054034107875584, "Youden's Index": 0.31790922776087627, "Cohen's Kappa": 0.17144139783254575, 'AUC-ROC': 0.7501328539045995, 'AUC-PR': 0.09989258830786449, 'Log Loss': 0.14471162832581164, 'Brier': 0.03863235589895803, 'ECE': 0.06502455063002034, 'MCE': 0.7917417985314082}
2025-04-24 10:31:56,729 - INFO - Trial 9: AUC-ROC=0.750 AUC-PR=0.100 Sens=0.363 Spec=0.954 Prec=0.129 Score=-inf
2025-04-24 10:31:56,729 - INFO - [04-24 10:31:56][Trial 10/10] AUC-ROC=0.750 AUC-PR=0.100 Sens=0.363 Spec=0.954 Prec=0.129 Score=-inf
2025-04-24 10:31:56,729 - INFO - Training finished. Best score: -inf
2025-04-24 10:31:56,729 - INFO - Optimization finished. Best score: -inf
2025-04-24 10:31:56,729 - INFO - Best parameters:
2025-04-24 10:31:56,729 - INFO - n_estimators: 100
2025-04-24 10:31:56,729 - INFO - max_depth: 15
2025-04-24 10:31:56,729 - INFO - learning_rate: 0.1854264162051135
2025-04-24 10:31:56,729 - INFO - subsample: 0.8905455730124703
2025-04-24 10:31:56,729 - INFO - colsample_bytree: 0.4781333398983014
2025-04-24 10:31:56,729 - INFO - reg_alpha: 4.585814266599354
2025-04-24 10:31:56,729 - INFO - reg_lambda: 1.1575714377647206
2025-04-24 10:31:56,729 - INFO - use_label_encoder: False
2025-04-24 10:31:56,729 - INFO - random_state: 42
2025-04-24 10:31:56,729 - INFO - eval_metric: logloss
2025-04-24 10:31:56,730 - INFO - Best CV metrics:
2025-04-24 10:31:56,730 - INFO - Accuracy: 0.953
2025-04-24 10:31:56,730 - INFO - Sensitivity: 0.382
2025-04-24 10:31:56,730 - INFO - Specificity: 0.956
2025-04-24 10:31:56,730 - INFO - Precision: 0.138
2025-04-24 10:31:56,730 - INFO - NPV: 0.990
2025-04-24 10:31:56,731 - INFO - F1 Score: 0.202
2025-04-24 10:31:56,731 - INFO - Youden's Index: 0.339
2025-04-24 10:31:56,731 - INFO - Cohen's Kappa: 0.183
2025-04-24 10:31:56,731 - INFO - AUC-ROC: 0.754
2025-04-24 10:31:56,731 - INFO - AUC-PR: 0.107
2025-04-24 10:31:56,731 - INFO - Log Loss: 0.145
2025-04-24 10:31:56,731 - INFO - Brier: 0.039
2025-04-24 10:31:56,731 - INFO - ECE: 0.065
2025-04-24 10:31:56,731 - INFO - MCE: 0.795
2025-04-24 10:31:56,731 - INFO - Final best parameters:
2025-04-24 10:31:56,731 - INFO - n_estimators: 100
2025-04-24 10:31:56,731 - INFO - max_depth: 15
2025-04-24 10:31:56,731 - INFO - learning_rate: 0.1854264162051135
2025-04-24 10:31:56,731 - INFO - subsample: 0.8905455730124703
2025-04-24 10:31:56,731 - INFO - colsample_bytree: 0.4781333398983014
2025-04-24 10:31:56,731 - INFO - reg_alpha: 4.585814266599354
2025-04-24 10:31:56,731 - INFO - reg_lambda: 1.1575714377647206
2025-04-24 10:31:56,731 - INFO - use_label_encoder: False
2025-04-24 10:31:56,731 - INFO - random_state: 42
2025-04-24 10:31:56,731 - INFO - eval_metric: logloss
2025-04-24 10:31:56,731 - INFO - Final best metrics (CV mean):
2025-04-24 10:31:56,731 - INFO - Accuracy: 0.953
2025-04-24 10:31:56,731 - INFO - Sensitivity: 0.382
2025-04-24 10:31:56,731 - INFO - Specificity: 0.956
2025-04-24 10:31:56,731 - INFO - Precision: 0.138
2025-04-24 10:31:56,731 - INFO - NPV: 0.990
2025-04-24 10:31:56,731 - INFO - F1 Score: 0.202
2025-04-24 10:31:56,731 - INFO - Youden's Index: 0.339
2025-04-24 10:31:56,731 - INFO - Cohen's Kappa: 0.183
2025-04-24 10:31:56,731 - INFO - AUC-ROC: 0.754
2025-04-24 10:31:56,731 - INFO - AUC-PR: 0.107
2025-04-24 10:31:56,731 - INFO - Log Loss: 0.145
2025-04-24 10:31:56,731 - INFO - Brier: 0.039
2025-04-24 10:31:56,731 - INFO - ECE: 0.065
2025-04-24 10:31:56,731 - INFO - MCE: 0.795
2025-04-24 10:31:56,731 - INFO - Evaluating on held-out test set (never seen during training/tuning)...
2025-04-24 10:31:57,306 - INFO - Test set metrics (never seen during training/tuning):
2025-04-24 10:31:57,307 - INFO - Accuracy: 0.954
2025-04-24 10:31:57,307 - INFO - Sensitivity: 0.568
2025-04-24 10:31:57,307 - INFO - Specificity: 0.942
2025-04-24 10:31:57,307 - INFO - Precision: 0.209
2025-04-24 10:31:57,307 - INFO - NPV: 0.991
2025-04-24 10:31:57,307 - INFO - F1 Score: 0.306
2025-04-24 10:31:57,307 - INFO - Youden's Index: 0.510
2025-04-24 10:31:57,307 - INFO - Cohen's Kappa: 0.287
2025-04-24 10:31:57,307 - INFO - AUC-ROC: 0.804
2025-04-24 10:31:57,307 - INFO - AUC-PR: 0.412
2025-04-24 10:31:57,307 - INFO - Log Loss: 0.169
2025-04-24 10:31:57,307 - INFO - Brier: 0.037
2025-04-24 10:31:57,307 - INFO - ECE: 0.043
2025-04-24 10:31:57,307 - INFO - MCE: 0.733
2025-04-24 10:42:21,639 - INFO - Starting XGBoost model training
2025-04-24 10:42:21,639 - INFO - [并行调参说明] 本脚本支持Optuna多进程/多机并行调参，只需多开终端运行本脚本即可，Optuna会自动分配trial。
2025-04-24 10:42:21,681 - INFO - Running 10 trials for hyperparameter optimization
2025-04-24 10:42:21,681 - INFO - Found existing XGBoost_best_params.json, evaluating initial score...
2025-04-24 10:42:22,560 - INFO - [Trial ?] 5-fold mean metrics: {'Accuracy': 0.851903376195893, 'Sensitivity': 0.6105635167934708, 'Specificity': 0.8411316844618643, 'Precision': 0.06287161237469711, 'NPV': 0.9929757210017325, 'F1 Score': 0.11392389504781261, "Youden's Index": 0.451695201255335, "Cohen's Kappa": 0.0882596137611921, 'AUC-ROC': 0.7530097815771055, 'AUC-PR': 0.09016337597394268, 'Log Loss': 0.3911839616549648, 'Brier': 0.11275298040447523, 'ECE': 0.17121281099880079, 'MCE': 0.840253370177714}
2025-04-24 10:42:22,560 - ERROR - Error loading existing params: 'PseudoTrial' object has no attribute 'number'
2025-04-24 10:42:22,560 - INFO - Starting optimization from scratch due to error loading params.
2025-04-24 10:42:23,681 - INFO - [Trial 0] 5-fold mean metrics: {'Accuracy': 0.8733554925104938, 'Sensitivity': 0.5334510180365211, 'Specificity': 0.8688236418605388, 'Precision': 0.06548748052496352, 'NPV': 0.9918192400420717, 'F1 Score': 0.116478721394881, "Youden's Index": 0.40227465989705974, "Cohen's Kappa": 0.09135017970045804, 'AUC-ROC': 0.744134951559982, 'AUC-PR': 0.07294680675293927, 'Log Loss': 0.3100235677358617, 'Brier': 0.09243102822406643, 'ECE': 0.17642092470051024, 'MCE': 0.8447927145405686}
2025-04-24 10:42:23,681 - INFO - Trial 0: AUC-ROC=0.744 AUC-PR=0.073 Sens=0.533 Spec=0.869 Prec=0.065 Score=-inf
2025-04-24 10:42:23,681 - INFO - [04-24 10:42:23][Trial 1/10] AUC-ROC=0.744 AUC-PR=0.073 Sens=0.533 Spec=0.869 Prec=0.065 Score=-inf
2025-04-24 10:42:27,703 - INFO - [Trial 1] 5-fold mean metrics: {'Accuracy': 0.7933856373936753, 'Sensitivity': 0.6108295690560809, 'Specificity': 0.7796807822824853, 'Precision': 0.045051797371742565, 'NPV': 0.9936806616768106, 'F1 Score': 0.08388704892628769, "Youden's Index": 0.39051035133856604, "Cohen's Kappa": 0.056620432430551815, 'AUC-ROC': 0.7689824577372951, 'AUC-PR': 0.07592292685173227, 'Log Loss': 0.553158994315974, 'Brier': 0.1575499786503551, 'ECE': 0.2323390623157778, 'MCE': 0.8827195269933252}
2025-04-24 10:42:27,703 - INFO - Trial 1: AUC-ROC=0.769 AUC-PR=0.076 Sens=0.611 Spec=0.780 Prec=0.045 Score=-inf
2025-04-24 10:42:27,703 - INFO - [04-24 10:42:27][Trial 2/10] AUC-ROC=0.769 AUC-PR=0.076 Sens=0.611 Spec=0.780 Prec=0.045 Score=-inf
2025-04-24 10:42:31,245 - INFO - [Trial 2] 5-fold mean metrics: {'Accuracy': 0.8589959315989087, 'Sensitivity': 0.5538354180869641, 'Specificity': 0.8492957412068103, 'Precision': 0.06048173090438068, 'NPV': 0.9926560703568519, 'F1 Score': 0.10897090000137996, "Youden's Index": 0.4031311592937744, "Cohen's Kappa": 0.0833245510012798, 'AUC-ROC': 0.7554488583920899, 'AUC-PR': 0.07981887279555004, 'Log Loss': 0.35741047354381916, 'Brier': 0.10592664969987171, 'ECE': 0.17131983149414648, 'MCE': 0.8377948649610547}
2025-04-24 10:42:31,245 - INFO - Trial 2: AUC-ROC=0.755 AUC-PR=0.080 Sens=0.554 Spec=0.849 Prec=0.060 Score=-inf
2025-04-24 10:42:31,245 - INFO - [04-24 10:42:31][Trial 3/10] AUC-ROC=0.755 AUC-PR=0.080 Sens=0.554 Spec=0.849 Prec=0.060 Score=-inf
2025-04-24 10:42:32,931 - INFO - [Trial 3] 5-fold mean metrics: {'Accuracy': 0.5479742439998163, 'Sensitivity': 0.7338800974547723, 'Specificity': 0.5158897781414338, 'Precision': 0.024615924564913887, 'NPV': 0.9926646912796461, 'F1 Score': 0.047615840365351034, "Youden's Index": 0.24976987559620606, "Cohen's Kappa": 0.018151276849226527, 'AUC-ROC': 0.717825544254542, 'AUC-PR': 0.05337509788988519, 'Log Loss': 0.8712010540685318, 'Brier': 0.300123755547712, 'ECE': 0.4607005145778321, 'MCE': 0.8728587753633257}
2025-04-24 10:42:32,931 - INFO - Trial 3: AUC-ROC=0.718 AUC-PR=0.053 Sens=0.734 Spec=0.516 Prec=0.025 Score=-inf
2025-04-24 10:42:32,931 - INFO - [04-24 10:42:32][Trial 4/10] AUC-ROC=0.718 AUC-PR=0.053 Sens=0.734 Spec=0.516 Prec=0.025 Score=-inf
2025-04-24 10:42:34,748 - INFO - [Trial 4] 5-fold mean metrics: {'Accuracy': 0.344277355390897, 'Sensitivity': 0.851576526047127, 'Specificity': 0.31432212047160013, 'Precision': 0.019620113173587573, 'NPV': 0.9939777348879855, 'F1 Score': 0.03834419692552113, "Youden's Index": 0.16589864651872696, "Cohen's Kappa": 0.008266351316746468, 'AUC-ROC': 0.6922260720246365, 'AUC-PR': 0.04734853465387075, 'Log Loss': 1.182374983700372, 'Brier': 0.421192437281492, 'ECE': 0.5902432762122178, 'MCE': 0.8844007758096893}
2025-04-24 10:42:34,748 - INFO - Trial 4: AUC-ROC=0.692 AUC-PR=0.047 Sens=0.852 Spec=0.314 Prec=0.020 Score=-inf
2025-04-24 10:42:34,748 - INFO - [04-24 10:42:34][Trial 5/10] AUC-ROC=0.692 AUC-PR=0.047 Sens=0.852 Spec=0.314 Prec=0.020 Score=-inf
2025-04-24 10:42:43,982 - INFO - [Trial 5] 5-fold mean metrics: {'Accuracy': 0.7639372746540468, 'Sensitivity': 0.6031619169032256, 'Specificity': 0.7512166849915193, 'Precision': 0.03909498074728179, 'NPV': 0.9933039311644629, 'F1 Score': 0.07339285753065823, "Youden's Index": 0.354378601894745, "Cohen's Kappa": 0.045585654652667104, 'AUC-ROC': 0.7600292529746321, 'AUC-PR': 0.07415796881669937, 'Log Loss': 0.57390984798865, 'Brier': 0.17241918673572992, 'ECE': 0.2607745215272363, 'MCE': 0.8725619769483985}
2025-04-24 10:42:43,982 - INFO - Trial 5: AUC-ROC=0.760 AUC-PR=0.074 Sens=0.603 Spec=0.751 Prec=0.039 Score=-inf
2025-04-24 10:42:43,982 - INFO - [04-24 10:42:43][Trial 6/10] AUC-ROC=0.760 AUC-PR=0.074 Sens=0.603 Spec=0.751 Prec=0.039 Score=-inf
2025-04-24 10:42:46,625 - INFO - [Trial 6] 5-fold mean metrics: {'Accuracy': 0.793928942202407, 'Sensitivity': 0.5882864190899987, 'Specificity': 0.787293267047288, 'Precision': 0.04372559541891531, 'NPV': 0.9929224178983258, 'F1 Score': 0.08134600894965527, "Youden's Index": 0.3755796861372866, "Cohen's Kappa": 0.054036781603759354, 'AUC-ROC': 0.7429779810942285, 'AUC-PR': 0.06713676969219654, 'Log Loss': 0.5381801946623976, 'Brier': 0.15649514408570114, 'ECE': 0.22230840307691277, 'MCE': 0.8811086645653304}
2025-04-24 10:42:46,625 - INFO - Trial 6: AUC-ROC=0.743 AUC-PR=0.067 Sens=0.588 Spec=0.787 Prec=0.044 Score=-inf
2025-04-24 10:42:46,625 - INFO - [04-24 10:42:46][Trial 7/10] AUC-ROC=0.743 AUC-PR=0.067 Sens=0.588 Spec=0.787 Prec=0.044 Score=-inf
2025-04-24 10:42:52,622 - INFO - [Trial 7] 5-fold mean metrics: {'Accuracy': 0.8164487870018838, 'Sensitivity': 0.5677332780793028, 'Specificity': 0.8047251941764714, 'Precision': 0.0475354452298262, 'NPV': 0.9925343185290071, 'F1 Score': 0.08766304387397347, "Youden's Index": 0.3724584722557741, "Cohen's Kappa": 0.06076546677694039, 'AUC-ROC': 0.7561916355234977, 'AUC-PR': 0.09245124580330391, 'Log Loss': 0.46516680380113823, 'Brier': 0.13597834429503475, 'ECE': 0.20934572751578226, 'MCE': 0.85377876687172}
2025-04-24 10:42:52,622 - INFO - Trial 7: AUC-ROC=0.756 AUC-PR=0.092 Sens=0.568 Spec=0.805 Prec=0.048 Score=-inf
2025-04-24 10:42:52,622 - INFO - [04-24 10:42:52][Trial 8/10] AUC-ROC=0.756 AUC-PR=0.092 Sens=0.568 Spec=0.805 Prec=0.048 Score=-inf
2025-04-24 10:42:58,135 - INFO - [Trial 8] 5-fold mean metrics: {'Accuracy': 0.40176771632388775, 'Sensitivity': 0.8710268327562656, 'Specificity': 0.3566899106161169, 'Precision': 0.022044054789027323, 'NPV': 0.9948683812822855, 'F1 Score': 0.0429899140042981, "Youden's Index": 0.22771674337238226, "Cohen's Kappa": 0.01312376625644691, 'AUC-ROC': 0.7649673652815531, 'AUC-PR': 0.06158925029784086, 'Log Loss': 1.089554377481773, 'Brier': 0.38976891695980737, 'ECE': 0.5786879242422028, 'MCE': 0.8625584497903729}
2025-04-24 10:42:58,135 - INFO - Trial 8: AUC-ROC=0.765 AUC-PR=0.062 Sens=0.871 Spec=0.357 Prec=0.022 Score=-inf
2025-04-24 10:42:58,135 - INFO - [04-24 10:42:58][Trial 9/10] AUC-ROC=0.765 AUC-PR=0.062 Sens=0.871 Spec=0.357 Prec=0.022 Score=-inf
2025-04-24 10:43:00,095 - INFO - [Trial 9] 5-fold mean metrics: {'Accuracy': 0.6425162494026457, 'Sensitivity': 0.6445229727115486, 'Specificity': 0.6290843418090344, 'Precision': 0.02772805736588214, 'NPV': 0.9928685609813176, 'F1 Score': 0.05314553895497219, "Youden's Index": 0.27360731452058284, "Cohen's Kappa": 0.024121538509365804, 'AUC-ROC': 0.7251549093712664, 'AUC-PR': 0.06087122470243509, 'Log Loss': 0.8721239555421436, 'Brier': 0.2611667547249948, 'ECE': 0.35673460790794104, 'MCE': 0.9061572856228253}
2025-04-24 10:43:00,095 - INFO - Trial 9: AUC-ROC=0.725 AUC-PR=0.061 Sens=0.645 Spec=0.629 Prec=0.028 Score=-inf
2025-04-24 10:43:00,095 - INFO - [04-24 10:43:00][Trial 10/10] AUC-ROC=0.725 AUC-PR=0.061 Sens=0.645 Spec=0.629 Prec=0.028 Score=-inf
2025-04-24 10:43:00,095 - INFO - Training finished. Best score: -inf
2025-04-24 10:43:00,095 - INFO - Optimization finished. Best score: -inf
2025-04-24 10:43:00,095 - INFO - Best parameters:
2025-04-24 10:43:00,095 - INFO - n_estimators: 200
2025-04-24 10:43:00,095 - INFO - max_depth: 30
2025-04-24 10:43:00,095 - INFO - learning_rate: 0.09989194772194634
2025-04-24 10:43:00,095 - INFO - subsample: 0.929704193942847
2025-04-24 10:43:00,095 - INFO - colsample_bytree: 0.5114158844808988
2025-04-24 10:43:00,095 - INFO - reg_alpha: 9.687438675087002
2025-04-24 10:43:00,095 - INFO - reg_lambda: 2.1511044623714604
2025-04-24 10:43:00,095 - INFO - scale_pos_weight: 3.4498340977848403
2025-04-24 10:43:00,095 - INFO - min_child_weight: 1.4876189243092222
2025-04-24 10:43:00,095 - INFO - gamma: 2.3244219540976307
2025-04-24 10:43:00,095 - INFO - random_state: 42
2025-04-24 10:43:00,095 - INFO - eval_metric: logloss
2025-04-24 10:43:00,097 - INFO - Best CV metrics:
2025-04-24 10:43:00,097 - INFO - Accuracy: 0.873
2025-04-24 10:43:00,097 - INFO - Sensitivity: 0.533
2025-04-24 10:43:00,097 - INFO - Specificity: 0.869
2025-04-24 10:43:00,097 - INFO - Precision: 0.065
2025-04-24 10:43:00,097 - INFO - NPV: 0.992
2025-04-24 10:43:00,097 - INFO - F1 Score: 0.116
2025-04-24 10:43:00,097 - INFO - Youden's Index: 0.402
2025-04-24 10:43:00,097 - INFO - Cohen's Kappa: 0.091
2025-04-24 10:43:00,097 - INFO - AUC-ROC: 0.744
2025-04-24 10:43:00,097 - INFO - AUC-PR: 0.073
2025-04-24 10:43:00,097 - INFO - Log Loss: 0.310
2025-04-24 10:43:00,097 - INFO - Brier: 0.092
2025-04-24 10:43:00,097 - INFO - ECE: 0.176
2025-04-24 10:43:00,097 - INFO - MCE: 0.845
2025-04-24 10:43:00,097 - INFO - Final best parameters:
2025-04-24 10:43:00,097 - INFO - n_estimators: 200
2025-04-24 10:43:00,097 - INFO - max_depth: 30
2025-04-24 10:43:00,097 - INFO - learning_rate: 0.09989194772194634
2025-04-24 10:43:00,097 - INFO - subsample: 0.929704193942847
2025-04-24 10:43:00,097 - INFO - colsample_bytree: 0.5114158844808988
2025-04-24 10:43:00,097 - INFO - reg_alpha: 9.687438675087002
2025-04-24 10:43:00,097 - INFO - reg_lambda: 2.1511044623714604
2025-04-24 10:43:00,097 - INFO - scale_pos_weight: 3.4498340977848403
2025-04-24 10:43:00,097 - INFO - min_child_weight: 1.4876189243092222
2025-04-24 10:43:00,097 - INFO - gamma: 2.3244219540976307
2025-04-24 10:43:00,097 - INFO - random_state: 42
2025-04-24 10:43:00,097 - INFO - eval_metric: logloss
2025-04-24 10:43:00,097 - INFO - Final best metrics (CV mean):
2025-04-24 10:43:00,097 - INFO - Accuracy: 0.873
2025-04-24 10:43:00,097 - INFO - Sensitivity: 0.533
2025-04-24 10:43:00,097 - INFO - Specificity: 0.869
2025-04-24 10:43:00,097 - INFO - Precision: 0.065
2025-04-24 10:43:00,097 - INFO - NPV: 0.992
2025-04-24 10:43:00,097 - INFO - F1 Score: 0.116
2025-04-24 10:43:00,097 - INFO - Youden's Index: 0.402
2025-04-24 10:43:00,097 - INFO - Cohen's Kappa: 0.091
2025-04-24 10:43:00,097 - INFO - AUC-ROC: 0.744
2025-04-24 10:43:00,097 - INFO - AUC-PR: 0.073
2025-04-24 10:43:00,097 - INFO - Log Loss: 0.310
2025-04-24 10:43:00,097 - INFO - Brier: 0.092
2025-04-24 10:43:00,097 - INFO - ECE: 0.176
2025-04-24 10:43:00,097 - INFO - MCE: 0.845
2025-04-24 10:43:00,097 - INFO - Evaluating on held-out test set (never seen during training/tuning)...
2025-04-24 10:43:01,559 - INFO - Test set metrics (never seen during training/tuning):
2025-04-24 10:43:01,559 - INFO - Accuracy: 0.943
2025-04-24 10:43:01,559 - INFO - Sensitivity: 0.530
2025-04-24 10:43:01,559 - INFO - Specificity: 0.930
2025-04-24 10:43:01,559 - INFO - Precision: 0.165
2025-04-24 10:43:01,559 - INFO - NPV: 0.990
2025-04-24 10:43:01,559 - INFO - F1 Score: 0.251
2025-04-24 10:43:01,559 - INFO - Youden's Index: 0.461
2025-04-24 10:43:01,559 - INFO - Cohen's Kappa: 0.230
2025-04-24 10:43:01,559 - INFO - AUC-ROC: 0.810
2025-04-24 10:43:01,559 - INFO - AUC-PR: 0.427
2025-04-24 10:43:01,559 - INFO - Log Loss: 0.201
2025-04-24 10:43:01,559 - INFO - Brier: 0.045
2025-04-24 10:43:01,559 - INFO - ECE: 0.050
2025-04-24 10:43:01,559 - INFO - MCE: 0.841
2025-04-24 16:39:26,113 - INFO - Starting XGBoost model training
2025-04-24 16:39:26,113 - INFO - [并行调参说明] 本脚本支持Optuna多进程/多机并行调参，只需多开终端运行本脚本即可，Optuna会自动分配trial。
2025-04-24 16:39:26,148 - INFO - Running 100 trials for hyperparameter optimization
2025-04-24 16:39:26,149 - INFO - Found existing XGBoost_best_params.json, evaluating initial score...
2025-04-24 16:39:27,241 - INFO - [Trial ?] 5-fold mean metrics: {'Accuracy': 0.8733554925104938, 'Sensitivity': 0.5334510180365211, 'Specificity': 0.8688236418605388, 'Precision': 0.06548748052496352, 'NPV': 0.9918192400420717, 'F1 Score': 0.116478721394881, "Youden's Index": 0.40227465989705974, "Cohen's Kappa": 0.09135017970045804, 'AUC-ROC': 0.744134951559982, 'AUC-PR': 0.07294680675293927, 'Log Loss': 0.3100235677358617, 'Brier': 0.09243102822406643, 'ECE': 0.17642092470051024, 'MCE': 0.8447927145405686}
2025-04-24 16:39:27,241 - INFO - [Trial ?] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:39:27,492 - INFO - [Trial ?] 测试集指标: {'Accuracy': 0.882, 'Sensitivity': 0.697, 'Specificity': 0.885, 'Precision': 0.1, 'NPV': 0.991, 'F1 Score': 0.174, "Youden's Index": 0.582, "Cohen's Kappa": 0.148, 'AUC-ROC': 0.812, 'AUC-PR': 0.152, 'Log Loss': 0.298, 'Brier': 0.09, 'ECE': 0.173, 'MCE': 0.766}
2025-04-24 16:39:27,492 - ERROR - [Trial ?] 测试集评估错误: 'PseudoTrial' object has no attribute 'number'
Traceback (most recent call last):
  File "/Users/ventus/Repository/DII_EPILEPSY_PREDICTION/py_model/XGBoost_Train.py", line 356, in optuna_objective
    logger.info(f"Trial {trial.number}: CV AUC={auc_roc:.3f} Sens={sens:.3f} Spec={spec:.3f} | Test AUC={test_metrics.get('AUC-ROC', 0):.3f} Sens={test_metrics.get('Sensitivity', 0):.3f} Spec={test_metrics.get('Specificity', 0):.3f}")
AttributeError: 'PseudoTrial' object has no attribute 'number'

2025-04-24 16:39:27,492 - INFO - Initial best score from XGBoost_best_params.json: -inf
2025-04-24 16:39:27,492 - INFO - Initial best metrics: {}
2025-04-24 16:39:31,571 - WARNING - [Trial 0] 交叉验证失败原因: ['特异度过低: 0.0237 < 0.4', '特异度过低: 0.0524 < 0.4', '特异度过低: 0.0276 < 0.4', '特异度过低: 0.0292 < 0.4', '特异度过低: 0.0579 < 0.4']
2025-04-24 16:39:31,571 - INFO - [04-24 16:39:31][Trial 1/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:39:33,072 - WARNING - [Trial 1] 交叉验证失败原因: ['敏感度过低: 0.2889 < 0.4', '敏感度过低: 0.3975 < 0.4']
2025-04-24 16:39:33,072 - INFO - [04-24 16:39:33][Trial 2/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:39:34,469 - INFO - [Trial 2] 5-fold mean metrics: {'Accuracy': 0.8362467723108209, 'Sensitivity': 0.5781856364545799, 'Specificity': 0.8261280134033209, 'Precision': 0.0540272182722484, 'NPV': 0.9931086188036231, 'F1 Score': 0.09875217841515312, "Youden's Index": 0.4043136498579007, "Cohen's Kappa": 0.07242045150548308, 'AUC-ROC': 0.7640482641868951, 'AUC-PR': 0.08187535691148731, 'Log Loss': 0.4665301055369599, 'Brier': 0.1293961686493768, 'ECE': 0.19028208514279416, 'MCE': 0.8664738252219507}
2025-04-24 16:39:34,469 - INFO - [Trial 2] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:39:34,766 - INFO - [Trial 2] 测试集指标: {'Accuracy': 0.834, 'Sensitivity': 0.676, 'Specificity': 0.831, 'Precision': 0.07, 'NPV': 0.991, 'F1 Score': 0.127, "Youden's Index": 0.508, "Cohen's Kappa": 0.098, 'AUC-ROC': 0.817, 'AUC-PR': 0.188, 'Log Loss': 0.456, 'Brier': 0.13, 'ECE': 0.194, 'MCE': 0.818}
2025-04-24 16:39:34,766 - INFO - Trial 2: CV AUC=0.764 Sens=0.578 Spec=0.826 | Test AUC=0.817 Sens=0.676 Spec=0.831
2025-04-24 16:39:34,766 - INFO - [04-24 16:39:34][Trial 3/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.576
2025-04-24 16:39:34,767 - INFO - [Trial 3] New best score: 0.576
2025-04-24 16:39:34,767 - INFO - Best parameters:
2025-04-24 16:39:34,767 - INFO - Best metrics:
2025-04-24 16:39:38,915 - INFO - [Trial 3] 5-fold mean metrics: {'Accuracy': 0.7050580960643023, 'Sensitivity': 0.610450447271971, 'Specificity': 0.6925241906320431, 'Precision': 0.0319201367101844, 'NPV': 0.9926282037581616, 'F1 Score': 0.06060219172746577, "Youden's Index": 0.3029746379040139, "Cohen's Kappa": 0.0320836699564538, 'AUC-ROC': 0.7366398879133401, 'AUC-PR': 0.05321010406762078, 'Log Loss': 0.687998817553125, 'Brier': 0.21444201518798636, 'ECE': 0.31360112419170594, 'MCE': 0.8903574193927979}
2025-04-24 16:39:38,915 - INFO - [Trial 3] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:39:39,763 - INFO - [Trial 3] 测试集指标: {'Accuracy': 0.653, 'Sensitivity': 0.774, 'Specificity': 0.662, 'Precision': 0.039, 'NPV': 0.992, 'F1 Score': 0.074, "Youden's Index": 0.437, "Cohen's Kappa": 0.041, 'AUC-ROC': 0.803, 'AUC-PR': 0.122, 'Log Loss': 0.753, 'Brier': 0.242, 'ECE': 0.351, 'MCE': 0.87}
2025-04-24 16:39:39,763 - INFO - Trial 3: CV AUC=0.737 Sens=0.610 Spec=0.693 | Test AUC=0.803 Sens=0.774 Spec=0.662
2025-04-24 16:39:39,764 - INFO - [04-24 16:39:39][Trial 4/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.566
2025-04-24 16:39:46,250 - INFO - [Trial 4] 5-fold mean metrics: {'Accuracy': 0.7996479802291251, 'Sensitivity': 0.5749331799586009, 'Specificity': 0.7874037032031356, 'Precision': 0.04373894989058377, 'NPV': 0.9926569891810921, 'F1 Score': 0.08125134559114879, "Youden's Index": 0.36233688316173657, "Cohen's Kappa": 0.05398667146702796, 'AUC-ROC': 0.7535435438791306, 'AUC-PR': 0.07979430511447698, 'Log Loss': 0.4829573098553951, 'Brier': 0.1458375113169861, 'ECE': 0.232727780389755, 'MCE': 0.8499281999723634}
2025-04-24 16:39:46,250 - INFO - [Trial 4] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:39:47,620 - INFO - [Trial 4] 测试集指标: {'Accuracy': 0.795, 'Sensitivity': 0.697, 'Specificity': 0.799, 'Precision': 0.059, 'NPV': 0.992, 'F1 Score': 0.109, "Youden's Index": 0.496, "Cohen's Kappa": 0.078, 'AUC-ROC': 0.815, 'AUC-PR': 0.171, 'Log Loss': 0.477, 'Brier': 0.148, 'ECE': 0.238, 'MCE': 0.807}
2025-04-24 16:39:47,620 - INFO - Trial 4: CV AUC=0.754 Sens=0.575 Spec=0.787 | Test AUC=0.815 Sens=0.697 Spec=0.799
2025-04-24 16:39:47,621 - INFO - [04-24 16:39:47][Trial 5/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.565
2025-04-24 16:39:49,086 - WARNING - [Trial 5] 交叉验证失败原因: ['特异度过低: 0.1434 < 0.4', '特异度过低: 0.1522 < 0.4', '特异度过低: 0.1263 < 0.4', '特异度过低: 0.0899 < 0.4', '特异度过低: 0.1203 < 0.4']
2025-04-24 16:39:49,087 - INFO - [04-24 16:39:49][Trial 6/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:39:52,760 - INFO - [Trial 6] 5-fold mean metrics: {'Accuracy': 0.7987697652506082, 'Sensitivity': 0.5788846189445256, 'Specificity': 0.7861902448468201, 'Precision': 0.04408558602633772, 'NPV': 0.9929166478976746, 'F1 Score': 0.08188648065579514, "Youden's Index": 0.3650748637913456, "Cohen's Kappa": 0.05463370463709723, 'AUC-ROC': 0.7542085802105569, 'AUC-PR': 0.08101179451836275, 'Log Loss': 0.48486967801925146, 'Brier': 0.14663644444415141, 'ECE': 0.2325140248842578, 'MCE': 0.854415105524341}
2025-04-24 16:39:52,760 - INFO - [Trial 6] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:39:53,557 - INFO - [Trial 6] 测试集指标: {'Accuracy': 0.8, 'Sensitivity': 0.697, 'Specificity': 0.798, 'Precision': 0.06, 'NPV': 0.992, 'F1 Score': 0.111, "Youden's Index": 0.496, "Cohen's Kappa": 0.081, 'AUC-ROC': 0.813, 'AUC-PR': 0.17, 'Log Loss': 0.474, 'Brier': 0.146, 'ECE': 0.235, 'MCE': 0.849}
2025-04-24 16:39:53,557 - INFO - Trial 6: CV AUC=0.754 Sens=0.579 Spec=0.786 | Test AUC=0.813 Sens=0.697 Spec=0.798
2025-04-24 16:39:53,558 - INFO - [04-24 16:39:53][Trial 7/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.568
2025-04-24 16:40:01,826 - INFO - [Trial 7] 5-fold mean metrics: {'Accuracy': 0.528153773302584, 'Sensitivity': 0.861276239154177, 'Specificity': 0.4906260768133994, 'Precision': 0.027512735669530768, 'NPV': 0.9955593490297501, 'F1 Score': 0.05330927207207945, "Youden's Index": 0.35190231596757643, "Cohen's Kappa": 0.023963761263225858, 'AUC-ROC': 0.771715547649881, 'AUC-PR': 0.07131407417858429, 'Log Loss': 0.8876051271591094, 'Brier': 0.31999968195379236, 'ECE': 0.5313876660151261, 'MCE': 0.8408073253792617}
2025-04-24 16:40:01,827 - INFO - [Trial 7] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:40:03,502 - INFO - [Trial 7] 测试集指标: {'Accuracy': 0.53, 'Sensitivity': 0.845, 'Specificity': 0.518, 'Precision': 0.031, 'NPV': 0.992, 'F1 Score': 0.061, "Youden's Index": 0.362, "Cohen's Kappa": 0.027, 'AUC-ROC': 0.826, 'AUC-PR': 0.123, 'Log Loss': 0.895, 'Brier': 0.322, 'ECE': 0.533, 'MCE': 0.815}
2025-04-24 16:40:03,502 - INFO - Trial 7: CV AUC=0.772 Sens=0.861 Spec=0.491 | Test AUC=0.826 Sens=0.845 Spec=0.518
2025-04-24 16:40:03,503 - INFO - [04-24 16:40:03][Trial 8/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.679
2025-04-24 16:40:03,503 - INFO - [Trial 8] New best score: 0.679
2025-04-24 16:40:03,503 - INFO - Best parameters:
2025-04-24 16:40:03,503 - INFO - Best metrics:
2025-04-24 16:40:05,720 - WARNING - [Trial 8] 交叉验证失败原因: ['敏感度过低: 0.3071 < 0.4', '敏感度过低: 0.3807 < 0.4']
2025-04-24 16:40:05,720 - INFO - [04-24 16:40:05][Trial 9/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:40:07,322 - INFO - [Trial 9] 5-fold mean metrics: {'Accuracy': 0.8306659167349142, 'Sensitivity': 0.5910460847519189, 'Specificity': 0.8179630434597321, 'Precision': 0.053044097483829655, 'NPV': 0.9927844344064809, 'F1 Score': 0.09729420865386973, "Youden's Index": 0.409009128211651, "Cohen's Kappa": 0.07085197446919604, 'AUC-ROC': 0.7600989547222812, 'AUC-PR': 0.07426333222177851, 'Log Loss': 0.4890054495523386, 'Brier': 0.13281044053012916, 'ECE': 0.17716813606944007, 'MCE': 0.876403398641877}
2025-04-24 16:40:07,322 - INFO - [Trial 9] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:40:07,664 - INFO - [Trial 9] 测试集指标: {'Accuracy': 0.823, 'Sensitivity': 0.624, 'Specificity': 0.831, 'Precision': 0.062, 'NPV': 0.99, 'F1 Score': 0.112, "Youden's Index": 0.455, "Cohen's Kappa": 0.082, 'AUC-ROC': 0.798, 'AUC-PR': 0.15, 'Log Loss': 0.458, 'Brier': 0.131, 'ECE': 0.18, 'MCE': 0.829}
2025-04-24 16:40:07,665 - INFO - Trial 9: CV AUC=0.760 Sens=0.591 Spec=0.818 | Test AUC=0.798 Sens=0.624 Spec=0.831
2025-04-24 16:40:07,665 - INFO - [04-24 16:40:07][Trial 10/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.581
2025-04-24 16:40:16,204 - WARNING - [Trial 10] 交叉验证失败原因: ['特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4']
2025-04-24 16:40:16,204 - INFO - [04-24 16:40:16][Trial 11/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:40:19,304 - WARNING - [Trial 11] 交叉验证失败原因: ['敏感度过低: 0.3948 < 0.4']
2025-04-24 16:40:19,305 - INFO - [04-24 16:40:19][Trial 12/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:40:25,677 - INFO - [Trial 12] 5-fold mean metrics: {'Accuracy': 0.5772358320683781, 'Sensitivity': 0.7746458002192045, 'Specificity': 0.5446851230200331, 'Precision': 0.027921136733841213, 'NPV': 0.9947545196736558, 'F1 Score': 0.053885523913413225, "Youden's Index": 0.3193309232392376, "Cohen's Kappa": 0.024673794472842524, 'AUC-ROC': 0.7672542579852218, 'AUC-PR': 0.06156698788651782, 'Log Loss': 0.8957178932469638, 'Brier': 0.29746511894972744, 'ECE': 0.46117147483469034, 'MCE': 0.8763782406499846}
2025-04-24 16:40:25,677 - INFO - [Trial 12] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:40:27,032 - INFO - [Trial 12] 测试集指标: {'Accuracy': 0.575, 'Sensitivity': 0.836, 'Specificity': 0.558, 'Precision': 0.034, 'NPV': 0.994, 'F1 Score': 0.066, "Youden's Index": 0.394, "Cohen's Kappa": 0.033, 'AUC-ROC': 0.811, 'AUC-PR': 0.095, 'Log Loss': 0.92, 'Brier': 0.304, 'ECE': 0.469, 'MCE': 0.855}
2025-04-24 16:40:27,033 - INFO - Trial 12: CV AUC=0.767 Sens=0.775 Spec=0.545 | Test AUC=0.811 Sens=0.836 Spec=0.558
2025-04-24 16:40:27,033 - INFO - [04-24 16:40:27][Trial 13/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.640
2025-04-24 16:40:33,547 - INFO - [Trial 13] 5-fold mean metrics: {'Accuracy': 0.6097540509871292, 'Sensitivity': 0.7538591628497432, 'Specificity': 0.5783345448435325, 'Precision': 0.029468298180096907, 'NPV': 0.99487456088988, 'F1 Score': 0.056705897008706166, "Youden's Index": 0.3321937076932758, "Cohen's Kappa": 0.02767377118267498, 'AUC-ROC': 0.7677636092890971, 'AUC-PR': 0.0646281574897144, 'Log Loss': 0.8448772088579473, 'Brier': 0.27883191595991386, 'ECE': 0.4409946359421772, 'MCE': 0.8716570071338268}
2025-04-24 16:40:33,548 - INFO - [Trial 13] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:40:34,948 - INFO - [Trial 13] 测试集指标: {'Accuracy': 0.61, 'Sensitivity': 0.785, 'Specificity': 0.585, 'Precision': 0.035, 'NPV': 0.993, 'F1 Score': 0.067, "Youden's Index": 0.371, "Cohen's Kappa": 0.034, 'AUC-ROC': 0.814, 'AUC-PR': 0.099, 'Log Loss': 0.87, 'Brier': 0.285, 'ECE': 0.448, 'MCE': 0.846}
2025-04-24 16:40:34,948 - INFO - Trial 13: CV AUC=0.768 Sens=0.754 Spec=0.578 | Test AUC=0.814 Sens=0.785 Spec=0.585
2025-04-24 16:40:34,949 - INFO - [04-24 16:40:34][Trial 14/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.634
2025-04-24 16:40:42,144 - INFO - [Trial 14] 5-fold mean metrics: {'Accuracy': 0.5084092611058904, 'Sensitivity': 0.8621835201115557, 'Specificity': 0.4673475475746053, 'Precision': 0.026472212362568626, 'NPV': 0.9956082869449748, 'F1 Score': 0.0513523586781814, "Youden's Index": 0.329531067686161, "Cohen's Kappa": 0.021912084230049957, 'AUC-ROC': 0.7665787034138054, 'AUC-PR': 0.0666820031435478, 'Log Loss': 0.9209927825473322, 'Brier': 0.3260080528204058, 'ECE': 0.5190548708885654, 'MCE': 0.8574446335740493}
2025-04-24 16:40:42,144 - INFO - [Trial 14] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:40:43,680 - WARNING - [Trial 14] 测试集约束检查失败: ['特异度过低: 0.4782 < 0.5']
2025-04-24 16:40:43,680 - INFO - [04-24 16:40:43][Trial 15/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:40:45,252 - WARNING - [Trial 15] 交叉验证失败原因: ['特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4']
2025-04-24 16:40:45,252 - INFO - [04-24 16:40:45][Trial 16/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:40:48,432 - WARNING - [Trial 16] 交叉验证失败原因: ['特异度过低: 0.3149 < 0.4', '特异度过低: 0.3773 < 0.4', '特异度过低: 0.3392 < 0.4', '特异度过低: 0.2675 < 0.4', '特异度过低: 0.3709 < 0.4']
2025-04-24 16:40:48,432 - INFO - [04-24 16:40:48][Trial 17/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:40:55,239 - INFO - [Trial 17] 5-fold mean metrics: {'Accuracy': 0.47888779838426476, 'Sensitivity': 0.8621835201115557, 'Specificity': 0.43800026543640547, 'Precision': 0.024993615943470632, 'NPV': 0.9953080279443494, 'F1 Score': 0.04856861265283904, "Youden's Index": 0.30018378554796127, "Cohen's Kappa": 0.018986928199723585, 'AUC-ROC': 0.7668013318364192, 'AUC-PR': 0.05640693043976854, 'Log Loss': 0.9822976879542559, 'Brier': 0.3486615641604157, 'ECE': 0.544257388459227, 'MCE': 0.8696975931357326}
2025-04-24 16:40:55,239 - INFO - [Trial 17] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:40:56,684 - WARNING - [Trial 17] 测试集约束检查失败: ['特异度过低: 0.4640 < 0.5']
2025-04-24 16:40:56,685 - INFO - [04-24 16:40:56][Trial 18/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:41:02,193 - INFO - [Trial 18] 5-fold mean metrics: {'Accuracy': 0.7149768895697937, 'Sensitivity': 0.6645311299722121, 'Specificity': 0.6947290783146979, 'Precision': 0.035613758968574626, 'NPV': 0.9941609071624317, 'F1 Score': 0.06759569718829803, "Youden's Index": 0.35926020828691, "Cohen's Kappa": 0.039295000919107606, 'AUC-ROC': 0.774749850209774, 'AUC-PR': 0.06001766529917192, 'Log Loss': 0.7396100837526027, 'Brier': 0.21887818218564883, 'ECE': 0.3375245444535941, 'MCE': 0.8895100131878898}
2025-04-24 16:41:02,193 - INFO - [Trial 18] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:03,392 - INFO - [Trial 18] 测试集指标: {'Accuracy': 0.705, 'Sensitivity': 0.78, 'Specificity': 0.703, 'Precision': 0.046, 'NPV': 0.993, 'F1 Score': 0.087, "Youden's Index": 0.484, "Cohen's Kappa": 0.055, 'AUC-ROC': 0.816, 'AUC-PR': 0.128, 'Log Loss': 0.769, 'Brier': 0.226, 'ECE': 0.346, 'MCE': 0.863}
2025-04-24 16:41:03,392 - INFO - Trial 18: CV AUC=0.775 Sens=0.665 Spec=0.695 | Test AUC=0.816 Sens=0.780 Spec=0.703
2025-04-24 16:41:03,392 - INFO - [04-24 16:41:03][Trial 19/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.604
2025-04-24 16:41:05,070 - INFO - [Trial 19] 5-fold mean metrics: {'Accuracy': 0.6832497538655055, 'Sensitivity': 0.5997766990095685, 'Specificity': 0.6686930544546439, 'Precision': 0.029209221678602577, 'NPV': 0.9919929094514822, 'F1 Score': 0.05567107502885198, "Youden's Index": 0.2684697534642125, "Cohen's Kappa": 0.026888478256379987, 'AUC-ROC': 0.7333450250402743, 'AUC-PR': 0.05241315740184234, 'Log Loss': 0.7219775803063018, 'Brier': 0.22866997591646432, 'ECE': 0.3354629571816557, 'MCE': 0.8913720996691274}
2025-04-24 16:41:05,070 - INFO - [Trial 19] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:05,429 - INFO - [Trial 19] 测试集指标: {'Accuracy': 0.643, 'Sensitivity': 0.774, 'Specificity': 0.64, 'Precision': 0.038, 'NPV': 0.992, 'F1 Score': 0.072, "Youden's Index": 0.415, "Cohen's Kappa": 0.039, 'AUC-ROC': 0.784, 'AUC-PR': 0.119, 'Log Loss': 0.8, 'Brier': 0.259, 'ECE': 0.374, 'MCE': 0.873}
2025-04-24 16:41:05,429 - INFO - Trial 19: CV AUC=0.733 Sens=0.600 Spec=0.669 | Test AUC=0.784 Sens=0.774 Spec=0.640
2025-04-24 16:41:05,429 - INFO - [04-24 16:41:05][Trial 20/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.557
2025-04-24 16:41:06,218 - WARNING - [Trial 20] 交叉验证失败原因: ['特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4']
2025-04-24 16:41:06,218 - INFO - [04-24 16:41:06][Trial 21/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:41:12,706 - WARNING - [Trial 21] 交叉验证失败原因: ['特异度过低: 0.1589 < 0.4', '特异度过低: 0.1870 < 0.4', '特异度过低: 0.1638 < 0.4', '特异度过低: 0.1362 < 0.4', '特异度过低: 0.1981 < 0.4']
2025-04-24 16:41:12,706 - INFO - [04-24 16:41:12][Trial 22/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:41:19,231 - INFO - [Trial 22] 5-fold mean metrics: {'Accuracy': 0.6337321621653575, 'Sensitivity': 0.7228523103584626, 'Specificity': 0.6065777089428935, 'Precision': 0.030121722745006553, 'NPV': 0.9949260744229786, 'F1 Score': 0.05782135344890495, "Youden's Index": 0.32943001930135607, "Cohen's Kappa": 0.02889328425719979, 'AUC-ROC': 0.7691039807806821, 'AUC-PR': 0.0651334370893937, 'Log Loss': 0.8164422297728893, 'Brier': 0.26400504723723295, 'ECE': 0.4144569273276799, 'MCE': 0.8773031004753186}
2025-04-24 16:41:19,231 - INFO - [Trial 22] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:20,645 - INFO - [Trial 22] 测试集指标: {'Accuracy': 0.633, 'Sensitivity': 0.78, 'Specificity': 0.61, 'Precision': 0.037, 'NPV': 0.992, 'F1 Score': 0.071, "Youden's Index": 0.391, "Cohen's Kappa": 0.038, 'AUC-ROC': 0.814, 'AUC-PR': 0.096, 'Log Loss': 0.84, 'Brier': 0.27, 'ECE': 0.422, 'MCE': 0.851}
2025-04-24 16:41:20,645 - INFO - Trial 22: CV AUC=0.769 Sens=0.723 Spec=0.607 | Test AUC=0.814 Sens=0.780 Spec=0.610
2025-04-24 16:41:20,646 - INFO - [04-24 16:41:20][Trial 23/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.622
2025-04-24 16:41:27,166 - INFO - [Trial 23] 5-fold mean metrics: {'Accuracy': 0.7850052854377095, 'Sensitivity': 0.60829213565768, 'Specificity': 0.7722889871896494, 'Precision': 0.043131878537634775, 'NPV': 0.9934783275018841, 'F1 Score': 0.08051963221751932, "Youden's Index": 0.38058112284732953, "Cohen's Kappa": 0.05308044279640205, 'AUC-ROC': 0.7723731766273525, 'AUC-PR': 0.07029708466265032, 'Log Loss': 0.5508950405125548, 'Brier': 0.1621272369625088, 'ECE': 0.2542090285742783, 'MCE': 0.8705465108785946}
2025-04-24 16:41:27,166 - INFO - [Trial 23] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:28,546 - INFO - [Trial 23] 测试集指标: {'Accuracy': 0.785, 'Sensitivity': 0.719, 'Specificity': 0.787, 'Precision': 0.058, 'NPV': 0.992, 'F1 Score': 0.107, "Youden's Index": 0.506, "Cohen's Kappa": 0.077, 'AUC-ROC': 0.821, 'AUC-PR': 0.164, 'Log Loss': 0.552, 'Brier': 0.164, 'ECE': 0.258, 'MCE': 0.856}
2025-04-24 16:41:28,546 - INFO - Trial 23: CV AUC=0.772 Sens=0.608 Spec=0.772 | Test AUC=0.821 Sens=0.719 Spec=0.787
2025-04-24 16:41:28,547 - INFO - [04-24 16:41:28][Trial 24/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.585
2025-04-24 16:41:30,734 - WARNING - [Trial 24] 交叉验证失败原因: ['特异度过低: 0.1434 < 0.4', '特异度过低: 0.1379 < 0.4', '特异度过低: 0.1191 < 0.4', '特异度过低: 0.0943 < 0.4', '特异度过低: 0.0993 < 0.4']
2025-04-24 16:41:30,734 - INFO - [04-24 16:41:30][Trial 25/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:41:32,302 - INFO - [Trial 25] 5-fold mean metrics: {'Accuracy': 0.6230678057566883, 'Sensitivity': 0.7981443142166481, 'Specificity': 0.59510507263582, 'Precision': 0.03198509571729383, 'NPV': 0.9948895092739709, 'F1 Score': 0.061483094257874585, "Youden's Index": 0.3932493868524682, "Cohen's Kappa": 0.032638246934556615, 'AUC-ROC': 0.753121081851605, 'AUC-PR': 0.05660120685536343, 'Log Loss': 0.8439088305126127, 'Brier': 0.27273384194564554, 'ECE': 0.4124899930760618, 'MCE': 0.8890397142292761}
2025-04-24 16:41:32,302 - INFO - [Trial 25] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:32,623 - INFO - [Trial 25] 测试集指标: {'Accuracy': 0.587, 'Sensitivity': 0.84, 'Specificity': 0.581, 'Precision': 0.035, 'NPV': 0.992, 'F1 Score': 0.068, "Youden's Index": 0.42, "Cohen's Kappa": 0.035, 'AUC-ROC': 0.801, 'AUC-PR': 0.122, 'Log Loss': 0.896, 'Brier': 0.293, 'ECE': 0.436, 'MCE': 0.879}
2025-04-24 16:41:32,623 - INFO - Trial 25: CV AUC=0.753 Sens=0.798 Spec=0.595 | Test AUC=0.801 Sens=0.840 Spec=0.581
2025-04-24 16:41:32,624 - INFO - [04-24 16:41:32][Trial 26/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.655
2025-04-24 16:41:34,227 - INFO - [Trial 26] 5-fold mean metrics: {'Accuracy': 0.6354977114508935, 'Sensitivity': 0.7802176720932588, 'Specificity': 0.6099989772175203, 'Precision': 0.03245525104778714, 'NPV': 0.9944448378490257, 'F1 Score': 0.06228756825120456, "Youden's Index": 0.39021664931077904, "Cohen's Kappa": 0.033513804342278394, 'AUC-ROC': 0.755288351608265, 'AUC-PR': 0.05970542033546387, 'Log Loss': 0.8082091264710979, 'Brier': 0.2609583738035206, 'ECE': 0.39633959333856905, 'MCE': 0.8858213823377771}
2025-04-24 16:41:34,227 - INFO - [Trial 26] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:34,542 - INFO - [Trial 26] 测试集指标: {'Accuracy': 0.602, 'Sensitivity': 0.783, 'Specificity': 0.594, 'Precision': 0.034, 'NPV': 0.993, 'F1 Score': 0.066, "Youden's Index": 0.377, "Cohen's Kappa": 0.033, 'AUC-ROC': 0.799, 'AUC-PR': 0.122, 'Log Loss': 0.864, 'Brier': 0.282, 'ECE': 0.421, 'MCE': 0.876}
2025-04-24 16:41:34,542 - INFO - Trial 26: CV AUC=0.755 Sens=0.780 Spec=0.610 | Test AUC=0.799 Sens=0.783 Spec=0.594
2025-04-24 16:41:34,542 - INFO - [04-24 16:41:34][Trial 27/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.648
2025-04-24 16:41:36,101 - INFO - [Trial 27] 5-fold mean metrics: {'Accuracy': 0.6882211593862028, 'Sensitivity': 0.6876514200489956, 'Specificity': 0.6699073651296924, 'Precision': 0.033895293668892046, 'NPV': 0.9942812725818776, 'F1 Score': 0.06457520501951643, "Youden's Index": 0.35755878517868805, "Cohen's Kappa": 0.036076864343120005, 'AUC-ROC': 0.7539984621791839, 'AUC-PR': 0.05454641378531812, 'Log Loss': 0.7026468475883985, 'Brier': 0.2242203737267494, 'ECE': 0.3548538886733635, 'MCE': 0.8867484429636132}
2025-04-24 16:41:36,101 - INFO - [Trial 27] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:36,414 - INFO - [Trial 27] 测试集指标: {'Accuracy': 0.656, 'Sensitivity': 0.78, 'Specificity': 0.655, 'Precision': 0.04, 'NPV': 0.993, 'F1 Score': 0.075, "Youden's Index": 0.435, "Cohen's Kappa": 0.043, 'AUC-ROC': 0.799, 'AUC-PR': 0.123, 'Log Loss': 0.751, 'Brier': 0.245, 'ECE': 0.38, 'MCE': 0.863}
2025-04-24 16:41:36,414 - INFO - Trial 27: CV AUC=0.754 Sens=0.688 Spec=0.670 | Test AUC=0.799 Sens=0.780 Spec=0.655
2025-04-24 16:41:36,414 - INFO - [04-24 16:41:36][Trial 28/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.608
2025-04-24 16:41:37,796 - INFO - [Trial 28] 5-fold mean metrics: {'Accuracy': 0.774918400013447, 'Sensitivity': 0.5960785229754593, 'Specificity': 0.7630218473643261, 'Precision': 0.040601450649327006, 'NPV': 0.9931258972817337, 'F1 Score': 0.07596561549372262, "Youden's Index": 0.35910037033978537, "Cohen's Kappa": 0.04833633445622252, 'AUC-ROC': 0.7541330609428625, 'AUC-PR': 0.06567310316169013, 'Log Loss': 0.5486374940769944, 'Brier': 0.1659015048839256, 'ECE': 0.2509221676409302, 'MCE': 0.8801637906590416}
2025-04-24 16:41:37,797 - INFO - [Trial 28] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:38,077 - INFO - [Trial 28] 测试集指标: {'Accuracy': 0.748, 'Sensitivity': 0.774, 'Specificity': 0.757, 'Precision': 0.053, 'NPV': 0.993, 'F1 Score': 0.099, "Youden's Index": 0.531, "Cohen's Kappa": 0.068, 'AUC-ROC': 0.815, 'AUC-PR': 0.141, 'Log Loss': 0.573, 'Brier': 0.18, 'ECE': 0.274, 'MCE': 0.858}
2025-04-24 16:41:38,077 - INFO - Trial 28: CV AUC=0.754 Sens=0.596 Spec=0.763 | Test AUC=0.815 Sens=0.774 Spec=0.757
2025-04-24 16:41:38,078 - INFO - [04-24 16:41:38][Trial 29/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.573
2025-04-24 16:41:38,917 - WARNING - [Trial 29] 交叉验证失败原因: ['敏感度过低: 0.3982 < 0.4']
2025-04-24 16:41:38,917 - INFO - [04-24 16:41:38][Trial 30/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:41:39,640 - INFO - [Trial 30] 5-fold mean metrics: {'Accuracy': 0.7722560928939182, 'Sensitivity': 0.5787727600757883, 'Specificity': 0.7669948093789154, 'Precision': 0.039355456003893105, 'NPV': 0.9927327906942377, 'F1 Score': 0.07363242059503702, "Youden's Index": 0.3457675694547036, "Cohen's Kappa": 0.04591301340800191, 'AUC-ROC': 0.7281660404367456, 'AUC-PR': 0.06187553685758142, 'Log Loss': 0.5550850234155134, 'Brier': 0.1673469981837803, 'ECE': 0.24961388095190803, 'MCE': 0.8806311026559145}
2025-04-24 16:41:39,640 - INFO - [Trial 30] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:39,797 - INFO - [Trial 30] 测试集指标: {'Accuracy': 0.765, 'Sensitivity': 0.69, 'Specificity': 0.768, 'Precision': 0.051, 'NPV': 0.991, 'F1 Score': 0.095, "Youden's Index": 0.458, "Cohen's Kappa": 0.064, 'AUC-ROC': 0.789, 'AUC-PR': 0.14, 'Log Loss': 0.562, 'Brier': 0.174, 'ECE': 0.262, 'MCE': 0.861}
2025-04-24 16:41:39,797 - INFO - Trial 30: CV AUC=0.728 Sens=0.579 Spec=0.767 | Test AUC=0.789 Sens=0.690 Spec=0.768
2025-04-24 16:41:39,797 - INFO - [04-24 16:41:39][Trial 31/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.558
2025-04-24 16:41:43,695 - WARNING - [Trial 31] 交叉验证失败原因: ['特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4']
2025-04-24 16:41:43,695 - INFO - [04-24 16:41:43][Trial 32/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:41:46,058 - INFO - [Trial 32] 5-fold mean metrics: {'Accuracy': 0.7477324625470869, 'Sensitivity': 0.6430705092071977, 'Specificity': 0.7291517967487693, 'Precision': 0.03908798038266484, 'NPV': 0.9942867591521514, 'F1 Score': 0.07366198909836282, "Youden's Index": 0.3722223059559669, "Cohen's Kappa": 0.045745990135999115, 'AUC-ROC': 0.7618226835868815, 'AUC-PR': 0.07035683213148981, 'Log Loss': 0.5880608450496352, 'Brier': 0.1846210396045876, 'ECE': 0.3040907405469611, 'MCE': 0.8666630408133938}
2025-04-24 16:41:46,058 - INFO - [Trial 32] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:46,553 - INFO - [Trial 32] 测试集指标: {'Accuracy': 0.74, 'Sensitivity': 0.724, 'Specificity': 0.737, 'Precision': 0.048, 'NPV': 0.992, 'F1 Score': 0.091, "Youden's Index": 0.46, "Cohen's Kappa": 0.059, 'AUC-ROC': 0.814, 'AUC-PR': 0.14, 'Log Loss': 0.595, 'Brier': 0.187, 'ECE': 0.31, 'MCE': 0.855}
2025-04-24 16:41:46,553 - INFO - Trial 32: CV AUC=0.762 Sens=0.643 Spec=0.729 | Test AUC=0.814 Sens=0.724 Spec=0.737
2025-04-24 16:41:46,554 - INFO - [04-24 16:41:46][Trial 33/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.595
2025-04-24 16:41:48,122 - WARNING - [Trial 33] 交叉验证失败原因: ['特异度过低: 0.0226 < 0.4', '特异度过低: 0.0871 < 0.4', '特异度过低: 0.0331 < 0.4', '特异度过低: 0.0287 < 0.4', '特异度过低: 0.0811 < 0.4']
2025-04-24 16:41:48,122 - INFO - [04-24 16:41:48][Trial 34/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:41:49,227 - INFO - [Trial 34] 5-fold mean metrics: {'Accuracy': 0.8156061957486621, 'Sensitivity': 0.5883136205624667, 'Specificity': 0.7998705084324763, 'Precision': 0.04917341996935702, 'NPV': 0.9927373111982998, 'F1 Score': 0.09070707800930368, "Youden's Index": 0.388184128994943, "Cohen's Kappa": 0.06388102122516628, 'AUC-ROC': 0.7568701964150698, 'AUC-PR': 0.06376023086629691, 'Log Loss': 0.4323267279851522, 'Brier': 0.13450694695463367, 'ECE': 0.2603668857064415, 'MCE': 0.8342806137674449}
2025-04-24 16:41:49,227 - INFO - [Trial 34] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:49,458 - INFO - [Trial 34] 测试集指标: {'Accuracy': 0.812, 'Sensitivity': 0.719, 'Specificity': 0.812, 'Precision': 0.066, 'NPV': 0.992, 'F1 Score': 0.121, "Youden's Index": 0.531, "Cohen's Kappa": 0.091, 'AUC-ROC': 0.82, 'AUC-PR': 0.145, 'Log Loss': 0.432, 'Brier': 0.136, 'ECE': 0.263, 'MCE': 0.8}
2025-04-24 16:41:49,458 - INFO - Trial 34: CV AUC=0.757 Sens=0.588 Spec=0.800 | Test AUC=0.820 Sens=0.719 Spec=0.812
2025-04-24 16:41:49,458 - INFO - [04-24 16:41:49][Trial 35/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.576
2025-04-24 16:41:52,044 - INFO - [Trial 35] 5-fold mean metrics: {'Accuracy': 0.7482417316148585, 'Sensitivity': 0.6588140017623838, 'Specificity': 0.7322401127982963, 'Precision': 0.03988842375581484, 'NPV': 0.9941526807181529, 'F1 Score': 0.07520539936659534, "Youden's Index": 0.39105411456068023, "Cohen's Kappa": 0.04733135820191805, 'AUC-ROC': 0.7742031023636903, 'AUC-PR': 0.0633597082650811, 'Log Loss': 0.6324166475588721, 'Brier': 0.19213854135471958, 'ECE': 0.3108813843130625, 'MCE': 0.8836009224494683}
2025-04-24 16:41:52,044 - INFO - [Trial 35] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:52,588 - INFO - [Trial 35] 测试集指标: {'Accuracy': 0.747, 'Sensitivity': 0.725, 'Specificity': 0.745, 'Precision': 0.05, 'NPV': 0.992, 'F1 Score': 0.093, "Youden's Index": 0.47, "Cohen's Kappa": 0.062, 'AUC-ROC': 0.809, 'AUC-PR': 0.109, 'Log Loss': 0.643, 'Brier': 0.195, 'ECE': 0.315, 'MCE': 0.866}
2025-04-24 16:41:52,588 - INFO - Trial 35: CV AUC=0.774 Sens=0.659 Spec=0.732 | Test AUC=0.809 Sens=0.725 Spec=0.745
2025-04-24 16:41:52,589 - INFO - [04-24 16:41:52][Trial 36/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.606
2025-04-24 16:41:58,299 - INFO - [Trial 36] 5-fold mean metrics: {'Accuracy': 0.6310293167833393, 'Sensitivity': 0.7118921439503183, 'Specificity': 0.6082332772020568, 'Precision': 0.029607526380333177, 'NPV': 0.9940639811561022, 'F1 Score': 0.05682107199588543, "Youden's Index": 0.3201254211523752, "Cohen's Kappa": 0.027870548913898972, 'AUC-ROC': 0.7482070149666242, 'AUC-PR': 0.059050122098089075, 'Log Loss': 0.8694775222205784, 'Brier': 0.26902854014970434, 'ECE': 0.3804260093276401, 'MCE': 0.8967093697502451}
2025-04-24 16:41:58,300 - INFO - [Trial 36] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:41:59,481 - INFO - [Trial 36] 测试集指标: {'Accuracy': 0.616, 'Sensitivity': 0.78, 'Specificity': 0.604, 'Precision': 0.036, 'NPV': 0.992, 'F1 Score': 0.068, "Youden's Index": 0.384, "Cohen's Kappa": 0.035, 'AUC-ROC': 0.796, 'AUC-PR': 0.13, 'Log Loss': 0.914, 'Brier': 0.284, 'ECE': 0.4, 'MCE': 0.871}
2025-04-24 16:41:59,481 - INFO - Trial 36: CV AUC=0.748 Sens=0.712 Spec=0.608 | Test AUC=0.796 Sens=0.780 Spec=0.604
2025-04-24 16:41:59,482 - INFO - [04-24 16:41:59][Trial 37/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.611
2025-04-24 16:42:04,247 - INFO - [Trial 37] 5-fold mean metrics: {'Accuracy': 0.794240084942704, 'Sensitivity': 0.6017051364575324, 'Specificity': 0.7791294538219798, 'Precision': 0.044657787843276564, 'NPV': 0.9932533387464206, 'F1 Score': 0.08310365806385125, "Youden's Index": 0.38083459027951216, "Cohen's Kappa": 0.055830379957311216, 'AUC-ROC': 0.7678726861287399, 'AUC-PR': 0.06823787347904238, 'Log Loss': 0.49689386966144405, 'Brier': 0.15131363676199414, 'ECE': 0.2532008416788079, 'MCE': 0.8627209085779832}
2025-04-24 16:42:04,247 - INFO - [Trial 37] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:42:05,282 - INFO - [Trial 37] 测试集指标: {'Accuracy': 0.798, 'Sensitivity': 0.719, 'Specificity': 0.792, 'Precision': 0.061, 'NPV': 0.992, 'F1 Score': 0.113, "Youden's Index": 0.511, "Cohen's Kappa": 0.083, 'AUC-ROC': 0.822, 'AUC-PR': 0.168, 'Log Loss': 0.491, 'Brier': 0.151, 'ECE': 0.256, 'MCE': 0.832}
2025-04-24 16:42:05,282 - INFO - Trial 37: CV AUC=0.768 Sens=0.602 Spec=0.779 | Test AUC=0.822 Sens=0.719 Spec=0.792
2025-04-24 16:42:05,283 - INFO - [04-24 16:42:05][Trial 38/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.582
2025-04-24 16:42:08,289 - INFO - [Trial 38] 5-fold mean metrics: {'Accuracy': 0.6486408934824504, 'Sensitivity': 0.6676281016736425, 'Specificity': 0.6286438756637434, 'Precision': 0.029285228493978677, 'NPV': 0.9928535618652374, 'F1 Score': 0.056079045134592206, "Youden's Index": 0.2962719773373857, "Cohen's Kappa": 0.0271720970504012, 'AUC-ROC': 0.7328498219191236, 'AUC-PR': 0.06399456308644362, 'Log Loss': 0.7892237571211366, 'Brier': 0.25064647148212243, 'ECE': 0.36196232212386664, 'MCE': 0.8932331620997152}
2025-04-24 16:42:08,289 - INFO - [Trial 38] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:42:08,930 - INFO - [Trial 38] 测试集指标: {'Accuracy': 0.611, 'Sensitivity': 0.783, 'Specificity': 0.606, 'Precision': 0.035, 'NPV': 0.993, 'F1 Score': 0.067, "Youden's Index": 0.388, "Cohen's Kappa": 0.034, 'AUC-ROC': 0.779, 'AUC-PR': 0.11, 'Log Loss': 0.862, 'Brier': 0.278, 'ECE': 0.393, 'MCE': 0.887}
2025-04-24 16:42:08,930 - INFO - Trial 38: CV AUC=0.733 Sens=0.668 Spec=0.629 | Test AUC=0.779 Sens=0.783 Spec=0.606
2025-04-24 16:42:08,931 - INFO - [04-24 16:42:08][Trial 39/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.587
2025-04-24 16:42:11,748 - WARNING - [Trial 39] 交叉验证失败原因: ['特异度过低: 0.2179 < 0.4', '特异度过低: 0.2482 < 0.4', '特异度过低: 0.2190 < 0.4', '特异度过低: 0.1864 < 0.4', '特异度过低: 0.2550 < 0.4']
2025-04-24 16:42:11,748 - INFO - [04-24 16:42:11][Trial 40/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:42:14,612 - WARNING - [Trial 40] 交叉验证失败原因: ['特异度过低: 0.1655 < 0.4', '特异度过低: 0.1451 < 0.4', '特异度过低: 0.1285 < 0.4', '特异度过低: 0.1048 < 0.4', '特异度过低: 0.1087 < 0.4']
2025-04-24 16:42:14,612 - INFO - [04-24 16:42:14][Trial 41/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:42:21,344 - WARNING - [Trial 41] 交叉验证失败原因: ['特异度过低: 0.0976 < 0.4', '特异度过低: 0.1258 < 0.4', '特异度过低: 0.1076 < 0.4', '特异度过低: 0.0827 < 0.4', '特异度过低: 0.1347 < 0.4']
2025-04-24 16:42:21,345 - INFO - [04-24 16:42:21][Trial 42/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:42:28,452 - WARNING - [Trial 42] 交叉验证失败原因: ['特异度过低: 0.2730 < 0.4', '特异度过低: 0.2918 < 0.4', '特异度过低: 0.2747 < 0.4', '特异度过低: 0.2443 < 0.4', '特异度过低: 0.3190 < 0.4']
2025-04-24 16:42:28,453 - INFO - [04-24 16:42:28][Trial 43/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:42:33,615 - INFO - [Trial 43] 5-fold mean metrics: {'Accuracy': 0.7975088571651855, 'Sensitivity': 0.5924172156670814, 'Specificity': 0.7857489263827959, 'Precision': 0.04477697158544721, 'NPV': 0.9930393465018081, 'F1 Score': 0.08322509255735014, "Youden's Index": 0.37816614204987714, "Cohen's Kappa": 0.055988117686989525, 'AUC-ROC': 0.763649888958416, 'AUC-PR': 0.0754685541212474, 'Log Loss': 0.5011647358101212, 'Brier': 0.1493498598149959, 'ECE': 0.2349687585101313, 'MCE': 0.8660840960278569}
2025-04-24 16:42:33,615 - INFO - [Trial 43] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:42:34,715 - INFO - [Trial 43] 测试集指标: {'Accuracy': 0.801, 'Sensitivity': 0.719, 'Specificity': 0.805, 'Precision': 0.062, 'NPV': 0.992, 'F1 Score': 0.115, "Youden's Index": 0.525, "Cohen's Kappa": 0.084, 'AUC-ROC': 0.824, 'AUC-PR': 0.163, 'Log Loss': 0.486, 'Brier': 0.147, 'ECE': 0.236, 'MCE': 0.85}
2025-04-24 16:42:34,715 - INFO - Trial 43: CV AUC=0.764 Sens=0.592 Spec=0.786 | Test AUC=0.824 Sens=0.719 Spec=0.805
2025-04-24 16:42:34,715 - INFO - [04-24 16:42:34][Trial 44/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.577
2025-04-24 16:42:47,541 - INFO - [Trial 44] 5-fold mean metrics: {'Accuracy': 0.8224808248305925, 'Sensitivity': 0.5834484785864769, 'Specificity': 0.8094684088061571, 'Precision': 0.050303845667979775, 'NPV': 0.9931063823444326, 'F1 Score': 0.09258405635168038, "Youden's Index": 0.39291688739263386, "Cohen's Kappa": 0.06588875746066276, 'AUC-ROC': 0.7707777271265981, 'AUC-PR': 0.08183902235149063, 'Log Loss': 0.4745124125949639, 'Brier': 0.13556000760393444, 'ECE': 0.2045439517367212, 'MCE': 0.8619194184407679}
2025-04-24 16:42:47,541 - INFO - [Trial 44] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:42:50,376 - INFO - [Trial 44] 测试集指标: {'Accuracy': 0.83, 'Sensitivity': 0.693, 'Specificity': 0.826, 'Precision': 0.07, 'NPV': 0.992, 'F1 Score': 0.128, "Youden's Index": 0.519, "Cohen's Kappa": 0.098, 'AUC-ROC': 0.814, 'AUC-PR': 0.167, 'Log Loss': 0.461, 'Brier': 0.135, 'ECE': 0.206, 'MCE': 0.828}
2025-04-24 16:42:50,376 - INFO - Trial 44: CV AUC=0.771 Sens=0.583 Spec=0.809 | Test AUC=0.814 Sens=0.693 Spec=0.826
2025-04-24 16:42:50,377 - INFO - [04-24 16:42:50][Trial 45/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.578
2025-04-24 16:42:54,012 - WARNING - [Trial 45] 交叉验证失败原因: ['特异度过低: 0.2730 < 0.4', '特异度过低: 0.3436 < 0.4', '特异度过低: 0.2857 < 0.4', '特异度过低: 0.2438 < 0.4', '特异度过低: 0.3366 < 0.4']
2025-04-24 16:42:54,012 - INFO - [04-24 16:42:54][Trial 46/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:42:59,783 - INFO - [Trial 46] 5-fold mean metrics: {'Accuracy': 0.687787340660843, 'Sensitivity': 0.6602291182943792, 'Specificity': 0.6649404168325643, 'Precision': 0.03232482250434843, 'NPV': 0.9942261604262287, 'F1 Score': 0.06161880157480674, "Youden's Index": 0.3251695351269437, "Cohen's Kappa": 0.03301261141557312, 'AUC-ROC': 0.7648998125139913, 'AUC-PR': 0.06279412893693867, 'Log Loss': 0.7204680233222183, 'Brier': 0.22657476111276598, 'ECE': 0.3492772352720287, 'MCE': 0.8779352570028877}
2025-04-24 16:42:59,783 - INFO - [Trial 46] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:43:00,979 - INFO - [Trial 46] 测试集指标: {'Accuracy': 0.687, 'Sensitivity': 0.78, 'Specificity': 0.672, 'Precision': 0.043, 'NPV': 0.993, 'F1 Score': 0.082, "Youden's Index": 0.453, "Cohen's Kappa": 0.05, 'AUC-ROC': 0.814, 'AUC-PR': 0.105, 'Log Loss': 0.74, 'Brier': 0.233, 'ECE': 0.358, 'MCE': 0.876}
2025-04-24 16:43:00,979 - INFO - Trial 46: CV AUC=0.765 Sens=0.660 Spec=0.665 | Test AUC=0.814 Sens=0.780 Spec=0.672
2025-04-24 16:43:00,980 - INFO - [04-24 16:43:00][Trial 47/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.596
2025-04-24 16:43:01,758 - INFO - [Trial 47] 5-fold mean metrics: {'Accuracy': 0.6817479145158722, 'Sensitivity': 0.6109701318176403, 'Specificity': 0.6679207928025336, 'Precision': 0.029786646367767226, 'NPV': 0.992467032014696, 'F1 Score': 0.05676361853534399, "Youden's Index": 0.27889092462017384, "Cohen's Kappa": 0.02800998461138613, 'AUC-ROC': 0.7363915367843058, 'AUC-PR': 0.058563667774902295, 'Log Loss': 0.7085785522831001, 'Brier': 0.22590323098699322, 'ECE': 0.3387722336008395, 'MCE': 0.888476570831337}
2025-04-24 16:43:01,758 - INFO - [Trial 47] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:43:01,923 - INFO - [Trial 47] 测试集指标: {'Accuracy': 0.656, 'Sensitivity': 0.774, 'Specificity': 0.648, 'Precision': 0.039, 'NPV': 0.992, 'F1 Score': 0.075, "Youden's Index": 0.422, "Cohen's Kappa": 0.042, 'AUC-ROC': 0.794, 'AUC-PR': 0.124, 'Log Loss': 0.767, 'Brier': 0.246, 'ECE': 0.367, 'MCE': 0.881}
2025-04-24 16:43:01,923 - INFO - Trial 47: CV AUC=0.736 Sens=0.611 Spec=0.668 | Test AUC=0.794 Sens=0.774 Spec=0.648
2025-04-24 16:43:01,924 - INFO - [04-24 16:43:01][Trial 48/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.563
2025-04-24 16:43:04,783 - WARNING - [Trial 48] 交叉验证失败原因: ['特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4']
2025-04-24 16:43:04,783 - INFO - [04-24 16:43:04][Trial 49/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:43:07,012 - WARNING - [Trial 49] 交叉验证失败原因: ['特异度过低: 0.0226 < 0.4', '特异度过低: 0.0364 < 0.4', '特异度过低: 0.0254 < 0.4', '特异度过低: 0.0165 < 0.4', '特异度过低: 0.0193 < 0.4']
2025-04-24 16:43:07,012 - INFO - [04-24 16:43:07][Trial 50/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:43:12,967 - INFO - [Trial 50] 5-fold mean metrics: {'Accuracy': 0.8016548756256796, 'Sensitivity': 0.6061841165068931, 'Specificity': 0.7892795349748992, 'Precision': 0.046666821486910356, 'NPV': 0.9934829341058184, 'F1 Score': 0.08660290247700372, "Youden's Index": 0.39546365148179236, "Cohen's Kappa": 0.05951222301458301, 'AUC-ROC': 0.7701129859802143, 'AUC-PR': 0.07067101341360649, 'Log Loss': 0.5398070792718351, 'Brier': 0.1530571424770862, 'ECE': 0.22443833305772926, 'MCE': 0.8787839526622128}
2025-04-24 16:43:12,967 - INFO - [Trial 50] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:43:14,250 - INFO - [Trial 50] 测试集指标: {'Accuracy': 0.811, 'Sensitivity': 0.719, 'Specificity': 0.802, 'Precision': 0.066, 'NPV': 0.992, 'F1 Score': 0.12, "Youden's Index": 0.522, "Cohen's Kappa": 0.09, 'AUC-ROC': 0.821, 'AUC-PR': 0.173, 'Log Loss': 0.525, 'Brier': 0.151, 'ECE': 0.226, 'MCE': 0.858}
2025-04-24 16:43:14,250 - INFO - Trial 50: CV AUC=0.770 Sens=0.606 Spec=0.789 | Test AUC=0.821 Sens=0.719 Spec=0.802
2025-04-24 16:43:14,251 - INFO - [04-24 16:43:14][Trial 51/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.586
2025-04-24 16:43:20,748 - INFO - [Trial 51] 5-fold mean metrics: {'Accuracy': 0.662465163042774, 'Sensitivity': 0.701049177123525, 'Specificity': 0.6372486420736184, 'Precision': 0.03171780351658111, 'NPV': 0.9946647242774465, 'F1 Score': 0.06067785340163161, "Youden's Index": 0.3382978191971435, "Cohen's Kappa": 0.03193975036067922, 'AUC-ROC': 0.7706757771721925, 'AUC-PR': 0.06285231814060432, 'Log Loss': 0.7706937742888795, 'Brier': 0.24481137478769951, 'ECE': 0.384130827345311, 'MCE': 0.880982820826446}
2025-04-24 16:43:20,748 - INFO - [Trial 51] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:43:22,146 - INFO - [Trial 51] 测试集指标: {'Accuracy': 0.66, 'Sensitivity': 0.78, 'Specificity': 0.644, 'Precision': 0.04, 'NPV': 0.993, 'F1 Score': 0.076, "Youden's Index": 0.424, "Cohen's Kappa": 0.043, 'AUC-ROC': 0.815, 'AUC-PR': 0.104, 'Log Loss': 0.794, 'Brier': 0.25, 'ECE': 0.391, 'MCE': 0.847}
2025-04-24 16:43:22,146 - INFO - Trial 51: CV AUC=0.771 Sens=0.701 Spec=0.637 | Test AUC=0.815 Sens=0.780 Spec=0.644
2025-04-24 16:43:22,147 - INFO - [04-24 16:43:22][Trial 52/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.615
2025-04-24 16:43:28,614 - INFO - [Trial 52] 5-fold mean metrics: {'Accuracy': 0.5766121655574695, 'Sensitivity': 0.8393169506415376, 'Specificity': 0.5440232975237705, 'Precision': 0.02987837046539236, 'NPV': 0.9953791599607895, 'F1 Score': 0.057687231981436035, "Youden's Index": 0.38334024816530815, "Cohen's Kappa": 0.028583210245611435, 'AUC-ROC': 0.7706167090578788, 'AUC-PR': 0.05814729193272374, 'Log Loss': 0.9025984568761112, 'Brier': 0.30085227680702464, 'ECE': 0.470006441083252, 'MCE': 0.879971139106341}
2025-04-24 16:43:28,614 - INFO - [Trial 52] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:43:30,037 - INFO - [Trial 52] 测试集指标: {'Accuracy': 0.573, 'Sensitivity': 0.785, 'Specificity': 0.561, 'Precision': 0.032, 'NPV': 0.992, 'F1 Score': 0.062, "Youden's Index": 0.346, "Cohen's Kappa": 0.028, 'AUC-ROC': 0.81, 'AUC-PR': 0.09, 'Log Loss': 0.928, 'Brier': 0.307, 'ECE': 0.476, 'MCE': 0.851}
2025-04-24 16:43:30,037 - INFO - Trial 52: CV AUC=0.771 Sens=0.839 Spec=0.544 | Test AUC=0.810 Sens=0.785 Spec=0.561
2025-04-24 16:43:30,037 - INFO - [04-24 16:43:30][Trial 53/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.674
2025-04-24 16:43:36,343 - INFO - [Trial 53] 5-fold mean metrics: {'Accuracy': 0.5593626542574013, 'Sensitivity': 0.8424036183372043, 'Specificity': 0.52570855082681, 'Precision': 0.02884392080807447, 'NPV': 0.9954110145455518, 'F1 Score': 0.05576447272765304, "Youden's Index": 0.3681121691640144, "Cohen's Kappa": 0.026560899151456763, 'AUC-ROC': 0.7688975104395027, 'AUC-PR': 0.05776864758300647, 'Log Loss': 0.923773064297982, 'Brier': 0.3103852344105531, 'ECE': 0.4817483646319677, 'MCE': 0.8799654387577253}
2025-04-24 16:43:36,343 - INFO - [Trial 53] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:43:37,679 - INFO - [Trial 53] 测试集指标: {'Accuracy': 0.551, 'Sensitivity': 0.838, 'Specificity': 0.541, 'Precision': 0.033, 'NPV': 0.994, 'F1 Score': 0.063, "Youden's Index": 0.379, "Cohen's Kappa": 0.029, 'AUC-ROC': 0.812, 'AUC-PR': 0.122, 'Log Loss': 0.952, 'Brier': 0.318, 'ECE': 0.49, 'MCE': 0.853}
2025-04-24 16:43:37,679 - INFO - Trial 53: CV AUC=0.769 Sens=0.842 Spec=0.526 | Test AUC=0.812 Sens=0.838 Spec=0.541
2025-04-24 16:43:37,679 - INFO - [04-24 16:43:37][Trial 54/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.673
2025-04-24 16:43:49,436 - INFO - [Trial 54] 5-fold mean metrics: {'Accuracy': 0.7223779947719166, 'Sensitivity': 0.6674314571998473, 'Specificity': 0.7033343926437587, 'Precision': 0.03669831024771726, 'NPV': 0.9942358182615514, 'F1 Score': 0.06955201035495248, "Youden's Index": 0.37076584984360605, "Cohen's Kappa": 0.04135955597660299, 'AUC-ROC': 0.7712605695518457, 'AUC-PR': 0.06200212489380778, 'Log Loss': 0.6636579592583007, 'Brier': 0.20618309585611297, 'ECE': 0.3290448283653872, 'MCE': 0.8907810987490119}
2025-04-24 16:43:49,436 - INFO - [Trial 54] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:43:52,037 - INFO - [Trial 54] 测试集指标: {'Accuracy': 0.721, 'Sensitivity': 0.78, 'Specificity': 0.71, 'Precision': 0.048, 'NPV': 0.993, 'F1 Score': 0.091, "Youden's Index": 0.49, "Cohen's Kappa": 0.06, 'AUC-ROC': 0.809, 'AUC-PR': 0.134, 'Log Loss': 0.683, 'Brier': 0.21, 'ECE': 0.335, 'MCE': 0.883}
2025-04-24 16:43:52,037 - INFO - Trial 54: CV AUC=0.771 Sens=0.667 Spec=0.703 | Test AUC=0.809 Sens=0.780 Spec=0.710
2025-04-24 16:43:52,038 - INFO - [04-24 16:43:52][Trial 55/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.606
2025-04-24 16:43:58,477 - WARNING - [Trial 55] 交叉验证失败原因: ['特异度过低: 0.1577 < 0.4', '特异度过低: 0.1997 < 0.4', '特异度过低: 0.1644 < 0.4', '特异度过低: 0.1589 < 0.4', '特异度过低: 0.2075 < 0.4']
2025-04-24 16:43:58,477 - INFO - [04-24 16:43:58][Trial 56/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:44:05,481 - WARNING - [Trial 56] 交叉验证失败原因: ['特异度过低: 0.3922 < 0.4', '特异度过低: 0.3784 < 0.4']
2025-04-24 16:44:05,481 - INFO - [04-24 16:44:05][Trial 57/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:44:08,781 - WARNING - [Trial 57] 交叉验证失败原因: ['敏感度过低: 0.3948 < 0.4', '敏感度过低: 0.3807 < 0.4']
2025-04-24 16:44:08,782 - INFO - [04-24 16:44:08][Trial 58/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:44:12,501 - INFO - [Trial 58] 5-fold mean metrics: {'Accuracy': 0.5425241763237655, 'Sensitivity': 0.8441475688225456, 'Specificity': 0.5112565735082291, 'Precision': 0.027959793235073915, 'NPV': 0.995320326539637, 'F1 Score': 0.05410393440601916, "Youden's Index": 0.3554041423307748, "Cohen's Kappa": 0.024824310377030766, 'AUC-ROC': 0.7548825536315003, 'AUC-PR': 0.05225961753564952, 'Log Loss': 0.9382438298385722, 'Brier': 0.3178001472396829, 'ECE': 0.4852519786247124, 'MCE': 0.8845511284966895}
2025-04-24 16:44:12,501 - INFO - [Trial 58] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:44:13,252 - INFO - [Trial 58] 测试集指标: {'Accuracy': 0.506, 'Sensitivity': 0.896, 'Specificity': 0.506, 'Precision': 0.032, 'NPV': 0.994, 'F1 Score': 0.061, "Youden's Index": 0.402, "Cohen's Kappa": 0.027, 'AUC-ROC': 0.807, 'AUC-PR': 0.076, 'Log Loss': 1.006, 'Brier': 0.341, 'ECE': 0.508, 'MCE': 0.874}
2025-04-24 16:44:13,252 - INFO - Trial 58: CV AUC=0.755 Sens=0.844 Spec=0.511 | Test AUC=0.807 Sens=0.896 Spec=0.506
2025-04-24 16:44:13,253 - INFO - [04-24 16:44:13][Trial 59/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.669
2025-04-24 16:44:14,856 - INFO - [Trial 59] 5-fold mean metrics: {'Accuracy': 0.767389858770442, 'Sensitivity': 0.5771349568311972, 'Specificity': 0.7569538250238345, 'Precision': 0.03829578101571428, 'NPV': 0.9924921674833923, 'F1 Score': 0.07177097331965791, "Youden's Index": 0.33408878185503177, "Cohen's Kappa": 0.04396104392228941, 'AUC-ROC': 0.7484077902886429, 'AUC-PR': 0.06140462272047518, 'Log Loss': 0.5391842880014259, 'Brier': 0.1673795925969228, 'ECE': 0.2662677115312812, 'MCE': 0.8719877629252245}
2025-04-24 16:44:14,856 - INFO - [Trial 59] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:44:15,187 - INFO - [Trial 59] 测试集指标: {'Accuracy': 0.735, 'Sensitivity': 0.774, 'Specificity': 0.741, 'Precision': 0.051, 'NPV': 0.993, 'F1 Score': 0.095, "Youden's Index": 0.515, "Cohen's Kappa": 0.063, 'AUC-ROC': 0.802, 'AUC-PR': 0.137, 'Log Loss': 0.573, 'Brier': 0.183, 'ECE': 0.292, 'MCE': 0.854}
2025-04-24 16:44:15,187 - INFO - Trial 59: CV AUC=0.748 Sens=0.577 Spec=0.757 | Test AUC=0.802 Sens=0.774 Spec=0.741
2025-04-24 16:44:15,187 - INFO - [04-24 16:44:15][Trial 60/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.561
2025-04-24 16:44:18,872 - WARNING - [Trial 60] 交叉验证失败原因: ['特异度过低: 0.1776 < 0.4', '特异度过低: 0.2510 < 0.4', '特异度过低: 0.1594 < 0.4', '特异度过低: 0.1368 < 0.4', '特异度过低: 0.2202 < 0.4']
2025-04-24 16:44:18,872 - INFO - [04-24 16:44:18][Trial 61/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:44:22,567 - INFO - [Trial 61] 5-fold mean metrics: {'Accuracy': 0.5841980000667836, 'Sensitivity': 0.7879159917981033, 'Specificity': 0.5567107924250781, 'Precision': 0.0287819036886476, 'NPV': 0.9943412694430517, 'F1 Score': 0.055510077255117904, "Youden's Index": 0.34462678422318144, "Cohen's Kappa": 0.026377354038414746, 'AUC-ROC': 0.7550231937486405, 'AUC-PR': 0.04931325637404323, 'Log Loss': 0.8746938716294619, 'Brier': 0.29346860620199344, 'ECE': 0.45830943481172304, 'MCE': 0.8855125081801501}
2025-04-24 16:44:22,567 - INFO - [Trial 61] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:44:23,335 - INFO - [Trial 61] 测试集指标: {'Accuracy': 0.551, 'Sensitivity': 0.845, 'Specificity': 0.545, 'Precision': 0.033, 'NPV': 0.993, 'F1 Score': 0.063, "Youden's Index": 0.389, "Cohen's Kappa": 0.03, 'AUC-ROC': 0.81, 'AUC-PR': 0.075, 'Log Loss': 0.939, 'Brier': 0.317, 'ECE': 0.48, 'MCE': 0.879}
2025-04-24 16:44:23,335 - INFO - Trial 61: CV AUC=0.755 Sens=0.788 Spec=0.557 | Test AUC=0.810 Sens=0.845 Spec=0.545
2025-04-24 16:44:23,336 - INFO - [04-24 16:44:23][Trial 62/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.645
2025-04-24 16:44:26,854 - INFO - [Trial 62] 5-fold mean metrics: {'Accuracy': 0.8104921215534953, 'Sensitivity': 0.580637614611603, 'Specificity': 0.7997600722766286, 'Precision': 0.04725722402978343, 'NPV': 0.9928847028771974, 'F1 Score': 0.0873203545156995, "Youden's Index": 0.3803976868882316, "Cohen's Kappa": 0.06036145216385351, 'AUC-ROC': 0.7509552580169878, 'AUC-PR': 0.06958558882531132, 'Log Loss': 0.4778460191837451, 'Brier': 0.14347812324410952, 'ECE': 0.21939323193549445, 'MCE': 0.863331388433487}
2025-04-24 16:44:26,854 - INFO - [Trial 62] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:44:27,572 - INFO - [Trial 62] 测试集指标: {'Accuracy': 0.794, 'Sensitivity': 0.77, 'Specificity': 0.798, 'Precision': 0.064, 'NPV': 0.993, 'F1 Score': 0.118, "Youden's Index": 0.567, "Cohen's Kappa": 0.088, 'AUC-ROC': 0.817, 'AUC-PR': 0.149, 'Log Loss': 0.485, 'Brier': 0.151, 'ECE': 0.236, 'MCE': 0.853}
2025-04-24 16:44:27,572 - INFO - Trial 62: CV AUC=0.751 Sens=0.581 Spec=0.800 | Test AUC=0.817 Sens=0.770 Spec=0.798
2025-04-24 16:44:27,572 - INFO - [04-24 16:44:27][Trial 63/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.570
2025-04-24 16:44:31,402 - WARNING - [Trial 63] 交叉验证失败原因: ['特异度过低: 0.3690 < 0.4']
2025-04-24 16:44:31,403 - INFO - [04-24 16:44:31][Trial 64/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:44:35,111 - INFO - [Trial 64] 5-fold mean metrics: {'Accuracy': 0.5317301261425693, 'Sensitivity': 0.8241126581424453, 'Specificity': 0.49746672608545844, 'Precision': 0.02666457204653961, 'NPV': 0.9947857920257295, 'F1 Score': 0.051641765253049886, "Youden's Index": 0.3215793842279036, "Cohen's Kappa": 0.022259840498167826, 'AUC-ROC': 0.7554530729910732, 'AUC-PR': 0.05512747222485783, 'Log Loss': 0.9963025593774095, 'Brier': 0.3367965771367559, 'ECE': 0.5069933944349155, 'MCE': 0.8862975406060469}
2025-04-24 16:44:35,111 - INFO - [Trial 64] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:44:35,863 - WARNING - [Trial 64] 测试集约束检查失败: ['特异度过低: 0.4949 < 0.5']
2025-04-24 16:44:35,864 - INFO - [04-24 16:44:35][Trial 65/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:44:41,731 - INFO - [Trial 65] 5-fold mean metrics: {'Accuracy': 0.7483162751596143, 'Sensitivity': 0.6128201608726089, 'Specificity': 0.7368743523899626, 'Precision': 0.037582328362731565, 'NPV': 0.993314039396185, 'F1 Score': 0.07077065416768338, "Youden's Index": 0.3496945132625716, "Cohen's Kappa": 0.04278673846895742, 'AUC-ROC': 0.7541717679022353, 'AUC-PR': 0.056273022037021406, 'Log Loss': 0.5792834846201126, 'Brier': 0.18187191136952796, 'ECE': 0.2986386044645677, 'MCE': 0.8811520522215007}
2025-04-24 16:44:41,731 - INFO - [Trial 65] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:44:42,917 - INFO - [Trial 65] 测试集指标: {'Accuracy': 0.725, 'Sensitivity': 0.78, 'Specificity': 0.721, 'Precision': 0.049, 'NPV': 0.993, 'F1 Score': 0.093, "Youden's Index": 0.501, "Cohen's Kappa": 0.061, 'AUC-ROC': 0.808, 'AUC-PR': 0.123, 'Log Loss': 0.618, 'Brier': 0.199, 'ECE': 0.321, 'MCE': 0.843}
2025-04-24 16:44:42,918 - INFO - Trial 65: CV AUC=0.754 Sens=0.613 Spec=0.737 | Test AUC=0.808 Sens=0.780 Spec=0.721
2025-04-24 16:44:42,918 - INFO - [04-24 16:44:42][Trial 66/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.578
2025-04-24 16:44:44,088 - WARNING - [Trial 66] 交叉验证失败原因: ['特异度过低: 0.1423 < 0.4', '特异度过低: 0.1114 < 0.4', '特异度过低: 0.1020 < 0.4', '特异度过低: 0.0916 < 0.4', '特异度过低: 0.0894 < 0.4']
2025-04-24 16:44:44,088 - INFO - [04-24 16:44:44][Trial 67/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:44:45,501 - WARNING - [Trial 67] 交叉验证失败原因: ['特异度过低: 0.1566 < 0.4', '特异度过低: 0.2168 < 0.4', '特异度过低: 0.1440 < 0.4', '特异度过低: 0.1037 < 0.4', '特异度过低: 0.2053 < 0.4']
2025-04-24 16:44:45,501 - INFO - [04-24 16:44:45][Trial 68/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:44:47,630 - INFO - [Trial 68] 5-fold mean metrics: {'Accuracy': 0.8538974796014125, 'Sensitivity': 0.5578708434178992, 'Specificity': 0.8500686725379252, 'Precision': 0.05882650824192465, 'NPV': 0.9927958195361356, 'F1 Score': 0.10632168317535631, "Youden's Index": 0.4079395159558243, "Cohen's Kappa": 0.08050938420254902, 'AUC-ROC': 0.7427240911818577, 'AUC-PR': 0.09605982292988413, 'Log Loss': 0.3877821008723656, 'Brier': 0.11054050322318124, 'ECE': 0.16017467530354904, 'MCE': 0.8477188926744648}
2025-04-24 16:44:47,630 - INFO - [Trial 68] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:44:48,085 - INFO - [Trial 68] 测试集指标: {'Accuracy': 0.846, 'Sensitivity': 0.686, 'Specificity': 0.856, 'Precision': 0.077, 'NPV': 0.991, 'F1 Score': 0.138, "Youden's Index": 0.542, "Cohen's Kappa": 0.109, 'AUC-ROC': 0.812, 'AUC-PR': 0.188, 'Log Loss': 0.38, 'Brier': 0.111, 'ECE': 0.166, 'MCE': 0.806}
2025-04-24 16:44:48,085 - INFO - Trial 68: CV AUC=0.743 Sens=0.558 Spec=0.850 | Test AUC=0.812 Sens=0.686 Spec=0.856
2025-04-24 16:44:48,086 - INFO - [04-24 16:44:48][Trial 69/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.564
2025-04-24 16:44:49,204 - WARNING - [Trial 69] 交叉验证失败原因: ['特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4', '特异度过低: 0.0000 < 0.4']
2025-04-24 16:44:49,204 - INFO - [04-24 16:44:49][Trial 70/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:44:50,495 - WARNING - [Trial 70] 交叉验证失败原因: ['敏感度过低: 0.3948 < 0.4']
2025-04-24 16:44:50,495 - INFO - [04-24 16:44:50][Trial 71/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:44:56,903 - INFO - [Trial 71] 5-fold mean metrics: {'Accuracy': 0.5425931884548956, 'Sensitivity': 0.8581143453445558, 'Specificity': 0.5072843420525539, 'Precision': 0.02827730988705084, 'NPV': 0.9954928856927214, 'F1 Score': 0.05473487184103091, "Youden's Index": 0.3653986873971097, "Cohen's Kappa": 0.025465608990904352, 'AUC-ROC': 0.7674701688222535, 'AUC-PR': 0.06095329617725968, 'Log Loss': 0.9472329879189768, 'Brier': 0.31927289991844626, 'ECE': 0.48883858389392226, 'MCE': 0.8792732881812866}
2025-04-24 16:44:56,903 - INFO - [Trial 71] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:44:58,265 - INFO - [Trial 71] 测试集指标: {'Accuracy': 0.536, 'Sensitivity': 0.898, 'Specificity': 0.522, 'Precision': 0.034, 'NPV': 0.995, 'F1 Score': 0.065, "Youden's Index": 0.419, "Cohen's Kappa": 0.031, 'AUC-ROC': 0.814, 'AUC-PR': 0.089, 'Log Loss': 0.972, 'Brier': 0.326, 'ECE': 0.496, 'MCE': 0.854}
2025-04-24 16:44:58,265 - INFO - Trial 71: CV AUC=0.767 Sens=0.858 Spec=0.507 | Test AUC=0.814 Sens=0.898 Spec=0.522
2025-04-24 16:44:58,266 - INFO - [04-24 16:44:58][Trial 72/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.678
2025-04-24 16:45:01,945 - WARNING - [Trial 72] 交叉验证失败原因: ['特异度过低: 0.3938 < 0.4']
2025-04-24 16:45:01,945 - INFO - [04-24 16:45:01][Trial 73/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:45:07,828 - INFO - [Trial 73] 5-fold mean metrics: {'Accuracy': 0.7371753181749974, 'Sensitivity': 0.6391473973868014, 'Specificity': 0.7231941496842158, 'Precision': 0.03728779714063747, 'NPV': 0.9940867539086027, 'F1 Score': 0.07043391556698105, "Youden's Index": 0.3623415470710173, "Cohen's Kappa": 0.04235484899342978, 'AUC-ROC': 0.7724624042729655, 'AUC-PR': 0.06551249386328965, 'Log Loss': 0.6630228078549363, 'Brier': 0.19635652421331828, 'ECE': 0.2913015403585004, 'MCE': 0.8819200201258688}
2025-04-24 16:45:07,828 - INFO - [Trial 73] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:45:09,123 - INFO - [Trial 73] 测试集指标: {'Accuracy': 0.738, 'Sensitivity': 0.78, 'Specificity': 0.734, 'Precision': 0.051, 'NPV': 0.993, 'F1 Score': 0.096, "Youden's Index": 0.514, "Cohen's Kappa": 0.065, 'AUC-ROC': 0.818, 'AUC-PR': 0.149, 'Log Loss': 0.668, 'Brier': 0.199, 'ECE': 0.297, 'MCE': 0.85}
2025-04-24 16:45:09,123 - INFO - Trial 73: CV AUC=0.772 Sens=0.639 Spec=0.723 | Test AUC=0.818 Sens=0.780 Spec=0.734
2025-04-24 16:45:09,123 - INFO - [04-24 16:45:09][Trial 74/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.594
2025-04-24 16:45:12,783 - WARNING - [Trial 74] 交叉验证失败原因: ['特异度过低: 0.1611 < 0.4', '特异度过低: 0.2366 < 0.4', '特异度过低: 0.1489 < 0.4', '特异度过低: 0.1241 < 0.4', '特异度过低: 0.2252 < 0.4']
2025-04-24 16:45:12,783 - INFO - [04-24 16:45:12][Trial 75/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:45:15,536 - WARNING - [Trial 75] 交叉验证失败原因: ['特异度过低: 0.3309 < 0.4', '特异度过低: 0.3668 < 0.4', '特异度过低: 0.3398 < 0.4', '特异度过低: 0.3133 < 0.4', '特异度过低: 0.3791 < 0.4']
2025-04-24 16:45:15,537 - INFO - [04-24 16:45:15][Trial 76/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:45:18,280 - WARNING - [Trial 76] 交叉验证失败原因: ['特异度过低: 0.0033 < 0.4', '特异度过低: 0.0154 < 0.4', '特异度过低: 0.0033 < 0.4', '特异度过低: 0.0022 < 0.4', '特异度过低: 0.0050 < 0.4']
2025-04-24 16:45:18,280 - INFO - [04-24 16:45:18][Trial 77/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:45:25,428 - INFO - [Trial 77] 5-fold mean metrics: {'Accuracy': 0.4876738196060919, 'Sensitivity': 0.8621835201115557, 'Specificity': 0.4475980440502673, 'Precision': 0.025426070880635997, 'NPV': 0.9954093490332434, 'F1 Score': 0.04938200612884702, "Youden's Index": 0.3097815641618231, "Cohen's Kappa": 0.019843220459436428, 'AUC-ROC': 0.763654748784193, 'AUC-PR': 0.055917938341236, 'Log Loss': 1.0324329194016761, 'Brier': 0.3532099185903328, 'ECE': 0.5264477898947932, 'MCE': 0.8801951646156455}
2025-04-24 16:45:25,428 - INFO - [Trial 77] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:45:26,948 - WARNING - [Trial 77] 测试集约束检查失败: ['特异度过低: 0.4636 < 0.5']
2025-04-24 16:45:26,949 - INFO - [04-24 16:45:26][Trial 78/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:45:39,197 - INFO - [Trial 78] 5-fold mean metrics: {'Accuracy': 0.7815444489222856, 'Sensitivity': 0.6261930703646745, 'Specificity': 0.7671039061767538, 'Precision': 0.043745892500196074, 'NPV': 0.9941421278501927, 'F1 Score': 0.08173076530618908, "Youden's Index": 0.39329697654142837, "Cohen's Kappa": 0.054303286272349774, 'AUC-ROC': 0.7694315971432715, 'AUC-PR': 0.0646571211885164, 'Log Loss': 0.5575728510309659, 'Brier': 0.165838765502144, 'ECE': 0.2636682396796779, 'MCE': 0.877602233514865}
2025-04-24 16:45:39,198 - INFO - [Trial 78] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:45:41,867 - INFO - [Trial 78] 测试集指标: {'Accuracy': 0.785, 'Sensitivity': 0.725, 'Specificity': 0.782, 'Precision': 0.058, 'NPV': 0.992, 'F1 Score': 0.108, "Youden's Index": 0.507, "Cohen's Kappa": 0.077, 'AUC-ROC': 0.819, 'AUC-PR': 0.148, 'Log Loss': 0.56, 'Brier': 0.167, 'ECE': 0.266, 'MCE': 0.871}
2025-04-24 16:45:41,867 - INFO - Trial 78: CV AUC=0.769 Sens=0.626 Spec=0.767 | Test AUC=0.819 Sens=0.725 Spec=0.782
2025-04-24 16:45:41,868 - INFO - [04-24 16:45:41][Trial 79/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.593
2025-04-24 16:45:45,346 - INFO - [Trial 79] 5-fold mean metrics: {'Accuracy': 0.7717386143736615, 'Sensitivity': 0.581018183058611, 'Specificity': 0.76357335846456, 'Precision': 0.03927097733274858, 'NPV': 0.9925482350948533, 'F1 Score': 0.07352192319352727, "Youden's Index": 0.34459154152317095, "Cohen's Kappa": 0.04579232889691469, 'AUC-ROC': 0.7509533313906173, 'AUC-PR': 0.06899033682015439, 'Log Loss': 0.5326478910342636, 'Brier': 0.16274901908429462, 'ECE': 0.24926180976909898, 'MCE': 0.8679778110351835}
2025-04-24 16:45:45,346 - INFO - [Trial 79] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:45:46,053 - INFO - [Trial 79] 测试集指标: {'Accuracy': 0.756, 'Sensitivity': 0.774, 'Specificity': 0.763, 'Precision': 0.055, 'NPV': 0.993, 'F1 Score': 0.102, "Youden's Index": 0.537, "Cohen's Kappa": 0.071, 'AUC-ROC': 0.812, 'AUC-PR': 0.143, 'Log Loss': 0.558, 'Brier': 0.175, 'ECE': 0.268, 'MCE': 0.875}
2025-04-24 16:45:46,053 - INFO - Trial 79: CV AUC=0.751 Sens=0.581 Spec=0.764 | Test AUC=0.812 Sens=0.774 Spec=0.763
2025-04-24 16:45:46,054 - INFO - [04-24 16:45:46][Trial 80/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.564
2025-04-24 16:45:48,210 - INFO - [Trial 80] 5-fold mean metrics: {'Accuracy': 0.8381912166064666, 'Sensitivity': 0.5776295656365591, 'Specificity': 0.827451542636027, 'Precision': 0.055033797292765294, 'NPV': 0.9928614640572487, 'F1 Score': 0.10035846943643127, "Youden's Index": 0.40508110827258614, "Cohen's Kappa": 0.07411965893720376, 'AUC-ROC': 0.7495608813432989, 'AUC-PR': 0.06627670645102568, 'Log Loss': 0.4087262706467042, 'Brier': 0.1208702829810883, 'ECE': 0.19492700417380787, 'MCE': 0.8699395553638286}
2025-04-24 16:45:48,210 - INFO - [Trial 80] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:45:48,646 - INFO - [Trial 80] 测试集指标: {'Accuracy': 0.839, 'Sensitivity': 0.719, 'Specificity': 0.836, 'Precision': 0.076, 'NPV': 0.992, 'F1 Score': 0.138, "Youden's Index": 0.555, "Cohen's Kappa": 0.109, 'AUC-ROC': 0.839, 'AUC-PR': 0.151, 'Log Loss': 0.399, 'Brier': 0.122, 'ECE': 0.2, 'MCE': 0.827}
2025-04-24 16:45:48,646 - INFO - Trial 80: CV AUC=0.750 Sens=0.578 Spec=0.827 | Test AUC=0.839 Sens=0.719 Spec=0.836
2025-04-24 16:45:48,647 - INFO - [04-24 16:45:48][Trial 81/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.573
2025-04-24 16:45:55,016 - INFO - [Trial 81] 5-fold mean metrics: {'Accuracy': 0.6843676873511236, 'Sensitivity': 0.6979092984279059, 'Specificity': 0.6598663807746117, 'Precision': 0.03378838977412946, 'NPV': 0.9946885377316848, 'F1 Score': 0.06444055331671844, "Youden's Index": 0.35777567920251757, "Cohen's Kappa": 0.03590627270600919, 'AUC-ROC': 0.7723681184927812, 'AUC-PR': 0.06334645351342269, 'Log Loss': 0.7414183513841814, 'Brier': 0.232304367682794, 'ECE': 0.36098051980067647, 'MCE': 0.8797486136708985}
2025-04-24 16:45:55,016 - INFO - [Trial 81] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:45:56,401 - INFO - [Trial 81] 测试集指标: {'Accuracy': 0.676, 'Sensitivity': 0.78, 'Specificity': 0.662, 'Precision': 0.042, 'NPV': 0.993, 'F1 Score': 0.08, "Youden's Index": 0.442, "Cohen's Kappa": 0.047, 'AUC-ROC': 0.816, 'AUC-PR': 0.104, 'Log Loss': 0.761, 'Brier': 0.237, 'ECE': 0.368, 'MCE': 0.849}
2025-04-24 16:45:56,401 - INFO - Trial 81: CV AUC=0.772 Sens=0.698 Spec=0.660 | Test AUC=0.816 Sens=0.780 Spec=0.662
2025-04-24 16:45:56,402 - INFO - [04-24 16:45:56][Trial 82/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.616
2025-04-24 16:46:02,804 - INFO - [Trial 82] 5-fold mean metrics: {'Accuracy': 0.5760714238703453, 'Sensitivity': 0.7746458002192045, 'Specificity': 0.5436924760955034, 'Precision': 0.027847609651852602, 'NPV': 0.9947455184225594, 'F1 Score': 0.05374947236674623, "Youden's Index": 0.31833827631470796, "Cohen's Kappa": 0.02452956196911147, 'AUC-ROC': 0.7673022939779786, 'AUC-PR': 0.06133149859029289, 'Log Loss': 0.9121152720281653, 'Brier': 0.2997603432748083, 'ECE': 0.45800823409035685, 'MCE': 0.8832322425669539}
2025-04-24 16:46:02,804 - INFO - [Trial 82] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:46:04,185 - INFO - [Trial 82] 测试集指标: {'Accuracy': 0.576, 'Sensitivity': 0.836, 'Specificity': 0.56, 'Precision': 0.034, 'NPV': 0.994, 'F1 Score': 0.066, "Youden's Index": 0.396, "Cohen's Kappa": 0.033, 'AUC-ROC': 0.813, 'AUC-PR': 0.104, 'Log Loss': 0.936, 'Brier': 0.306, 'ECE': 0.465, 'MCE': 0.854}
2025-04-24 16:46:04,185 - INFO - Trial 82: CV AUC=0.767 Sens=0.775 Spec=0.544 | Test AUC=0.813 Sens=0.836 Spec=0.560
2025-04-24 16:46:04,186 - INFO - [04-24 16:46:04][Trial 83/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.640
2025-04-24 16:46:11,134 - INFO - [Trial 83] 5-fold mean metrics: {'Accuracy': 0.8179075584820177, 'Sensitivity': 0.6037660971929558, 'Specificity': 0.8027391088885885, 'Precision': 0.05108054537829624, 'NPV': 0.9935805099242383, 'F1 Score': 0.09411334639217651, "Youden's Index": 0.4065052060815443, "Cohen's Kappa": 0.06740135549648515, 'AUC-ROC': 0.7734012688249055, 'AUC-PR': 0.06856853919131707, 'Log Loss': 0.5032305439750596, 'Brier': 0.143284666851347, 'ECE': 0.2211377372952999, 'MCE': 0.8782848140778616}
2025-04-24 16:46:11,134 - INFO - [Trial 83] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:46:12,592 - INFO - [Trial 83] 测试集指标: {'Accuracy': 0.819, 'Sensitivity': 0.719, 'Specificity': 0.814, 'Precision': 0.068, 'NPV': 0.992, 'F1 Score': 0.125, "Youden's Index": 0.533, "Cohen's Kappa": 0.095, 'AUC-ROC': 0.818, 'AUC-PR': 0.16, 'Log Loss': 0.506, 'Brier': 0.146, 'ECE': 0.224, 'MCE': 0.828}
2025-04-24 16:46:12,592 - INFO - Trial 83: CV AUC=0.773 Sens=0.604 Spec=0.803 | Test AUC=0.818 Sens=0.719 Spec=0.814
2025-04-24 16:46:12,593 - INFO - [04-24 16:46:12][Trial 84/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.588
2025-04-24 16:46:19,083 - INFO - [Trial 84] 5-fold mean metrics: {'Accuracy': 0.523395359066898, 'Sensitivity': 0.8621835201115557, 'Specificity': 0.4879775572301589, 'Precision': 0.027288438959276573, 'NPV': 0.9957834699627742, 'F1 Score': 0.05288591827136824, "Youden's Index": 0.35016107734171464, "Cohen's Kappa": 0.023522386340449362, 'AUC-ROC': 0.764770923135425, 'AUC-PR': 0.06060802585063294, 'Log Loss': 0.9574766924563374, 'Brier': 0.32760613846288417, 'ECE': 0.5050826631224462, 'MCE': 0.869788049036045}
2025-04-24 16:46:19,083 - INFO - [Trial 84] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:46:20,460 - INFO - [Trial 84] 测试集指标: {'Accuracy': 0.514, 'Sensitivity': 0.898, 'Specificity': 0.503, 'Precision': 0.032, 'NPV': 0.995, 'F1 Score': 0.062, "Youden's Index": 0.4, "Cohen's Kappa": 0.029, 'AUC-ROC': 0.811, 'AUC-PR': 0.128, 'Log Loss': 0.983, 'Brier': 0.335, 'ECE': 0.512, 'MCE': 0.852}
2025-04-24 16:46:20,460 - INFO - Trial 84: CV AUC=0.765 Sens=0.862 Spec=0.488 | Test AUC=0.811 Sens=0.898 Spec=0.503
2025-04-24 16:46:20,461 - INFO - [04-24 16:46:20][Trial 85/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.678
2025-04-24 16:46:22,288 - WARNING - [Trial 85] 交叉验证失败原因: ['特异度过低: 0.0199 < 0.4', '特异度过低: 0.0116 < 0.4', '特异度过低: 0.0039 < 0.4', '特异度过低: 0.0039 < 0.4', '特异度过低: 0.0039 < 0.4']
2025-04-24 16:46:22,288 - INFO - [04-24 16:46:22][Trial 86/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:46:32,870 - INFO - [Trial 86] 5-fold mean metrics: {'Accuracy': 0.7265602055536575, 'Sensitivity': 0.6716139563274712, 'Specificity': 0.7094021714646124, 'Precision': 0.03744773131407222, 'NPV': 0.9944390232603253, 'F1 Score': 0.07092332560635917, "Youden's Index": 0.3810161277920835, "Cohen's Kappa": 0.04279225155701196, 'AUC-ROC': 0.7740598917099195, 'AUC-PR': 0.06703601797074409, 'Log Loss': 0.6698597708948502, 'Brier': 0.20533743744286587, 'ECE': 0.3290528191579388, 'MCE': 0.8743560190880704}
2025-04-24 16:46:32,870 - INFO - [Trial 86] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:46:35,145 - INFO - [Trial 86] 测试集指标: {'Accuracy': 0.731, 'Sensitivity': 0.78, 'Specificity': 0.717, 'Precision': 0.05, 'NPV': 0.993, 'F1 Score': 0.094, "Youden's Index": 0.497, "Cohen's Kappa": 0.063, 'AUC-ROC': 0.815, 'AUC-PR': 0.108, 'Log Loss': 0.687, 'Brier': 0.209, 'ECE': 0.334, 'MCE': 0.847}
2025-04-24 16:46:35,145 - INFO - Trial 86: CV AUC=0.774 Sens=0.672 Spec=0.709 | Test AUC=0.815 Sens=0.780 Spec=0.717
2025-04-24 16:46:35,146 - INFO - [04-24 16:46:35][Trial 87/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.609
2025-04-24 16:46:38,151 - WARNING - [Trial 87] 交叉验证失败原因: ['特异度过低: 0.1760 < 0.4', '特异度过低: 0.2168 < 0.4', '特异度过低: 0.1776 < 0.4', '特异度过低: 0.1517 < 0.4', '特异度过低: 0.2219 < 0.4']
2025-04-24 16:46:38,151 - INFO - [04-24 16:46:38][Trial 88/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:46:40,868 - INFO - [Trial 88] 5-fold mean metrics: {'Accuracy': 0.6146968289492863, 'Sensitivity': 0.8191873260716145, 'Specificity': 0.5835196867363377, 'Precision': 0.03209074412970793, 'NPV': 0.9953078254138997, 'F1 Score': 0.06174857377659835, "Youden's Index": 0.40270701280795207, "Cohen's Kappa": 0.032874624181731704, 'AUC-ROC': 0.7756654394358165, 'AUC-PR': 0.05862988685426842, 'Log Loss': 0.8550009510357832, 'Brier': 0.2799433431010904, 'ECE': 0.4424240134053578, 'MCE': 0.8779505499676764}
2025-04-24 16:46:40,868 - INFO - [Trial 88] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:46:41,448 - INFO - [Trial 88] 测试集指标: {'Accuracy': 0.605, 'Sensitivity': 0.78, 'Specificity': 0.593, 'Precision': 0.035, 'NPV': 0.992, 'F1 Score': 0.066, "Youden's Index": 0.374, "Cohen's Kappa": 0.033, 'AUC-ROC': 0.802, 'AUC-PR': 0.098, 'Log Loss': 0.879, 'Brier': 0.286, 'ECE': 0.449, 'MCE': 0.854}
2025-04-24 16:46:41,448 - INFO - Trial 88: CV AUC=0.776 Sens=0.819 Spec=0.584 | Test AUC=0.802 Sens=0.780 Spec=0.593
2025-04-24 16:46:41,448 - INFO - [04-24 16:46:41][Trial 89/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.670
2025-04-24 16:46:44,129 - INFO - [Trial 89] 5-fold mean metrics: {'Accuracy': 0.6846863658123528, 'Sensitivity': 0.7306118998816128, 'Specificity': 0.6641690683790967, 'Precision': 0.03523641398372011, 'NPV': 0.9948746282161567, 'F1 Score': 0.06721817597092845, "Youden's Index": 0.3947809682607096, "Cohen's Kappa": 0.038763062728424204, 'AUC-ROC': 0.7766916830133936, 'AUC-PR': 0.0629850678971253, 'Log Loss': 0.7415391628673332, 'Brier': 0.23184645835123213, 'ECE': 0.3685384450510365, 'MCE': 0.8754727421184914}
2025-04-24 16:46:44,129 - INFO - [Trial 89] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:46:44,719 - INFO - [Trial 89] 测试集指标: {'Accuracy': 0.686, 'Sensitivity': 0.78, 'Specificity': 0.67, 'Precision': 0.043, 'NPV': 0.993, 'F1 Score': 0.082, "Youden's Index": 0.45, "Cohen's Kappa": 0.05, 'AUC-ROC': 0.802, 'AUC-PR': 0.103, 'Log Loss': 0.764, 'Brier': 0.237, 'ECE': 0.375, 'MCE': 0.857}
2025-04-24 16:46:44,719 - INFO - Trial 89: CV AUC=0.777 Sens=0.731 Spec=0.664 | Test AUC=0.802 Sens=0.780 Spec=0.670
2025-04-24 16:46:44,720 - INFO - [04-24 16:46:44][Trial 90/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.635
2025-04-24 16:46:47,326 - INFO - [Trial 90] 5-fold mean metrics: {'Accuracy': 0.7725500692836358, 'Sensitivity': 0.6190146720202228, 'Specificity': 0.7594916649315893, 'Precision': 0.04169725368614189, 'NPV': 0.9937885706250711, 'F1 Score': 0.07809798145306887, "Youden's Index": 0.3785063369518121, "Cohen's Kappa": 0.05048182592491231, 'AUC-ROC': 0.7754494063971709, 'AUC-PR': 0.07359209149022913, 'Log Loss': 0.5666515200328256, 'Brier': 0.16928725263708835, 'ECE': 0.26312502696350293, 'MCE': 0.8709425052658804}
2025-04-24 16:46:47,326 - INFO - [Trial 90] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:46:47,876 - INFO - [Trial 90] 测试集指标: {'Accuracy': 0.782, 'Sensitivity': 0.724, 'Specificity': 0.773, 'Precision': 0.057, 'NPV': 0.992, 'F1 Score': 0.106, "Youden's Index": 0.497, "Cohen's Kappa": 0.076, 'AUC-ROC': 0.822, 'AUC-PR': 0.163, 'Log Loss': 0.563, 'Brier': 0.168, 'ECE': 0.266, 'MCE': 0.826}
2025-04-24 16:46:47,876 - INFO - Trial 90: CV AUC=0.775 Sens=0.619 Spec=0.759 | Test AUC=0.822 Sens=0.724 Spec=0.773
2025-04-24 16:46:47,877 - INFO - [04-24 16:46:47][Trial 91/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.590
2025-04-24 16:46:50,459 - INFO - [Trial 91] 5-fold mean metrics: {'Accuracy': 0.5967230610066754, 'Sensitivity': 0.8371572291791173, 'Specificity': 0.5642128410340332, 'Precision': 0.03125190164588661, 'NPV': 0.99514406214285, 'F1 Score': 0.06024147352385234, "Youden's Index": 0.4013700702131503, "Cohen's Kappa": 0.031263640651513325, 'AUC-ROC': 0.773171645209876, 'AUC-PR': 0.05713509688175702, 'Log Loss': 0.8781460992316914, 'Brier': 0.28974574889713434, 'ECE': 0.4547913612369682, 'MCE': 0.8764246429422895}
2025-04-24 16:46:50,459 - INFO - [Trial 91] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:46:51,013 - INFO - [Trial 91] 测试集指标: {'Accuracy': 0.59, 'Sensitivity': 0.78, 'Specificity': 0.58, 'Precision': 0.033, 'NPV': 0.992, 'F1 Score': 0.064, "Youden's Index": 0.36, "Cohen's Kappa": 0.031, 'AUC-ROC': 0.804, 'AUC-PR': 0.095, 'Log Loss': 0.9, 'Brier': 0.295, 'ECE': 0.461, 'MCE': 0.847}
2025-04-24 16:46:51,013 - INFO - Trial 91: CV AUC=0.773 Sens=0.837 Spec=0.564 | Test AUC=0.804 Sens=0.780 Spec=0.580
2025-04-24 16:46:51,014 - INFO - [04-24 16:46:51][Trial 92/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.676
2025-04-24 16:46:53,595 - INFO - [Trial 92] 5-fold mean metrics: {'Accuracy': 0.7166752885428904, 'Sensitivity': 0.7113529476053968, 'Specificity': 0.6969354879950906, 'Precision': 0.03818417650986787, 'NPV': 0.9948098791926345, 'F1 Score': 0.07246545316755455, "Youden's Index": 0.40828843560048733, "Cohen's Kappa": 0.04432184457646684, 'AUC-ROC': 0.7760145233452667, 'AUC-PR': 0.06181624449548726, 'Log Loss': 0.6917498145905869, 'Brier': 0.21189625254877048, 'ECE': 0.33345146272925114, 'MCE': 0.8853214759886203}
2025-04-24 16:46:53,596 - INFO - [Trial 92] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:46:54,142 - INFO - [Trial 92] 测试集指标: {'Accuracy': 0.715, 'Sensitivity': 0.78, 'Specificity': 0.701, 'Precision': 0.048, 'NPV': 0.993, 'F1 Score': 0.09, "Youden's Index": 0.482, "Cohen's Kappa": 0.058, 'AUC-ROC': 0.807, 'AUC-PR': 0.131, 'Log Loss': 0.711, 'Brier': 0.217, 'ECE': 0.341, 'MCE': 0.851}
2025-04-24 16:46:54,142 - INFO - Trial 92: CV AUC=0.776 Sens=0.711 Spec=0.697 | Test AUC=0.807 Sens=0.780 Spec=0.701
2025-04-24 16:46:54,142 - INFO - [04-24 16:46:54][Trial 93/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.629
2025-04-24 16:46:56,696 - INFO - [Trial 93] 5-fold mean metrics: {'Accuracy': 0.7520729578252352, 'Sensitivity': 0.6674314571998473, 'Specificity': 0.734777830946232, 'Precision': 0.040919780411257066, 'NPV': 0.9944815044269726, 'F1 Score': 0.07709380199946117, "Youden's Index": 0.4022092881460793, "Cohen's Kappa": 0.04930098558508176, 'AUC-ROC': 0.7770540239547211, 'AUC-PR': 0.06615486276449936, 'Log Loss': 0.6207591009124019, 'Brier': 0.18649785993258935, 'ECE': 0.2920705352603294, 'MCE': 0.8795544096660999}
2025-04-24 16:46:56,696 - INFO - [Trial 93] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:46:57,240 - INFO - [Trial 93] 测试集指标: {'Accuracy': 0.753, 'Sensitivity': 0.724, 'Specificity': 0.744, 'Precision': 0.051, 'NPV': 0.992, 'F1 Score': 0.095, "Youden's Index": 0.467, "Cohen's Kappa": 0.064, 'AUC-ROC': 0.806, 'AUC-PR': 0.141, 'Log Loss': 0.635, 'Brier': 0.191, 'ECE': 0.298, 'MCE': 0.836}
2025-04-24 16:46:57,241 - INFO - Trial 93: CV AUC=0.777 Sens=0.667 Spec=0.735 | Test AUC=0.806 Sens=0.724 Spec=0.744
2025-04-24 16:46:57,241 - INFO - [04-24 16:46:57][Trial 94/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.612
2025-04-24 16:46:59,958 - INFO - [Trial 94] 5-fold mean metrics: {'Accuracy': 0.6463293254902247, 'Sensitivity': 0.7347166455201076, 'Specificity': 0.6209196153850838, 'Precision': 0.031418712441491956, 'NPV': 0.9950574816597395, 'F1 Score': 0.06024699066458713, "Youden's Index": 0.35563626090519135, "Cohen's Kappa": 0.031424217321175174, 'AUC-ROC': 0.7751363789604045, 'AUC-PR': 0.06624033302351255, 'Log Loss': 0.8241269428101365, 'Brier': 0.2623298226318238, 'ECE': 0.4154981394498235, 'MCE': 0.8776697235491955}
2025-04-24 16:46:59,958 - INFO - [Trial 94] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:47:00,527 - INFO - [Trial 94] 测试集指标: {'Accuracy': 0.628, 'Sensitivity': 0.78, 'Specificity': 0.63, 'Precision': 0.037, 'NPV': 0.992, 'F1 Score': 0.07, "Youden's Index": 0.411, "Cohen's Kappa": 0.037, 'AUC-ROC': 0.798, 'AUC-PR': 0.078, 'Log Loss': 0.852, 'Brier': 0.269, 'ECE': 0.422, 'MCE': 0.86}
2025-04-24 16:47:00,528 - INFO - Trial 94: CV AUC=0.775 Sens=0.735 Spec=0.621 | Test AUC=0.798 Sens=0.780 Spec=0.630
2025-04-24 16:47:00,528 - INFO - [04-24 16:47:00][Trial 95/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.631
2025-04-24 16:47:03,163 - INFO - [Trial 95] 5-fold mean metrics: {'Accuracy': 0.6093687373100307, 'Sensitivity': 0.7829815875470689, 'Specificity': 0.5781136116519277, 'Precision': 0.030417921555856514, 'NPV': 0.9952590230555923, 'F1 Score': 0.0585477018189902, "Youden's Index": 0.36109519919899663, "Cohen's Kappa": 0.02955695835679706, 'AUC-ROC': 0.7719796194770836, 'AUC-PR': 0.06068899147358381, 'Log Loss': 0.9022046579692431, 'Brier': 0.2857612917210075, 'ECE': 0.42998584761507247, 'MCE': 0.8848814119816828}
2025-04-24 16:47:03,163 - INFO - [Trial 95] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:47:03,719 - INFO - [Trial 95] 测试集指标: {'Accuracy': 0.597, 'Sensitivity': 0.783, 'Specificity': 0.587, 'Precision': 0.034, 'NPV': 0.993, 'F1 Score': 0.065, "Youden's Index": 0.369, "Cohen's Kappa": 0.032, 'AUC-ROC': 0.807, 'AUC-PR': 0.097, 'Log Loss': 0.942, 'Brier': 0.296, 'ECE': 0.441, 'MCE': 0.868}
2025-04-24 16:47:03,720 - INFO - Trial 95: CV AUC=0.772 Sens=0.783 Spec=0.578 | Test AUC=0.807 Sens=0.783 Spec=0.587
2025-04-24 16:47:03,720 - INFO - [04-24 16:47:03][Trial 96/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.650
2025-04-24 16:47:06,256 - WARNING - [Trial 96] 交叉验证失败原因: ['特异度过低: 0.3453 < 0.4', '特异度过低: 0.3861 < 0.4', '特异度过低: 0.3464 < 0.4', '特异度过低: 0.3183 < 0.4', '特异度过低: 0.3858 < 0.4']
2025-04-24 16:47:06,256 - INFO - [04-24 16:47:06][Trial 97/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:47:09,032 - INFO - [Trial 97] 5-fold mean metrics: {'Accuracy': 0.66104873155237, 'Sensitivity': 0.7160230781835842, 'Specificity': 0.6346006704095635, 'Precision': 0.03211433320530556, 'NPV': 0.9949806257424308, 'F1 Score': 0.06146276559758042, "Youden's Index": 0.3506237485931477, "Cohen's Kappa": 0.03273554471187927, 'AUC-ROC': 0.7768800991314384, 'AUC-PR': 0.0609134272377128, 'Log Loss': 0.8006373089313481, 'Brier': 0.25141647237276904, 'ECE': 0.3956282982057924, 'MCE': 0.8793666299528944}
2025-04-24 16:47:09,032 - INFO - [Trial 97] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:47:09,628 - INFO - [Trial 97] 测试集指标: {'Accuracy': 0.648, 'Sensitivity': 0.78, 'Specificity': 0.645, 'Precision': 0.039, 'NPV': 0.993, 'F1 Score': 0.074, "Youden's Index": 0.426, "Cohen's Kappa": 0.041, 'AUC-ROC': 0.806, 'AUC-PR': 0.087, 'Log Loss': 0.825, 'Brier': 0.257, 'ECE': 0.401, 'MCE': 0.854}
2025-04-24 16:47:09,629 - INFO - Trial 97: CV AUC=0.777 Sens=0.716 Spec=0.635 | Test AUC=0.806 Sens=0.780 Spec=0.645
2025-04-24 16:47:09,629 - INFO - [04-24 16:47:09][Trial 98/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=0.623
2025-04-24 16:47:11,007 - WARNING - [Trial 98] 交叉验证失败原因: ['特异度过低: 0.0502 < 0.4', '特异度过低: 0.0728 < 0.4', '特异度过低: 0.0458 < 0.4', '特异度过低: 0.0447 < 0.4', '特异度过低: 0.0756 < 0.4']
2025-04-24 16:47:11,007 - INFO - [04-24 16:47:11][Trial 99/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:47:13,732 - INFO - [Trial 99] 5-fold mean metrics: {'Accuracy': 0.5185090845605271, 'Sensitivity': 0.8540316372068162, 'Specificity': 0.4798136222450319, 'Precision': 0.026793153282347083, 'NPV': 0.9954772349815236, 'F1 Score': 0.05194016311696757, "Youden's Index": 0.33384525945184806, "Cohen's Kappa": 0.022538182265123073, 'AUC-ROC': 0.767344670092369, 'AUC-PR': 0.059542055946998726, 'Log Loss': 1.0339010872325292, 'Brier': 0.34266731041914233, 'ECE': 0.507464790465969, 'MCE': 0.8885782681430708}
2025-04-24 16:47:13,732 - INFO - [Trial 99] 交叉验证通过，开始在测试集上评估...
2025-04-24 16:47:14,320 - WARNING - [Trial 99] 测试集约束检查失败: ['特异度过低: 0.4954 < 0.5']
2025-04-24 16:47:14,321 - INFO - [04-24 16:47:14][Trial 100/100] AUC-ROC=0.000 AUC-PR=0.000 Sens=0.000 Spec=0.000 Prec=0.000 Score=-inf
2025-04-24 16:47:14,321 - INFO - Training finished. Best score: 0.679
2025-04-24 16:47:14,321 - ERROR - Error during optimization: 'params'
2025-04-24 16:47:14,321 - ERROR - Traceback (most recent call last):
  File "/Users/ventus/Repository/DII_EPILEPSY_PREDICTION/py_model/XGBoost_Train.py", line 537, in main
    best_params = best_trial.user_attrs["params"]
KeyError: 'params'

2025-04-24 16:47:14,321 - INFO - Final best parameters:
2025-04-24 16:47:14,321 - INFO - Final best metrics (CV mean):
2025-04-24 16:47:14,321 - INFO - Evaluating on held-out test set (never seen during training/tuning)...
2025-04-24 16:47:14,484 - INFO - Test set metrics (never seen during training/tuning):
2025-04-24 16:47:14,484 - INFO - Accuracy: 0.938
2025-04-24 16:47:14,484 - INFO - Sensitivity: 0.561
2025-04-24 16:47:14,484 - INFO - Specificity: 0.922
2025-04-24 16:47:14,484 - INFO - Precision: 0.156
2025-04-24 16:47:14,484 - INFO - NPV: 0.990
2025-04-24 16:47:14,484 - INFO - F1 Score: 0.245
2025-04-24 16:47:14,484 - INFO - Youden's Index: 0.482
2025-04-24 16:47:14,484 - INFO - Cohen's Kappa: 0.223
2025-04-24 16:47:14,484 - INFO - AUC-ROC: 0.771
2025-04-24 16:47:14,485 - INFO - AUC-PR: 0.232
2025-04-24 16:47:14,485 - INFO - Log Loss: 0.201
2025-04-24 16:47:14,485 - INFO - Brier: 0.052
2025-04-24 16:47:14,485 - INFO - ECE: 0.082
2025-04-24 16:47:14,485 - INFO - MCE: 0.813
